(()=>{"use strict";var e={9372:(e,t,s)=>{s.d(t,{GF:()=>i,bG:()=>o,b_:()=>a});var r=s(4141),n=s(1827);const i=function(e){return(t,s)=>{const{constructor:r}=t,{prototype:i}=r,a=String(s),{defaultValue:o=null,observed:c=!1,name:l=(0,n.cc)(a)}=e;if(c){const e=Reflect.get(r,"observedAttributes",r);Array.isArray(e)?e.push(l):Object.defineProperty(r,"observedAttributes",{value:[l],writable:!1})}const{type:d}=e;switch(d){case Boolean:Object.defineProperty(i,a,{get:function(){return this.hasAttribute(l)},set:function(e){e?this.setAttribute(l,""):this.removeAttribute(l)}});break;case Object:Object.defineProperty(i,a,{get:function(){const e=this.getAttribute(l);return null!==e?JSON.parse(e):o},set:function(e){null!==e?this.setAttribute(l,JSON.stringify(e)):this.removeAttribute(l)}});break;case Number:Object.defineProperty(i,a,{get:function(){const e=this.getAttribute(l);return null!==e?parseFloat(e):o},set:function(e){null!==e?this.setAttribute(l,e):this.removeAttribute(l)}});break;default:Object.defineProperty(i,a,{get:function(){const e=this.getAttribute(l);return null!==e?e:o},set:function(e){null!==e?this.setAttribute(l,e):this.removeAttribute(l)}})}}},a=function(e){return t=>{const{name:s,options:r}=e;return customElements.get(s)||customElements.define(s,t,r),t}};function o(e,t){if(t){const{options:s,attributes:r,dataset:i,children:a,listeners:o}=t,c=document.createElement(e,s);if(r&&Object.entries(r).forEach((([e,t])=>{void 0!==t&&("boolean"==typeof t?c.toggleAttribute((0,n.cc)(e),t):c.setAttribute((0,n.cc)(e),String(t)))})),i){const{dataset:e}=c;Object.keys(i).forEach((t=>{e[t]=String(i[t])}))}return a&&("function"==typeof a?a(c):"object"==typeof a&&"length"in a?c.append(...Array.from(a)):c.append(a)),o&&Object.entries(o).forEach((([e,t])=>{Array.isArray(t)?c.addEventListener(e,t[0],t[1]):c.addEventListener(e,t)})),c}return document.createElement(e)}const c=new WeakMap;new FinalizationRegistry((e=>{const{model:t,reactiveElement:s}=e,r=c.get(t);if(void 0!==r){const{reactiveElementsArray:e}=r;e.splice(e.indexOf(s),1)}})),new r.KY((e=>{e.forEach((e=>{const{target:t,propertyName:s,oldValue:r,newValue:n}=e,{reactiveElementsArray:i}=c.get(t);i.forEach((e=>{const{elementRef:t,react:i,properties:a}=e,o=t.deref();o&&a.includes(s)&&i(o,s,r,n)}))}))}));const l=new WeakMap;new FinalizationRegistry((e=>{const{list:t,reactiveChildElement:s}=e,r=l.get(t);if(r){const{reactiveChildElementsArray:e}=r;e.splice(e.indexOf(s),1)}})),new r.KY((e=>{let t=null;Array.from(e.values()).forEach((e=>{const{target:s}=e,r=s,{length:n}=r,{reactiveChildElementsArray:i}=l.get(r);i.forEach((s=>{const{parentRef:r,mapping:i,placeholder:a}=s,o=r.deref();if(o){const{firstChild:s,children:r}=o,{length:c}=r;a&&n>0&&s==a&&o.removeChild(a);const{changeType:l,LIST_INSERT:d,LIST_REMOVE:h,LIST_SORT:f}=e;switch(l){case d:{const{insertedIndex:t,insertedItems:s}=e,n=Array.from(s.values()).map(i),{length:a}=r;t<a?r[t].before(...n):o.append(...n);break}case h:{const{removedIndex:s,removedItems:n}=e,{length:i}=n;t=t??document.createRange();const a=s+(i-1);a<c&&(t.setStartBefore(r[s]),t.setEndAfter(r[a]),t.deleteContents());break}case f:{const{sortedIndices:t}=e,s=Array.from(r);o.append(...t.filter((e=>e<c)).map((e=>s[e])));break}}0==n&&a&&o.append(a)}}))}))}))},1827:(e,t,s)=>{function r(e){return e.replace(/(?<!^)(?=[A-Z])/g,"-").toLowerCase()}s.d(t,{cc:()=>r})},7080:(e,t,s)=>{s.d(t,{Y:()=>c});var r,n=s(9372),i=function(e,t,s,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i<3?n(a):i>3?n(t,s,a):n(t,s))||a);return i>3&&a&&Object.defineProperty(t,s,a),a},a=function(e,t,s,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,s):n?n.value=s:t.set(e,s),s};let o=class extends HTMLElement{constructor(){super(),r.set(this,void 0),this.attachShadow({mode:"open"}).append((0,n.bG)("style",{children:['\n                        :host {\n                            display: inline-block;\n                            padding: 3px 4px;\n                            cursor: pointer;\n                            white-space: nowrap;\n                            border-radius: 4px;\n                            border: 1px solid black;\n                            user-select: none;\n                        }\n        \n                        :host([disabled]) {\n                            pointer-events: none;\n                            color: lightgray;\n                            border-color: lightgray;\n                        }\n        \n                        :host([selected]:active) {\n                            cursor: grabbing;\n                        }\n                        \n                        :host([selected]) {\n                            cursor: grab;\n                            font-weight: bold;\n                            outline: 1px auto black;\n                        }\n        \n                        :host([dragovered]) {\n                            border-style: dotted;\n                        }\n                        \n                        [part="container"] {\n                            display: flex;\n                            align-items: center;\n                        }\n                    ']}),(0,n.bG)("div",{attributes:{part:"container"},children:[(0,n.bG)("slot",{children:["&nbsp;"]})]})),this.references=[],a(this,r,null,"f")}get referee(){return function(e,t,s,r){if("a"===s&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}(this,r,"f")}connectedCallback(){this.tabIndex=this.tabIndex,this.draggable=!0}disconnectedCallback(){if(this.referee){const e=this.referee.references.indexOf(this);e>-1&&this.referee.references.splice(e,1)}}getReference(){const e=this.cloneNode(!0);return a(e,r,this,"f"),e}};r=new WeakMap,i([(0,n.GF)({type:Boolean})],o.prototype,"selected",void 0),i([(0,n.GF)({type:Boolean})],o.prototype,"dragovered",void 0),i([(0,n.GF)({type:Boolean})],o.prototype,"dragged",void 0),i([(0,n.GF)({type:Boolean})],o.prototype,"disabled",void 0),o=i([(0,n.b_)({name:"e-draggable"})],o);var c=o},4141:(e,t,s)=>{s.d(t,{KY:()=>_});var r,n,i,a,o,c,l,d,h,f,p,g,u,b,v,m,w,y,E,T=function(e,t,s,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,s):n?n.value=s:t.set(e,s),s},R=function(e,t,s,r){if("a"===s&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)};class I{constructor(e){this.target=e.target,this.changeType=e.changeType,this.propertyName=e.propertyName??null,this.oldValue=e.oldValue??void 0,this.newValue=e.newValue??void 0,this.removedIndex=e.removedIndex??0,this.removedItems=new O(e.removedItems??[]),this.insertedIndex=e.insertedIndex??0,this.insertedItems=new O(e.insertedItems??[]),this.sortedIndices=e.sortedIndices??[]}static get PROPERTY_CHANGE(){return 1}static get LIST_REMOVE(){return 2}static get LIST_INSERT(){return 3}static get LIST_SORT(){return 4}get PROPERTY_CHANGE(){return I.PROPERTY_CHANGE}get LIST_REMOVE(){return I.LIST_REMOVE}get LIST_INSERT(){return I.LIST_INSERT}get LIST_SORT(){return I.LIST_SORT}}var x=I;r=new WeakMap;var O=class{constructor(e){r.set(this,void 0),T(this,r,e.slice(),"f")}get length(){return R(this,r,"f").length}item(e){return R(this,r,"f")[e]??null}values(){return R(this,r,"f").values()}};class S{constructor(e){n.set(this,void 0),i.set(this,void 0),this.type=e,T(this,n,null,"f"),T(this,i,null,"f")}get currentTarget(){return R(this,n,"f")}get target(){return R(this,i,"f")}}n=new WeakMap,i=new WeakMap,S.ModelEventTargetAccessor=new class{setCurrentTarget(e,t){e instanceof S&&T(e,n,t,"f")}setTarget(e,t){e instanceof S&&T(e,i,t,"f")}};var A=S.ModelEventTargetAccessor;delete S.ModelEventTargetAccessor;var P=S;class M{constructor(){a.set(this,void 0),T(this,a,new Map,"f")}receiveEvent(e){const{type:t}=e,s=R(this,a,"f").get(t);A.setCurrentTarget(e,this),s&&s.forEach((t=>{t(e)}))}addEventListener(e,t){const s=R(this,a,"f").get(e);s?s.push(t):R(this,a,"f").set(e,[t])}removeEventListener(e,t){const s=R(this,a,"f").get(e);if(s){const r=s.findIndex((e=>e==t));r>-1&&s.splice(r,1),0==s.length&&R(this,a,"f").delete(e)}}dispatchEvent(e){A.setTarget(e,this),this.receiveEvent(e)}}a=new WeakMap;class k extends M{constructor(){super(),o.add(this),c.set(this,void 0),l.set(this,void 0),d.set(this,void 0),T(this,c,null,"f"),T(this,l,[],"f"),T(this,d,!1,"f")}get parentNode(){return R(this,c,"f")}setParent(e){if(null!==e){let t=e==this,{parentNode:s}=e;for(;!t&&null!==s;)({parentNode:s}=s),t=s==this;if(t)throw new TypeError("Failed to set parent on ModelNode: circular reference detected in the hierarchy.");T(this,c,e,"f")}else T(this,c,null,"f")}beginChanges(){T(this,d,!0,"f")}endChanges(){this.dispatchEvent(new P("modelchange")),R(this,l,"f").splice(0),T(this,d,!1,"f")}getRecords(){return R(this,l,"f").slice()}receiveEvent(e){super.receiveEvent(e);const{parentNode:t}=this;t&&t.receiveEvent(e)}}c=new WeakMap,l=new WeakMap,d=new WeakMap,o=new WeakSet,h=function(e,t,s){const r=R(this,l,"f"),n=new x({target:this,changeType:x.PROPERTY_CHANGE,propertyName:e,oldValue:t,newValue:s});r.push(n),R(this,d,"f")||(this.dispatchEvent(new P("modelchange")),r.splice(0))},f=function(e){R(this,l,"f").push(e),R(this,d,"f")||(this.dispatchEvent(new P("modelchange")),R(this,l,"f").splice(0))},k.ModelNodeRecordsAccessor=new class{triggerChange(e,t,s,r){e instanceof k&&R(e,o,"m",h).call(e,t,s,r)}handleRecord(e,t){e instanceof k&&R(e,o,"m",f).call(e,t)}};var L=k.ModelNodeRecordsAccessor;delete k.ModelNodeRecordsAccessor;var N=k;class j extends k{constructor(){super(),p.set(this,void 0),T(this,p,new Map,"f")}}p=new WeakMap,j.ModelObjectPropertiesAccessor=new class{setProperty(e,t,s){e instanceof j&&R(e,p,"f").set(t,s)}getProperty(e,t){if(e instanceof j)return R(e,p,"f").get(t)}},j.ModelObjectPropertiesAccessor,delete j.ModelObjectPropertiesAccessor,g=new WeakMap;var C=class extends k{constructor(e){super(),g.set(this,void 0),T(this,g,e?.slice()??[],"f")}setParent(e){super.setParent(e),R(this,g,"f").forEach((t=>{t.setParent(e)}))}get length(){return R(this,g,"f").length}get(e){return R(this,g,"f")[e]??null}index(e){return R(this,g,"f").indexOf(e)}values(){return R(this,g,"f").values()}sort(e){const t=R(this,g,"f").map(((e,t)=>({item:e,index:t})));t.sort(((t,s)=>e(t.item,s.item))),T(this,g,t.map((e=>e.item)),"f");const s=new x({target:this,changeType:x.LIST_SORT,sortedIndices:t.map((e=>e.index))});L.handleRecord(this,s)}prepend(...e){const t=R(this,g,"f"),{parentNode:s}=this;s&&e.forEach((e=>{e.setParent(s)})),t.splice(0,0,...e);const r=new x({target:this,changeType:x.LIST_INSERT,insertedIndex:0,insertedItems:e});L.handleRecord(this,r)}append(...e){const t=R(this,g,"f"),{length:s}=t,{parentNode:r}=this;r&&e.forEach((e=>{e.setParent(r)})),t.push(...e);const n=new x({target:this,changeType:x.LIST_INSERT,insertedIndex:s,insertedItems:e});L.handleRecord(this,n)}insert(e,...t){const s=R(this,g,"f"),{length:r}=s;if(Math.abs(e)<=r){if(e>=0){const{parentNode:n}=this;t.forEach((e=>{e.setParent(n)})),e<r?s.splice(e,0,...t):s.push(...t)}else if(e<0){e=r-e;const{parentNode:n}=this;n&&t.forEach((e=>{e.setParent(n)})),s.splice(e,0,...t)}const n=new x({target:this,changeType:x.LIST_INSERT,insertedIndex:e,insertedItems:t.slice()});L.handleRecord(this,n)}}remove(e){const t=R(this,g,"f"),s=t.indexOf(e);if(s>-1){const e=t.splice(s,1)[0],{parentNode:r}=this;r&&e.setParent(null);const n=new x({target:this,changeType:x.LIST_REMOVE,removedIndex:s,removedItems:[e]});L.handleRecord(this,n)}}clear(){const e=R(this,g,"f"),{length:t}=e;if(t>0){const t=e.splice(0),{parentNode:s}=this;s&&t.forEach((e=>{e.setParent(null)}));const r=new x({target:this,changeType:x.LIST_REMOVE,removedIndex:0,removedItems:t});L.handleRecord(this,r)}}};b=new WeakMap,v=new WeakMap,m=new WeakMap,w=new WeakMap,u=new WeakSet,y=function(){const e=R(this,v,"f").splice(0);e.length>0&&R(this,b,"f").call(this,e)},E=function(e){if(!R(this,m,"f")){const{target:t,currentTarget:s}=e,r=R(this,w,"f").get(s);if(r){const{options:e}=r,{properties:n,propertiesFilter:i,childList:a,subtree:o}=e;o?n&&t instanceof N?(i?R(this,v,"f").push(...t.getRecords().filter((e=>{const{propertyName:t}=e;return i.includes(t)}))):R(this,v,"f").push(...t.getRecords()),R(this,u,"m",y).call(this)):a&&t instanceof C&&(R(this,v,"f").push(...t.getRecords()),R(this,u,"m",y).call(this)):t==s&&(n&&t instanceof N?(i?R(this,v,"f").push(...t.getRecords().filter((e=>{const{propertyName:t}=e;return i.includes(t)}))):R(this,v,"f").push(...t.getRecords()),R(this,u,"m",y).call(this)):a&&t instanceof C&&(R(this,v,"f").push(...t.getRecords()),R(this,u,"m",y).call(this)))}}};var _=class{constructor(e){u.add(this),b.set(this,void 0),v.set(this,void 0),m.set(this,void 0),w.set(this,void 0),T(this,b,e,"f"),T(this,v,[],"f"),T(this,m,!1,"f"),T(this,w,new WeakMap,"f")}observe(e,t){T(this,m,!1,"f");const s=R(this,w,"f");let r=s.get(e);if(r)s.set(e,r);else{const n=R(this,u,"m",E).bind(this);e.addEventListener("modelchange",n),r={listener:n,options:t},s.set(e,r)}}unobserve(e){let t=R(this,w,"f").get(e);if(t){const{listener:s}=t;e.removeEventListener("modelchange",s)}}disconnect(){R(this,v,"f").splice(0),T(this,m,!0,"f")}}}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e,t,r=s(9372),n=s(7080),i=function(e,t,s,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i<3?n(a):i>3?n(t,s,a):n(t,s))||a);return i>3&&a&&Object.defineProperty(t,s,a),a},a=function(e,t,s,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,s):n?n.value=s:t.set(e,s),s},o=function(e,t,s,r){if("a"===s&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)};let c=class extends HTMLElement{constructor(){super(),e.set(this,void 0),t.set(this,void 0),this.attachShadow({mode:"open"}).append((0,r.bG)("style",{children:['\n                        :host {\n                            display: block;\n                        }\n        \n                        :host([disabled]) {\n                            pointer-events: none;\n                        }\n        \n                        [part="container"] {\n                            position: relative;\n                            display: flex;\n                            flex-direction: column;\n                            padding-left: 2px;\n                            padding-right: 2px;\n                        }\n        \n                        ::slotted(*) {\n                            margin-top: 2px;\n                            margin-bottom: 2px;\n                        }\n                    ']}),(0,r.bG)("div",{attributes:{part:"container"},children:[(0,r.bG)("slot")]})),a(this,e,[],"f"),a(this,t,[],"f")}get draggables(){return o(this,e,"f")}get selectedDraggables(){return o(this,t,"f")}selectDraggable(e){this.selectedDraggables.includes(e)||this.selectedDraggables.push(e),e.selected||(e.selected=!0)}unselectDraggable(e){const t=this.selectedDraggables.indexOf(e);t>-1&&(e.selected&&(e.selected=!1),this.selectedDraggables.splice(t,1))}clearSelection(){this.selectedDraggables.forEach((e=>{e.selected=!1})),a(this,t,[],"f")}connectedCallback(){this.tabIndex=this.tabIndex;const t=this.shadowRoot?.querySelector("slot");t&&t.addEventListener("slotchange",(()=>{const s=t.assignedElements().filter((e=>e instanceof n.Y));a(this,e,s,"f"),this.draggables.forEach((e=>{e.draggable=!0}))})),this.addEventListener("keydown",(e=>{"Escape"===e.key&&(this.clearSelection(),this.focus())})),this.addEventListener("dragstart",(e=>{const t=e.target;if(this.draggables.includes(t)){this.selectedDraggables.forEach((e=>{e.dragged=!0}));const t=e.dataTransfer;t&&(t.dropEffect="move",t.setData("text/plain",this.id))}})),this.addEventListener("dragleave",(e=>{const t=e.dataTransfer;t&&(t.dropEffect="none")})),this.addEventListener("dragend",(e=>{const t=e.target;this.draggables.includes(t)&&this.draggables.filter((e=>e.dragged)).forEach((e=>{e.dragged=!1}))})),this.addEventListener("focusout",(e=>{const t=e.relatedTarget;this.contains(t)||this.clearSelection()})),this.addEventListener("mousedown",(e=>{const t=e.target;if(0==e.button)if(this.draggables.includes(t))if(e.shiftKey||e.ctrlKey){if(e.ctrlKey)t.selected?this.unselectDraggable(t):this.selectDraggable(t);else if(e.shiftKey)if(this.selectedDraggables.length>0){const e=this.draggables.indexOf(t),s=this.draggables.indexOf(this.selectedDraggables[0]),r=Math.sign(e-s),n=r>0?0:this.draggables.length-1,i=r>0?this.draggables.length-1:0,a=r>0?s:e,o=r>0?e:s;for(let e=n;e!==i+r;e+=r)e>=a&&e<=o?this.selectDraggable(this.draggables[e]):this.unselectDraggable(this.draggables[e])}else this.selectDraggable(t)}else t.selected||(this.clearSelection(),this.selectDraggable(t));else this.clearSelection()})),this.addEventListener("mouseup",(e=>{const t=e.target;0==e.button&&this.draggables.includes(t)&&(e.shiftKey||e.ctrlKey||this.draggables.forEach((e=>{e!==t&&this.unselectDraggable(e)})))}))}};e=new WeakMap,t=new WeakMap,i([(0,r.GF)({type:Boolean})],c.prototype,"disabled",void 0),c=i([(0,r.b_)({name:"e-dragzone"})],c)})()})();
//# sourceMappingURL=Dragzone.ts.js.map