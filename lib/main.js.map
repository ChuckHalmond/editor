{"version":3,"file":"main.js","mappings":"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MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,KACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,KACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,KACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,KACpBA,EAAoB,KACpBA,EAAoB,KACpBA,EAAoB,IACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,MACpBA,EAAoB,KACpBA,EAAoB,KACpBA,EAAoB,MACpBA,EAAoB,MACMA,EAAoB,I","sources":["webpack://editor/webpack/runtime/create fake namespace object","webpack://editor/./src/Input.ts","webpack://editor/./src/elements/Element.ts","webpack://editor/./src/elements/Snippets.ts","webpack://editor/./src/elements/containers/grid/Grid.ts","webpack://editor/./src/elements/containers/grid/GridBody.ts","webpack://editor/./src/elements/containers/grid/GridCell.ts","webpack://editor/./src/elements/containers/grid/GridHead.ts","webpack://editor/./src/elements/containers/grid/GridRow.ts","webpack://editor/./src/elements/containers/grid/GridRowGroup.ts","webpack://editor/./src/elements/containers/lists/List.ts","webpack://editor/./src/elements/containers/lists/ListItem.ts","webpack://editor/./src/elements/containers/lists/ListItemGroup.ts","webpack://editor/./src/elements/containers/menus/Menu.ts","webpack://editor/./src/elements/containers/menus/MenuBar.ts","webpack://editor/./src/elements/containers/menus/MenuButton.ts","webpack://editor/./src/elements/containers/menus/MenuItem.ts","webpack://editor/./src/elements/containers/menus/MenuItemGroup.ts","webpack://editor/./src/elements/containers/status/StatusBar.ts","webpack://editor/./src/elements/containers/status/StatusItem.ts","webpack://editor/./src/elements/containers/status/StatusItemGroup.ts","webpack://editor/./src/elements/containers/tabs/Tab.ts","webpack://editor/./src/elements/containers/tabs/TabList.ts","webpack://editor/./src/elements/containers/tabs/TabPanel.ts","webpack://editor/./src/elements/containers/toolbars/ToolBar.ts","webpack://editor/./src/elements/containers/toolbars/ToolBarItem.ts","webpack://editor/./src/elements/containers/toolbars/ToolBarItemGroup.ts","webpack://editor/./src/elements/containers/trees/Tree.ts","webpack://editor/./src/elements/containers/trees/TreeItem.ts","webpack://editor/./src/elements/containers/trees/TreeItemGroup.ts","webpack://editor/./src/elements/controls/dialogs/Dialog.ts","webpack://editor/./src/elements/controls/draggable/Draggable.ts","webpack://editor/./src/elements/controls/draggable/Dragzone.ts","webpack://editor/./src/elements/controls/draggable/Dropzone.ts","webpack://editor/./src/elements/controls/forms/Option.ts","webpack://editor/./src/elements/controls/forms/OptionGroup.ts","webpack://editor/./src/elements/controls/forms/Select.ts","webpack://editor/./src/elements/misc/Handle.ts","webpack://editor/./src/elements/misc/HeightSash.ts","webpack://editor/./src/elements/misc/Import.ts","webpack://editor/./src/elements/misc/Loader.ts","webpack://editor/./src/elements/misc/Separator.ts","webpack://editor/./src/elements/misc/ToolTip.ts","webpack://editor/./src/elements/misc/WidthSash.ts","webpack://editor/./src/models/Model.ts","webpack://editor/./src/observers/NodeCollection.ts","webpack://editor/./src/stylesheets/Theme.ts","webpack://editor/./src/views/GridView.ts","webpack://editor/./src/views/MenuView.ts","webpack://editor/./src/views/TreeView.ts","webpack://editor/./src/views/View.ts","webpack://editor/./src/views/widgets/HeightSashWidget.ts","webpack://editor/./src/views/widgets/SeparatorWidget.ts","webpack://editor/./src/views/widgets/Widget.ts","webpack://editor/./src/views/widgets/WidthSashWidget.ts","webpack://editor/./src/views/widgets/combobox/ComboboxWidget.ts","webpack://editor/./src/views/widgets/combobox/OptionGroupWidget.ts","webpack://editor/./src/views/widgets/combobox/OptionWidget.ts","webpack://editor/./src/views/widgets/grid/GridBodyWidget.ts","webpack://editor/./src/views/widgets/grid/GridCellWidget.ts","webpack://editor/./src/views/widgets/grid/GridHeadWidget.ts","webpack://editor/./src/views/widgets/grid/GridHeaderWidget.ts","webpack://editor/./src/views/widgets/grid/GridRowWidget.ts","webpack://editor/./src/views/widgets/grid/GridWidget.ts","webpack://editor/./src/views/widgets/list/ListItemGroupWidget.ts","webpack://editor/./src/views/widgets/list/ListItemWidget.ts","webpack://editor/./src/views/widgets/list/ListWidget.ts","webpack://editor/./src/views/widgets/menu/MenuBarWidget.ts","webpack://editor/./src/views/widgets/menu/MenuItemGroupWidget.ts","webpack://editor/./src/views/widgets/menu/MenuItemWidget.ts","webpack://editor/./src/views/widgets/menu/MenuWidget.ts","webpack://editor/./src/views/widgets/toolbar/ToolBarItemGroupWidget.ts","webpack://editor/./src/views/widgets/toolbar/ToolBarItemWidget.ts","webpack://editor/./src/views/widgets/toolbar/ToolBarWidget.ts","webpack://editor/./src/views/widgets/tree/TreeItemGroupWidget.ts","webpack://editor/./src/views/widgets/tree/TreeItemWidget.ts","webpack://editor/./src/views/widgets/tree/TreeWidget.ts","webpack://editor/webpack/bootstrap","webpack://editor/webpack/runtime/define property getters","webpack://editor/webpack/runtime/global","webpack://editor/webpack/runtime/hasOwnProperty shorthand","webpack://editor/webpack/runtime/make namespace object","webpack://editor/webpack/runtime/publicPath","webpack://editor/webpack/startup"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","export { Key };\r\nexport { KeyModifier };\r\nexport { HotKey };\r\nexport { MouseButton };\r\n\r\nenum Key {\r\n    A = \"a\",\r\n    B = \"b\",\r\n    C = \"c\",\r\n    D = \"d\",\r\n    E = \"e\",\r\n    F = \"f\",\r\n    G = \"g\",\r\n    H = \"h\",\r\n    I = \"i\",\r\n    J = \"j\",\r\n    K = \"k\",\r\n    L = \"l\",\r\n    M = \"m\",\r\n    O = \"o\",\r\n    P = \"p\",\r\n    Q = \"q\",\r\n    R = \"r\",\r\n    S = \"s\",\r\n    T = \"t\",\r\n    U = \"u\",\r\n    V = \"v\",\r\n    W = \"w\",\r\n    X = \"x\",\r\n    Y = \"y\",\r\n    Z = \"z\",\r\n    ENTER = \"Enter\",\r\n    BACKSPACE = \"Backspace\",\r\n    ARROW_DOWN = \"ArrowDown\",\r\n    ARROW_LEFT = \"ArrowLeft\",\r\n    ARROW_RIGHT = \"ArrowRight\",\r\n    ARROW_UP = \"ArrowUp\",\r\n    SHIFT = \"Shift\"\r\n}\r\n\r\nenum KeyModifier {\r\n    Alt = \"Alt\",\r\n    Control = \"Control\",\r\n    Shift = \"Shift\"\r\n}\r\n\r\nenum MouseButton {\r\n    LEFT = 1,\r\n    WHEEL = 2,\r\n    RIGHT = 3,\r\n    FORWARD = 4,\r\n    BACK = 5\r\n}\r\n\r\nclass HotKey {\r\n    readonly key: Key;\r\n    readonly mod1?: KeyModifier;\r\n    readonly mod2?: KeyModifier;\r\n\r\n    constructor(key: Key, mod1?: KeyModifier, mod2?: KeyModifier) {\r\n        this.key = key;\r\n        this.mod1 = mod1;\r\n        this.mod2 = mod2;\r\n    }\r\n\r\n    toString(): string {\r\n        return `${this.mod1 ? `${this.#modifierString(this.mod1)}+` : \"\"}${this.mod2 ? `${this.#modifierString(this.mod2)}+` : \"\"}${(this.key.length == 1) ? this.key.toUpperCase() : this.key}`;\r\n    }\r\n\r\n    test(event: KeyboardEvent): boolean {\r\n        return (!this.mod1 || this.#testModifier(this.mod1, event)) && (!this.mod2 || this.#testModifier(this.mod2, event)) && event.key == this.key;\r\n    }\r\n\r\n    #modifierString(mod: KeyModifier): string {\r\n        switch (mod) {\r\n            case KeyModifier.Control:\r\n                return \"Ctrl\";\r\n            default:\r\n                return mod;\r\n        }\r\n    }\r\n\r\n    #testModifier(mod: KeyModifier, event: KeyboardEvent): boolean {\r\n        switch (mod) {\r\n            case \"Alt\":\r\n                return event.altKey;\r\n            case \"Control\":\r\n                return event.ctrlKey;\r\n            case \"Shift\":\r\n                return event.shiftKey;\r\n            default:\r\n                return true;\r\n        }\r\n    }\r\n}","import { ModelList, ModelNode, ModelChangeRecord, ModelChangeObserver, ModelChangeObserverOptions } from \"../models/Model\";\r\nimport { camelToTrain } from \"./Snippets\";\r\n\r\nexport { CustomElement };\r\nexport { ReactiveChildElements };\r\nexport { QueryProperty };\r\nexport { QueryAllProperty };\r\nexport { AttributeProperty };\r\nexport { reactiveElement };\r\nexport { revokeReactiveElement };\r\nexport { reactiveChildElements };\r\nexport { revokeReactiveChildElements };\r\nexport { element };\r\nexport { fragment };\r\nexport { textNode };\r\nexport { AttributeMutationMixin };\r\nexport { AttributeType };\r\nexport { areAttributesMatching };\r\nexport { AttributeMutationMixinBase };\r\nexport { trimMultilineIndent };\r\nexport { Stylesheet };\r\n\r\nexport { reactiveElementsMap };\r\n\r\ninterface AttributePropertyDecorator {\r\n    (\r\n        init: {\r\n            type: typeof String;\r\n            observed?: boolean;\r\n            defaultValue?: string | null;\r\n            name?: string;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, property: keyof E) => void;\r\n    (\r\n        init: {\r\n            type: typeof Number;\r\n            observed?: boolean;\r\n            defaultValue?: number | null;\r\n            name?: string;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, property: keyof E) => void;\r\n    (\r\n        init: {\r\n            type: typeof Boolean;\r\n            observed?: boolean;\r\n            name?: string;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, property: keyof E) => void;\r\n    (\r\n        init: {\r\n            type: typeof Object;\r\n            observed?: boolean;\r\n            defaultValue?: any | null;\r\n            name?: string;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, property: keyof E) => void;\r\n}\r\n\r\nconst AttributeProperty: AttributePropertyDecorator = function(\r\n    init: {\r\n        type: typeof String | typeof Number | typeof Boolean | typeof Object;\r\n        observed?: boolean;\r\n        defaultValue?: string | number | any | null;\r\n        name?: string;\r\n    }\r\n) {\r\n    return <E extends HTMLElement>(\r\n        target: E, property: keyof E\r\n    ) => {\r\n        const {constructor} = target;\r\n        const {prototype} = constructor;\r\n        const propertyName = String(property);\r\n        const {defaultValue = null, observed = false, name = camelToTrain(propertyName)} = init;\r\n        if (observed) {\r\n            const observedAttributes = Reflect.get(constructor, \"observedAttributes\", constructor);\r\n            if (Array.isArray(observedAttributes)) {\r\n                observedAttributes.push(name);\r\n            }\r\n            else {\r\n                Object.defineProperty(\r\n                    constructor, \"observedAttributes\", {\r\n                        value: [name],\r\n                        writable: false\r\n                    }\r\n                );\r\n            }\r\n        }\r\n        const {type} = init;\r\n        switch (type) {\r\n            case Boolean: {\r\n                Object.defineProperty(prototype, propertyName, {\r\n                    get: function(this: HTMLElement) {\r\n                        return this.hasAttribute(name);\r\n                    },\r\n                    set: function(this: HTMLElement, value) {\r\n                        if (value) {\r\n                            this.setAttribute(name, \"\");\r\n                        }\r\n                        else {\r\n                            this.removeAttribute(name);\r\n                        }\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n            case Object: {\r\n                Object.defineProperty(prototype, propertyName, {\r\n                    get: function(this: HTMLElement) {\r\n                        const val = this.getAttribute(name);\r\n                        return (val !== null) ? JSON.parse(val) : defaultValue;\r\n                    },\r\n                    set: function(this: HTMLElement, value) {\r\n                        if (value !== null) {\r\n                            this.setAttribute(name, JSON.stringify(value));\r\n                        }\r\n                        else {\r\n                            this.removeAttribute(name);\r\n                        }\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n            case Number: {\r\n                Object.defineProperty(prototype, propertyName, {\r\n                    get: function(this: HTMLElement) {\r\n                        const val = this.getAttribute(name);\r\n                        return (val !== null) ? parseFloat(val) : defaultValue;\r\n                    },\r\n                    set: function(this: HTMLElement, value) {\r\n                        if (value !== null) {\r\n                            this.setAttribute(name, value);\r\n                        }\r\n                        else {\r\n                            this.removeAttribute(name);\r\n                        }\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n            case String:\r\n            default: {\r\n                Object.defineProperty(prototype, propertyName, {\r\n                    get: function(this: HTMLElement) {\r\n                        const val = this.getAttribute(name);\r\n                        return (val !== null) ? val : defaultValue;\r\n                    },\r\n                    set: function(this: HTMLElement, value) {\r\n                        if (value !== null) {\r\n                            this.setAttribute(name, value);\r\n                        }\r\n                        else {\r\n                            this.removeAttribute(name);\r\n                        }\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n    \r\nfunction Stylesheet(text: string): CSSStyleSheet {\r\n    const stylesheet = new CSSStyleSheet();\r\n    (stylesheet as any).replaceSync(text);\r\n    return stylesheet;\r\n}\r\n\r\nfunction trimMultilineIndent(text: string): string {\r\n    const newlineIndex = text.indexOf(\"\\n\");\r\n    text = text.substring(newlineIndex + 1);\r\n    const indentMatch = text.match(/^[\\s]*/);\r\n    if (indentMatch) {\r\n        const indent = text.substring(0, indentMatch[0].length);\r\n        text = text.replaceAll(indent, \"\").trimEnd();\r\n    }\r\n    return text;\r\n}\r\n\r\ninterface CustomElementDecorator {\r\n    (init: {\r\n        name: string;\r\n        options?: ElementDefinitionOptions\r\n    }): <C extends CustomElementConstructor>(elementCtor: C) => C;\r\n}\r\n\r\nconst CustomElement: CustomElementDecorator = function(init: {\r\n    name: string;\r\n    options?: ElementDefinitionOptions\r\n}) {\r\n    return <C extends CustomElementConstructor>(\r\n        elementCtor: C\r\n    ) => {\r\n        const {name, options} = init;\r\n        if (!customElements.get(name)) {\r\n            customElements.define(\r\n                name,\r\n                elementCtor,\r\n                options\r\n            );\r\n        }\r\n        return elementCtor;\r\n    }\r\n}\r\n\r\ninterface QueryPropertyDecorator {\r\n    (\r\n        init: {\r\n            selector: string;\r\n            withinShadowRoot?: boolean;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, propertyKey: keyof E) => void;\r\n}\r\n\r\nconst QueryProperty: QueryPropertyDecorator = function(\r\n        init: {\r\n            selector: string;\r\n            withinShadowRoot?: boolean;\r\n        }\r\n    ) {\r\n    return <E extends HTMLElement>(\r\n        target: E, propertyKey: keyof E\r\n    ) => {\r\n        const {constructor} = target;\r\n        const {prototype} = constructor;\r\n        const propertyName = String(propertyKey);\r\n        const {selector} = init;\r\n        const withinShadowRoot = init.withinShadowRoot ?? false;\r\n        const getter = withinShadowRoot ? function(this: HTMLElement) {\r\n            return this.shadowRoot!.querySelector(selector);\r\n        } : function(this: HTMLElement) {\r\n            return this.querySelector(selector);\r\n        }\r\n        Object.defineProperty(prototype, propertyName, {\r\n            get: getter\r\n        });\r\n    }\r\n}\r\n\r\ninterface QueryAllPropertyDecorator {\r\n    (\r\n        init: {\r\n            selector: string;\r\n            withinShadowRoot?: boolean;\r\n        }\r\n    ): <E extends HTMLElement>(target: E, propertyKey: keyof E) => void;\r\n}\r\n\r\nconst QueryAllProperty: QueryAllPropertyDecorator = function(\r\n        init: {\r\n            selector: string;\r\n            withinShadowRoot?: boolean;\r\n        }\r\n    ) {\r\n    return <E extends HTMLElement>(\r\n        target: E, propertyKey: keyof E\r\n    ) => {\r\n        const {constructor} = target;\r\n        const {prototype} = constructor;\r\n        const propertyName = String(propertyKey);\r\n        const {selector} = init;\r\n        const withinShadowRoot = init.withinShadowRoot ?? false;\r\n        const getter = withinShadowRoot ? function(this: HTMLElement) {\r\n            return Array.from(this.shadowRoot!.querySelectorAll(selector));\r\n        } : function(this: HTMLElement) {\r\n            return Array.from(this.querySelectorAll(selector));\r\n        };\r\n        Object.defineProperty(prototype, propertyName, {\r\n            get: getter\r\n        });\r\n    }\r\n}\r\n\r\nfunction fragment(...nodes: (Node | string)[]): DocumentFragment {\r\n    const fragment = document.createDocumentFragment();\r\n    fragment.append(...nodes);\r\n    return fragment;\r\n}\r\n\r\nfunction textNode(text: string): Node {\r\n    return document.createTextNode(text);\r\n}\r\n\r\ninterface HTMLElementInit {\r\n    options?: ElementCreationOptions,\r\n    attributes?: {\r\n        [name: string]: number | string | boolean | undefined\r\n    },\r\n    dataset?: {\r\n        [property: string]: string | number | boolean\r\n    },\r\n    children?: Node | string | (Node | string)[] | NodeList | ReactiveChildElements,\r\n    listeners?: {\r\n        [EventName in keyof HTMLElementEventMap]?: EventListenerOrEventListenerObject | [EventListenerOrEventListenerObject, boolean | AddEventListenerOptions | undefined]\r\n    }\r\n}\r\n\r\nfunction element<E extends HTMLElementTagNameMap[K], K extends keyof HTMLElementTagNameMap>(\r\n    tagName: K, init?: HTMLElementInit): E;\r\nfunction element(\r\n    tagName: string, init?: HTMLElementInit): HTMLElement;\r\nfunction element<K extends keyof HTMLElementTagNameMap>(\r\n    tagName: K, init?: HTMLElementInit): HTMLElementTagNameMap[K] {\r\n    if (init) {\r\n        const {options, attributes, dataset, children, listeners} = init;\r\n        const element = document.createElement(tagName, options);\r\n        if (attributes) {\r\n            Object.entries(attributes).forEach(([attributeName, attributeValue]) => {\r\n                if (attributeValue !== undefined) {\r\n                    if (typeof attributeValue === \"boolean\") {\r\n                        element.toggleAttribute(camelToTrain(attributeName), attributeValue);\r\n                    }\r\n                    else {\r\n                        element.setAttribute(camelToTrain(attributeName), String(attributeValue));\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        if (dataset) {\r\n            const {dataset: elementDataset} = element;\r\n            Object.keys(dataset).forEach((datasetEntry_i) => {\r\n                elementDataset[datasetEntry_i] = String(dataset[datasetEntry_i]);\r\n            });\r\n        }\r\n        if (children) {\r\n            if (typeof children === \"function\") {\r\n                children(element);\r\n            }\r\n            else if (typeof children === \"object\" && \"length\" in children) {\r\n                element.append(...Array.from(children));\r\n            }\r\n            else {\r\n                element.append(children);\r\n            }\r\n        }\r\n        if (listeners) {\r\n            Object.entries(listeners).forEach(([name_i, listener_i]) => {\r\n                if (Array.isArray(listener_i)) {\r\n                    element.addEventListener(name_i, listener_i[0], listener_i[1]);\r\n                }\r\n                else {\r\n                    element.addEventListener(name_i, listener_i);\r\n                }\r\n            });\r\n        }\r\n        return element;\r\n    }\r\n    return document.createElement(tagName);\r\n}\r\n\r\nconst reactiveElementsMap = new WeakMap<ModelNode, {\r\n    observerOptions: ModelChangeObserverOptions,\r\n    reactiveElementsArray: {\r\n        elementRef: WeakRef<Element>,\r\n        properties: string[],\r\n        react: (element: any, property: string, oldValue: any, newValue: any) => void;\r\n    }[]\r\n}>();\r\n\r\nconst reactiveElementsFinalizationRegistry = new FinalizationRegistry((heldValue: {\r\n    model: ModelNode,\r\n    reactiveElement: {\r\n        elementRef: WeakRef<Element>,\r\n        properties: string[],\r\n        react: (element: any, property: string, oldValue: any, newValue: any) => void;\r\n    }\r\n}) => {\r\n    const {model, reactiveElement} = heldValue;\r\n    const reactiveElementsMapEntry = reactiveElementsMap.get(model);\r\n    if (reactiveElementsMapEntry !== undefined) {\r\n        const {reactiveElementsArray} = reactiveElementsMapEntry;\r\n        reactiveElementsArray.splice(reactiveElementsArray.indexOf(reactiveElement), 1);\r\n    }\r\n});\r\n\r\nconst reactiveElementsPropertyObserver = new ModelChangeObserver((records: ModelChangeRecord[]) => {\r\n    records.forEach((record_i) => {\r\n        const {target, propertyName, oldValue, newValue} = record_i;\r\n        const {reactiveElementsArray} = reactiveElementsMap.get(target)!;\r\n        reactiveElementsArray.forEach(reactiveElement_i => {\r\n            const {elementRef, react, properties} = reactiveElement_i;\r\n            const element = elementRef.deref();\r\n            if (element) {\r\n                if (properties.includes(propertyName!)) {\r\n                    react(element, propertyName!, oldValue, newValue);\r\n                }\r\n            }\r\n        });\r\n    });\r\n});\r\n\r\nfunction reactiveElement<M extends ModelNode, E extends Element, K extends string>(\r\n    model: M,\r\n    element: E,\r\n    properties: K[],\r\n    react: (object: E, property: K, oldValue: any, newValue: any) => void\r\n): E;\r\nfunction reactiveElement<M extends ModelNode, E extends Element>(\r\n    model: M,\r\n    element: E,\r\n    properties: string[],\r\n    react: (element: E, property: string, oldValue: any, newValue: any) => void\r\n): E {\r\n    const elementRef = new WeakRef(element);\r\n    const reactiveElement = {elementRef, react, properties};\r\n    const reactiveElementsMapEntry = reactiveElementsMap.get(model);\r\n    reactiveElementsFinalizationRegistry.register(element, {model, reactiveElement});\r\n    if (!reactiveElementsMapEntry) {\r\n        const observerOptions = {\r\n            properties: true,\r\n            propertiesFilter: properties\r\n        };\r\n        const reactiveElementsArray = [reactiveElement];\r\n        reactiveElementsMap.set(model, {observerOptions, reactiveElementsArray});\r\n        reactiveElementsPropertyObserver.observe(model, observerOptions);\r\n    }\r\n    else {\r\n        const {reactiveElementsArray, observerOptions} = reactiveElementsMapEntry;\r\n        const {propertiesFilter} = observerOptions;\r\n        reactiveElementsArray.push(reactiveElement);\r\n        observerOptions.propertiesFilter = propertiesFilter ?\r\n            propertiesFilter.concat(properties.filter(\r\n                property_i => !propertiesFilter.includes(property_i)\r\n            )) : properties.filter(\r\n                (property_i, i, properties) => properties.indexOf(property_i) === i\r\n            )\r\n    }\r\n    properties.forEach((property_i) => {\r\n        if (property_i in model) {\r\n            const value = Reflect.get(model, property_i, model);\r\n            react(element, <any>property_i, <any>undefined, value);\r\n        }\r\n    });\r\n    return element;\r\n}\r\n\r\nfunction revokeReactiveElement<M extends ModelNode, E extends Element>(\r\n    model: M,\r\n    element: E\r\n): void {\r\n    const reactiveElementsMapEntry = reactiveElementsMap.get(model);\r\n    if (reactiveElementsMapEntry) {\r\n        const {reactiveElementsArray} = reactiveElementsMapEntry;\r\n        const reactiveElementIndex = reactiveElementsArray.findIndex(\r\n            reactiveElement => reactiveElement.elementRef.deref() === element\r\n        );\r\n        if (reactiveElementIndex > -1) {\r\n            reactiveElementsArray.splice(reactiveElementIndex, 1);\r\n        }\r\n        if (reactiveElementsArray.length === 0) {\r\n            reactiveElementsMap.delete(model);\r\n        }\r\n    }\r\n}\r\n\r\ninterface ReactiveChildElements {\r\n    (parent: ParentNode): void;\r\n}\r\n\r\nconst reactiveChildElementsMap = new WeakMap<ModelList, {\r\n    reactiveChildElementsArray: {\r\n        parentRef: WeakRef<ParentNode>,\r\n        mapping: (item: any) => Element,\r\n        placeholder?: Element\r\n    }[]\r\n}>();\r\n\r\nconst reactiveChildElementsFinalizationRegistry = new FinalizationRegistry((heldValue: {\r\n    list: ModelList,\r\n    reactiveChildElement: {\r\n        parentRef: WeakRef<ParentNode>,\r\n        mapping: (item: any) => Element,\r\n        placeholder?: Element\r\n    }\r\n}) => {\r\n    const {list, reactiveChildElement} = heldValue;\r\n    const reactiveChildrenElementsMapEntry = reactiveChildElementsMap.get(list);\r\n    if (reactiveChildrenElementsMapEntry) {\r\n        const {reactiveChildElementsArray} = reactiveChildrenElementsMapEntry;\r\n        reactiveChildElementsArray.splice(reactiveChildElementsArray.indexOf(reactiveChildElement), 1);\r\n    }\r\n});\r\n\r\nconst reactiveChildElementsObserver = new ModelChangeObserver((records: ModelChangeRecord[]) => {\r\n    let range: null | Range = null;\r\n    Array.from(records.values()).forEach((record_i) => {\r\n        const {target} = record_i;\r\n        const list = <ModelList>target;\r\n        const {length: listLength} = list;\r\n        const {reactiveChildElementsArray} = reactiveChildElementsMap.get(list)!;\r\n        reactiveChildElementsArray.forEach((reactiveChildElements_i) => {\r\n            const {parentRef, mapping, placeholder} = reactiveChildElements_i;\r\n            const parent = parentRef.deref();\r\n            if (parent) {\r\n                const {firstChild, children} = parent;\r\n                const {length: childrenCount} = children;\r\n                if (placeholder && listLength > 0 && firstChild == placeholder) {\r\n                    parent.removeChild(placeholder);\r\n                }\r\n                const {changeType, LIST_INSERT, LIST_REMOVE, LIST_SORT} = record_i;\r\n                switch (changeType) {\r\n                    case LIST_INSERT: {\r\n                        const {insertedIndex, insertedItems} = record_i;\r\n                        const insertedItemsArray = Array.from(insertedItems.values()).map(mapping);\r\n                        const {length: childrenCount} = children;\r\n                        if (insertedIndex < childrenCount) {\r\n                            children[insertedIndex].before(...insertedItemsArray);\r\n                        }\r\n                        else {\r\n                            parent.append(...insertedItemsArray);\r\n                        }\r\n                        break;\r\n                    }\r\n                    case LIST_REMOVE: {\r\n                        const {removedIndex, removedItems} = record_i;\r\n                        const {length: removedCount} = removedItems;\r\n                        range = range ?? document.createRange();\r\n                        const removeEndIndex = removedIndex + (removedCount - 1);\r\n                        if (removeEndIndex < childrenCount) {\r\n                            range.setStartBefore(children[removedIndex]);\r\n                            range.setEndAfter(children[removeEndIndex]);\r\n                            range.deleteContents();\r\n                        }\r\n                        break;\r\n                    }\r\n                    case LIST_SORT: {\r\n                        const {sortedIndices} = record_i;\r\n                        const childrenArray = Array.from(children);\r\n                        parent.append(\r\n                            ...sortedIndices.filter(\r\n                                index_i => index_i < childrenCount\r\n                            ).map(\r\n                                index_i => childrenArray[index_i]\r\n                            )\r\n                        );\r\n                        break;\r\n                    }\r\n                }\r\n                if (listLength == 0 && placeholder) {\r\n                    parent.append(placeholder);\r\n                }\r\n            }\r\n        });\r\n    });\r\n});\r\n\r\nfunction reactiveChildElements<Model extends ModelNode>(\r\n    list: ModelList<Model>,\r\n    mapping: (item: Model) => Element,\r\n    placeholder?: Element\r\n): ReactiveChildElements {\r\n    return (parent: ParentNode) => {\r\n        const parentRef = new WeakRef(parent);\r\n        const reactiveChildElementsMapEntry = reactiveChildElementsMap.get(list);\r\n        const reactiveChildElement = {parentRef, mapping, placeholder};\r\n        reactiveChildElementsFinalizationRegistry.register(parent, {list, reactiveChildElement});\r\n        if (!reactiveChildElementsMapEntry) {\r\n            const reactiveChildElementsArray = [reactiveChildElement];\r\n            reactiveChildElementsMap.set(list, {reactiveChildElementsArray});\r\n            reactiveChildElementsObserver.observe(list, {\r\n                childList: true\r\n            });\r\n        }\r\n        else {\r\n            const {reactiveChildElementsArray} = reactiveChildElementsMapEntry;\r\n            reactiveChildElementsArray.push(reactiveChildElement);\r\n        }\r\n        const children = list.length == 0 && placeholder ?\r\n            [placeholder] : Array.from(list.values()).map(mapping);\r\n        parent.replaceChildren(...children);\r\n    }\r\n}\r\n\r\nfunction revokeReactiveChildElements<Model extends ModelNode>(\r\n    list: ModelList<Model>,\r\n    parent: ParentNode,\r\n): void {\r\n    const reactiveChildElementsMapEntry = reactiveChildElementsMap.get(list);\r\n    if (reactiveChildElementsMapEntry) {\r\n        const {reactiveChildElementsArray} = reactiveChildElementsMapEntry;\r\n        const reactiveChildElementsIndex = reactiveChildElementsArray.findIndex(\r\n            reactiveChildElement => reactiveChildElement.parentRef.deref() === parent\r\n        );\r\n        if (reactiveChildElementsIndex > -1) {\r\n            reactiveChildElementsArray.splice(reactiveChildElementsIndex, 1);\r\n        }\r\n        if (reactiveChildElementsArray.length === 0) {\r\n            reactiveChildElementsMap.delete(list);\r\n        }\r\n    }\r\n}\r\n\r\ninterface AttributeMutationMixin {\r\n    readonly attributeName: string;\r\n    readonly attributeValue: string;\r\n    readonly attributeType: AttributeType;\r\n    attach(element: Element): void;\r\n    detach(element: Element): void;\r\n}\r\n\r\ntype AttributeType = \"string\" | \"boolean\" | \"list\";\r\n\r\nfunction areAttributesMatching(\r\n    referenceAttributeType: AttributeType,\r\n    referenceAttributeName: string, referenceAttributeValue: string,\r\n    attributeName: string, attributeValue: string | null): boolean {\r\n    if (referenceAttributeName == attributeName) {\r\n        switch (referenceAttributeType) {\r\n            case \"boolean\":\r\n                return referenceAttributeValue == \"\" && attributeValue == \"\";\r\n            case \"string\":\r\n                return referenceAttributeValue !== \"\" && (referenceAttributeValue == attributeValue);\r\n            case \"list\":\r\n                return (referenceAttributeValue !== \"\" && attributeValue !== null) && new RegExp(`${referenceAttributeValue}\\s*?`, \"g\").test(attributeValue );\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nclass AttributeMutationMixinBase implements AttributeMutationMixin {\r\n    readonly attributeName: string;\r\n    readonly attributeValue: string;\r\n    readonly attributeType: AttributeType;\r\n\r\n    constructor(attributeName: string, attributeType: AttributeType = \"boolean\", attributeValue: string = \"\") {\r\n        this.attributeName = attributeName;\r\n        this.attributeType = attributeType;\r\n        this.attributeValue = attributeValue;\r\n    }\r\n\r\n    attach(): void {\r\n        throw new TypeError(\"Not implemented method.\");\r\n    }\r\n\r\n    detach(): void {\r\n        throw new TypeError(\"Not implemented method.\");\r\n    }\r\n}","\r\nexport { snakeToCamel };\r\nexport { camelToSnake };\r\nexport { trainToCamel };\r\nexport { camelToTrain };\r\n\r\nfunction snakeToCamel(str: string) {\r\n  return str.split('_').map(str =>  str.charAt(0).toUpperCase() + str.substring(1).toLowerCase()).join(\"\");\r\n}\r\n\r\nfunction camelToSnake(str: string) {\r\n  return str.replace(/(?<!^)(?=[A-Z])/g, '_').toLowerCase();\r\n}\r\n\r\nfunction trainToCamel(str: string) {\r\n  return str.split('-').map(str =>  str.charAt(0).toUpperCase() + str.substring(1).toLowerCase()).join(\"\");\r\n}\r\n\r\nfunction camelToTrain(str: string) {\r\n  return str.replace(/(?<!^)(?=[A-Z])/g, '-').toLowerCase();\r\n}","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEGridBodyElement } from \"./GridBody\";\r\nimport { HTMLEGridCellElement } from \"./GridCell\";\r\nimport { HTMLEGridHeadElement } from \"./GridHead\";\r\nimport { HTMLEGridRowElement } from \"./GridRow\";\r\nimport { HTMLEGridRowGroupElement } from \"./GridRowGroup\";\r\n\r\nexport { HTMLEGridElement };\r\n\r\ninterface HTMLEGridElementConstructor {\r\n    prototype: HTMLEGridElement;\r\n    new(): HTMLEGridElement;\r\n}\r\n\r\ninterface HTMLEGridElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly body: HTMLEGridBodyElement | null;\r\n    readonly head: HTMLEGridHeadElement | null\r\n    readonly activeCell: HTMLEGridCellElement | null;\r\n    readonly activeRow: HTMLEGridRowElement | null;\r\n    selectby: \"cell\" | \"row\";\r\n    name: string;\r\n    multiselectable: boolean;\r\n    cells(): HTMLEGridCellElement[];\r\n    rows(): HTMLEGridRowElement[];\r\n    beginSelection(): void;\r\n    endSelection(): void;\r\n    clearSelection(): void;\r\n    selectedCells(): HTMLEGridCellElement[];\r\n    selectedRows(): HTMLEGridRowElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-grid\": HTMLEGridElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-grid\"\r\n})\r\nclass HTMLEGridElementBase extends HTMLElement implements HTMLEGridElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    cells(): HTMLEGridCellElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridCellElement>(\r\n            \"e-gridcell\"\r\n        ));\r\n    }\r\n\r\n    rows(): HTMLEGridRowElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridRowElement>(\r\n            \"e-gridrow\"\r\n        ));\r\n    }\r\n\r\n    get activeCell(): HTMLEGridCellElement | null {\r\n        return this.querySelector<HTMLEGridCellElement>(\"e-gridcell[active]\");\r\n    }\r\n\r\n    get activeRow(): HTMLEGridRowElement | null {\r\n        return this.querySelector<HTMLEGridRowElement>(\"e-gridrow[active]\");\r\n    }\r\n\r\n    get body(): HTMLEGridBodyElement | null {\r\n        return this.querySelector<HTMLEGridBodyElement>(\":scope > e-gridbody\");\r\n    }\r\n\r\n    get head(): HTMLEGridHeadElement | null {\r\n        return this.querySelector<HTMLEGridHeadElement>(\":scope > e-gridhead\");\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"cell\"})\r\n    selectby!: \"cell\" | \"row\";\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    multiselectable!: boolean;\r\n\r\n    #onSelection: boolean;\r\n    #hasSelectionChanged: boolean;\r\n    #cellsWalker: TreeWalker;\r\n    #rowsWalker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table;\r\n                user-select: none;\r\n                line-height: 22px;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        this.#cellsWalker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#cellsWalkerNodeFilter.bind(this)\r\n        );\r\n        this.#rowsWalker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#rowsWalkerNodeFilter.bind(this)\r\n        );\r\n        this.#onSelection = false;\r\n        this.#hasSelectionChanged = false;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        this.addEventListener(\"dblclick\", this.#handleDblClickEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this));\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    beginSelection(): void {\r\n        this.#onSelection = true;\r\n    }\r\n\r\n    endSelection(): void {\r\n        this.#onSelection = false;\r\n        if (this.#hasSelectionChanged) {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged = false;\r\n        }\r\n    }\r\n\r\n    clearSelection(): void {\r\n        this.#clearCellsSelection();\r\n        this.#clearRowsSelection();\r\n    }\r\n\r\n    selectedCells(): HTMLEGridCellElement[] {\r\n        return Array.from(this.querySelectorAll(\"e-gridcell[selected]\"));\r\n    }\r\n\r\n    selectedRows(): HTMLEGridRowElement[] {\r\n        return Array.from(this.querySelectorAll(\"e-gridrow[selected]\"));\r\n    }\r\n\r\n    #cellsWalkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEGridCellElement && !node.hidden) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEGridBodyElement || node instanceof HTMLEGridRowGroupElement || node instanceof HTMLEGridRowElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #rowsWalkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEGridRowElement && !node.hidden) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEGridBodyElement || node instanceof HTMLEGridRowGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getCellsRange(from: HTMLEGridCellElement, to: HTMLEGridCellElement): HTMLEGridCellElement[] {\r\n        const cells = Array.from(this.cells());\r\n        const fromIndex = cells.indexOf(from);\r\n        const toIndex = cells.indexOf(to);\r\n        if (fromIndex > -1 && toIndex > -1) {\r\n            if (from == to) {\r\n                return [from];\r\n            }\r\n            return cells.slice(\r\n                Math.min(fromIndex, toIndex),\r\n                Math.max(fromIndex, toIndex) + 1\r\n            );\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #getRowsRange(from: HTMLEGridRowElement, to: HTMLEGridRowElement): HTMLEGridRowElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextVisibleRow = this.#nextRow(from);\r\n            while (nextVisibleRow && nextVisibleRow !== to) {\r\n                range.push(nextVisibleRow);\r\n                nextVisibleRow = this.#nextRow(nextVisibleRow);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousVisibleRow = this.#previousRow(from);\r\n            while (previousVisibleRow && previousVisibleRow !== to) {\r\n                range.push(previousVisibleRow);\r\n                previousVisibleRow = this.#previousRow(previousVisibleRow);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setCellsSelection(...cells: HTMLEGridCellElement[]): void {\r\n        this.beginSelection();\r\n        const selectedCells = this.selectedCells();\r\n        selectedCells.forEach((selectedCell_i) => {\r\n            if (!cells.includes(selectedCell_i)) {\r\n                selectedCell_i.selected = false;\r\n            }\r\n        });\r\n        cells.forEach((cell_i) => {\r\n            if (!cell_i.selected) {\r\n                cell_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #setRowsSelection(...rows: HTMLEGridRowElement[]): void {\r\n        this.beginSelection();\r\n        const selectedRows = this.selectedRows();\r\n        selectedRows.forEach((selectedRow_i) => {\r\n            if (!rows.includes(selectedRow_i)) {\r\n                selectedRow_i.selected = false;\r\n            }\r\n        });\r\n        rows.forEach((row_i) => {\r\n            if (!row_i.selected) {\r\n                row_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #addCellsToSelection(...cells: HTMLEGridCellElement[]): void {\r\n        this.beginSelection();\r\n        cells.forEach((cell_i) => {\r\n            if (!cell_i.selected) {\r\n                cell_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #addRowsToSelection(...rows: HTMLEGridRowElement[]): void {\r\n        this.beginSelection();\r\n        rows.forEach((row_i) => {\r\n            if (!row_i.selected) {\r\n                row_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #removeCellsFromSelection(...cells: HTMLEGridCellElement[]): void {\r\n        this.beginSelection();\r\n        const selectedCells = this.selectedCells();\r\n        cells.forEach((cell_i) => {\r\n            if (selectedCells.includes(cell_i)) {\r\n                cell_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #removeRowsFromSelection(...rows: HTMLEGridRowElement[]): void {\r\n        this.beginSelection();\r\n        const selectedRows = this.selectedRows();\r\n        rows.forEach((row_i) => {\r\n            if (selectedRows.includes(row_i)) {\r\n                row_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #clearCellsSelection(): void {\r\n        this.beginSelection();\r\n        const selectedCells = this.selectedCells();\r\n        selectedCells.forEach((cell_i) => {\r\n            if (cell_i.selected) {\r\n                cell_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #clearRowsSelection(): void {\r\n        this.beginSelection();\r\n        const selectedRows = this.selectedRows();\r\n        selectedRows.forEach((row_i) => {\r\n            if (row_i.selected) {\r\n                row_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #setActiveCell(cell: HTMLEGridCellElement | null): void {\r\n        const {activeCell} = this;\r\n        if (activeCell !== null && activeCell !== cell) {\r\n            activeCell.active = false;\r\n            activeCell.tabIndex = -1;\r\n        }\r\n        if (cell !== null) {\r\n            const cellsWalker = this.#cellsWalker;\r\n            cellsWalker.currentNode = cell;\r\n            cell.active = true;\r\n            cell.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #setActiveRow(row: HTMLEGridRowElement | null): void {\r\n        const {activeRow} = this;\r\n        if (activeRow !== null && activeRow !== row) {\r\n            activeRow.active = false;\r\n            activeRow.tabIndex = -1;\r\n        }\r\n        if (row !== null) {\r\n            const rowsWalker = this.#rowsWalker;\r\n            rowsWalker.currentNode = row;\r\n            row.active = true;\r\n            row.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #firstCell(row: HTMLEGridRowElement): HTMLEGridCellElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = row;\r\n        return <HTMLEGridCellElement | null>cellsWalker.firstChild();\r\n    }\r\n\r\n    #lastCell(row: HTMLEGridRowElement): HTMLEGridCellElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = row;\r\n        return <HTMLEGridCellElement | null>cellsWalker.lastChild();\r\n    }\r\n\r\n    #previousCell(cell: HTMLEGridCellElement): HTMLEGridCellElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = cell;\r\n        return <HTMLEGridCellElement | null>cellsWalker.previousNode();\r\n    }\r\n\r\n    #nextCell(cell: HTMLEGridCellElement): HTMLEGridCellElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = cell;\r\n        return <HTMLEGridCellElement | null>cellsWalker.nextNode();\r\n    }\r\n\r\n    #closestRow(cell: HTMLEGridCellElement): HTMLEGridRowElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = cell;\r\n        return <HTMLEGridRowElement | null>rowsWalker.parentNode();\r\n    }\r\n\r\n    #firstRow(): HTMLEGridRowElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        const {root} = rowsWalker;\r\n        rowsWalker.currentNode = root;\r\n        return <HTMLEGridRowElement | null>rowsWalker.firstChild();\r\n    }\r\n\r\n    #lastRow(): HTMLEGridRowElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        const {root} = rowsWalker;\r\n        rowsWalker.currentNode = root;\r\n        return <HTMLEGridRowElement | null>rowsWalker.lastChild();\r\n    }\r\n\r\n    #previousRow(row: HTMLEGridRowElement): HTMLEGridRowElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = row;\r\n        return <HTMLEGridRowElement | null>rowsWalker.previousNode();\r\n    }\r\n\r\n    #nextRow(row: HTMLEGridRowElement): HTMLEGridRowElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = row;\r\n        return <HTMLEGridRowElement | null>rowsWalker.nextNode();\r\n    }\r\n\r\n    #topCell(cell: HTMLEGridCellElement): HTMLEGridCellElement | null {\r\n        const closestRow = this.#closestRow(cell);\r\n        if (closestRow) {\r\n            const closestRowCells = closestRow.cells();\r\n            const cellIndex = closestRowCells.indexOf(cell);\r\n            const previousRow = this.#previousRow(closestRow);\r\n            if (previousRow) {\r\n                const previousRowCells = previousRow.cells();\r\n                return previousRowCells[\r\n                    Math.min(cellIndex, previousRowCells.length)\r\n                ];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #bottomCell(cell: HTMLEGridCellElement): HTMLEGridCellElement | null {\r\n        const closestRow = this.#closestRow(cell);\r\n        if (closestRow) {\r\n            const closestRowCells = closestRow.cells();\r\n            const cellIndex = closestRowCells.indexOf(cell);\r\n            const nextRow = this.#nextRow(closestRow);\r\n            if (nextRow) {\r\n                const nextRowCells = nextRow.cells();\r\n                return nextRowCells[\r\n                    Math.min(cellIndex, nextRowCells.length)\r\n                ];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {ctrlKey, shiftKey} = event;\r\n        const {selectby} = this;\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const composedPath = event.composedPath();\r\n                const targetCell = composedPath.find(\r\n                    target_i => target_i instanceof HTMLEGridBodyElement\r\n                ) ? composedPath.find(\r\n                    target_i => target_i instanceof HTMLEGridCellElement\r\n                ) : null;\r\n                const selectedCells = this.selectedCells();\r\n                if (targetCell instanceof HTMLEGridCellElement) {\r\n                    if (!shiftKey && !ctrlKey) {\r\n                        this.#setCellsSelection(targetCell);\r\n                    }\r\n                    else if (ctrlKey) {\r\n                        !targetCell.selected ?\r\n                            this.#addCellsToSelection(targetCell) :\r\n                            this.#removeCellsFromSelection(targetCell);\r\n                    }\r\n                    else if (shiftKey) {\r\n                        const lastSelectedCell = selectedCells[selectedCells.length - 1];\r\n                        if (lastSelectedCell) {\r\n                            const range = this.#getCellsRange(\r\n                                lastSelectedCell,\r\n                                targetCell\r\n                            );\r\n                            if (range) {\r\n                                selectedCells.includes(targetCell) ?\r\n                                    this.#removeCellsFromSelection(...range) :\r\n                                    this.#addCellsToSelection(...range);\r\n                            }\r\n                        }\r\n                        else {\r\n                            this.#setCellsSelection(targetCell);\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const selectedRows = this.selectedRows();\r\n                const composedPath = event.composedPath();\r\n                const targetRow = composedPath.find(\r\n                    target_i => target_i instanceof HTMLEGridBodyElement\r\n                ) ? composedPath.find(\r\n                    target_i => target_i instanceof HTMLEGridRowElement\r\n                ) : null;\r\n                if (targetRow instanceof HTMLEGridRowElement) {\r\n                    if (!shiftKey && !ctrlKey) {\r\n                        this.#setRowsSelection(targetRow);\r\n                    }\r\n                    else if (ctrlKey) {\r\n                        !targetRow.selected ?\r\n                            this.#addRowsToSelection(targetRow) :\r\n                            this.#removeRowsFromSelection(targetRow);\r\n                    }\r\n                    else if (shiftKey) {\r\n                        const lastSelectedRow = selectedRows[selectedRows.length - 1];\r\n                        if (lastSelectedRow) {\r\n                            const range = this.#getRowsRange(\r\n                                lastSelectedRow,\r\n                                targetRow\r\n                            );\r\n                            if (range) {\r\n                                selectedRows.includes(targetRow) ?\r\n                                    this.#removeRowsFromSelection(...range) :\r\n                                    this.#addRowsToSelection(...range);\r\n                            }\r\n                        }\r\n                        else {\r\n                            this.#setRowsSelection(targetRow);\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleDblClickEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent) {\r\n        const {key} = event;\r\n        const {selectby, activeCell, activeRow} = this;\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey) {\r\n                    switch (selectby) {\r\n                        case \"cell\": {\r\n                            const firstRow = this.#firstRow();\r\n                            const firstCell = firstRow ? this.#firstCell(firstRow) : null;\r\n                            const lastRow = this.#lastRow();\r\n                            const lastCell = lastRow ? this.#lastCell(lastRow) : null;\r\n                            if (firstCell && lastCell) {\r\n                                const range = this.#getCellsRange(firstCell, lastCell);\r\n                                if (range) {\r\n                                    this.#setCellsSelection(...range);\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                        case \"row\": {\r\n                            const firstRow = this.#firstRow();\r\n                            const lastRow = this.#lastRow();\r\n                            if (firstRow && lastRow) {\r\n                                const range = this.#getRowsRange(firstRow, lastRow);\r\n                                if (range) {\r\n                                    this.#setRowsSelection(...range);\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (selectby == \"cell\") {\r\n                    if (activeCell) {\r\n                        const previousCell = this.#previousCell(activeCell);\r\n                        if (previousCell) {\r\n                            previousCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey) {\r\n                                previousCell.selected ?\r\n                                    this.#removeCellsFromSelection(previousCell) :\r\n                                    this.#addCellsToSelection(previousCell);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (selectby == \"cell\") {\r\n                    if (activeCell) {\r\n                        const nextCell = this.#nextCell(activeCell);\r\n                        if (nextCell) {\r\n                            nextCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey) {\r\n                                nextCell.selected ?\r\n                                    this.#removeCellsFromSelection(nextCell) :\r\n                                    this.#addCellsToSelection(nextCell);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        const firstRow = activeRow ?? this.#firstRow();\r\n                        const topCell = activeCell ?\r\n                            this.#topCell(activeCell) :\r\n                            firstRow ?\r\n                            this.#firstCell(firstRow) :\r\n                            null;\r\n                        if (topCell) {\r\n                            topCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey) {\r\n                                topCell.selected ?\r\n                                    this.#removeCellsFromSelection(topCell) :\r\n                                    this.#addCellsToSelection(topCell);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const previousRow = activeRow ?\r\n                            this.#previousRow(activeRow) :\r\n                            this.#firstRow();\r\n                        if (previousRow) {\r\n                            previousRow.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey) {\r\n                                previousRow.selected ?\r\n                                    this.#removeRowsFromSelection(previousRow) :\r\n                                    this.#addRowsToSelection(previousRow);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        const lastRow = activeRow ?? this.#lastRow();\r\n                        const bottomCell = activeCell ?\r\n                            this.#bottomCell(activeCell) :\r\n                            lastRow ?\r\n                            this.#lastCell(lastRow) :\r\n                            null;\r\n                            if (bottomCell) {\r\n                                bottomCell.focus({preventScroll: true});\r\n                                const {shiftKey} = event;\r\n                                if (shiftKey) {\r\n                                    bottomCell.selected ?\r\n                                        this.#removeCellsFromSelection(bottomCell) :\r\n                                        this.#addCellsToSelection(bottomCell);\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    case \"row\": {\r\n                        const nextRow = activeRow ?\r\n                            this.#nextRow(activeRow) :\r\n                            this.#lastRow();\r\n                        if (nextRow) {\r\n                            nextRow.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey) {\r\n                                nextRow.selected ?\r\n                                    this.#removeRowsFromSelection(nextRow) :\r\n                                    this.#addRowsToSelection(nextRow);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeRow) {\r\n                            const firstCell = this.#firstCell(activeRow);\r\n                            if (firstCell) {\r\n                                firstCell.focus({preventScroll: true});\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const firstRow = this.#firstRow();\r\n                        if (firstRow) {\r\n                            firstRow.focus({preventScroll: true});\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeRow) {\r\n                            const lastCell = this.#lastCell(activeRow);\r\n                            if (lastCell) {\r\n                                lastCell.focus({preventScroll: true});\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const lastRow = this.#lastRow();\r\n                        if (lastRow) {\r\n                            lastRow.focus({preventScroll: true});\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeCell) {\r\n                            this.#setCellsSelection(activeCell);\r\n                            activeCell.click();\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        if (activeRow) {\r\n                            this.#setRowsSelection(activeRow);\r\n                            activeRow.click();\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        this.#clearCellsSelection();\r\n                        this.#setActiveCell(null);\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        this.#clearRowsSelection();\r\n                        this.#setActiveRow(null);\r\n                        break;\r\n                    }\r\n                }\r\n                this.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {selectby} = this;\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const {activeCell} = this;\r\n                if (activeCell && relatedTarget !== activeCell) {\r\n                    activeCell.focus();\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const {activeRow} = this;\r\n                if (activeRow && relatedTarget !== activeRow) {\r\n                    activeRow.focus();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const {selectby} = this;\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const targetCell = (<HTMLElement>target).closest<HTMLEGridCellElement>(\"e-gridcell\");\r\n                if (targetCell) {\r\n                    this.#setActiveCell(targetCell);\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const targetRow = (<HTMLElement>target).closest<HTMLEGridRowElement>(\"e-gridrow\");\r\n                if (targetRow) {\r\n                    this.#setActiveRow(targetRow);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(): void {\r\n        if (this.#onSelection) {\r\n            this.#hasSelectionChanged = true;\r\n        }\r\n        else {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n        }\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedRows = <HTMLEGridRowElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEGridRowElement\r\n            );\r\n            assignedRows.forEach((row_i, i) => {\r\n                row_i.posinset = i;\r\n            });\r\n    }\r\n}\r\n\r\nvar HTMLEGridElement: HTMLEGridElementConstructor = HTMLEGridElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLEGridCellElement } from \"./GridCell\";\r\nimport { HTMLEGridRowElement } from \"./GridRow\";\r\n\r\nexport { HTMLEGridBodyElement };\r\n\r\ninterface HTMLEGridBodyElementConstructor {\r\n    prototype: HTMLEGridBodyElement;\r\n    new(): HTMLEGridBodyElement;\r\n}\r\n\r\ninterface HTMLEGridBodyElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    cells(): HTMLEGridCellElement[];\r\n    rows(): HTMLEGridRowElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridbody\": HTMLEGridBodyElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridbody\"\r\n})\r\nclass HTMLEGridBodyElementBase extends HTMLElement implements HTMLEGridBodyElement {\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    cells(): HTMLEGridCellElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridCellElement>(\r\n            \"e-gridcell\"\r\n        ));\r\n    }\r\n\r\n    rows(): HTMLEGridRowElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridRowElement>(\r\n            \"e-gridrow\"\r\n        ));\r\n    }\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table-row-group;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this));\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedItems = <HTMLEGridCellElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEGridCellElement\r\n            );\r\n        assignedItems.forEach((item_i, i) => {\r\n            item_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEGridBodyElement: HTMLEGridBodyElementConstructor = HTMLEGridBodyElementBase;","import { CustomElement, element, AttributeProperty } from \"../../Element\";\r\n\r\nexport { HTMLEGridCellElement };\r\n\r\ninterface HTMLEGridCellElementConstructor {\r\n    prototype: HTMLEGridCellElement;\r\n    new(): HTMLEGridCellElement;\r\n}\r\n\r\ninterface HTMLEGridCellElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    name: string;\r\n    type: \"rowheader\" | \"columnheader\" | \"gridcell\";\r\n    headers: string;\r\n    posinset: number;\r\n    droptarget: boolean;\r\n    selected: boolean;\r\n    active: boolean;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridcell\": HTMLEGridCellElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridcell\"\r\n})\r\nclass HTMLEGridCellElementBase extends HTMLElement implements HTMLEGridCellElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    headers!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    type!: \"rowheader\" | \"columnheader\" | \"gridcell\";\r\n\r\n    @AttributeProperty({type: Number})\r\n    posinset!: number;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    droptarget!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    selected!: boolean;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table-cell;\r\n                text-align: left;\r\n            }\r\n            \r\n            :host([type=\"columnheader\"]:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host(:hover):host-context(e-grid:is(:not([selectby]), [selectby=\"cell\"])) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([type=\"columnheader\"][active]) {\r\n                background-color: var(--focused-item-color);\r\n            }\r\n            \r\n            :host([active]):host-context(e-grid:focus-within:is(:not([selectby]), [selectby=\"cell\"])) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n\r\n            :host(:focus-visible):host-context(e-grid:focus-within:is([selectby=\"row\"])) {\r\n                outline: none;\r\n            }\r\n            \r\n            :host([selected]):host-context(e-grid:is(:not([selectby]), [selectby=\"cell\"])) {\r\n                background-color: var(--selected-item-color);\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"selected\": {\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEGridCellElement: HTMLEGridCellElementConstructor = HTMLEGridCellElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLEGridCellElement } from \"./GridCell\";\r\nimport { HTMLEGridRowElement } from \"./GridRow\";\r\n\r\nexport { HTMLEGridHeadElement };\r\n\r\ninterface HTMLEGridHeadElementConstructor {\r\n    prototype: HTMLEGridHeadElement;\r\n    new(): HTMLEGridHeadElement;\r\n}\r\n\r\ninterface HTMLEGridHeadElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    cells(): HTMLEGridCellElement[];\r\n    rows(): HTMLEGridRowElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridhead\": HTMLEGridHeadElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridhead\"\r\n})\r\nclass HTMLEGridHeadElementBase extends HTMLElement implements HTMLEGridHeadElement {\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    cells(): HTMLEGridCellElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridCellElement>(\r\n            \"e-gridcell\"\r\n        ));\r\n    }\r\n\r\n    rows(): HTMLEGridRowElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridRowElement>(\r\n            \"e-gridrow\"\r\n        ));\r\n    }\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table-row-group;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this));\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedItems = <HTMLEGridCellElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEGridCellElement\r\n            );\r\n        assignedItems.forEach((item_i, i) => {\r\n            item_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEGridHeadElement: HTMLEGridHeadElementConstructor = HTMLEGridHeadElementBase;","import { AttributeProperty, CustomElement, element } from \"../../Element\";\r\nimport { HTMLEMenuElement } from \"../menus/Menu\";\r\nimport { HTMLEGridCellElement } from \"./GridCell\";\r\n\r\nexport { HTMLEGridRowElement };\r\n\r\ninterface HTMLEGridRowElementConstructor {\r\n    prototype: HTMLEGridRowElement;\r\n    new(): HTMLEGridRowElement;\r\n}\r\n\r\ninterface HTMLEGridRowElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly menu: HTMLEMenuElement | null;\r\n    name: string;\r\n    active: boolean;\r\n    selected: boolean;\r\n    posinset: number;\r\n    cells(): HTMLEGridCellElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridrow\": HTMLEGridRowElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridrow\"\r\n})\r\nclass HTMLEGridRowElementBase extends HTMLElement implements HTMLEGridRowElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    cells(): HTMLEGridCellElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEGridCellElement>(\"e-gridcell\"));\r\n    }\r\n\r\n    get menu(): HTMLEMenuElement | null {\r\n        return this.#menu;\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    selected!: boolean;\r\n\r\n    @AttributeProperty({type: Number})\r\n    posinset!: number;\r\n\r\n    #menu: HTMLEMenuElement | null;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table-row;\r\n            }\r\n            \r\n            :host(:hover):host-context(e-grid:is([selectby=\"row\"])) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([active]):host-context(e-grid:focus-within:is([selectby=\"row\"])) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            :host([selected]):host-context(e-grid:is([selectby=\"row\"])) {\r\n                background-color: var(--selected-item-color);\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        this.#menu = null;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        shadowRoot.addEventListener(\r\n            \"slotchange\", this.#handleSlotChangeEvent.bind(this)\r\n        );\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"selected\": {\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedCells = <HTMLEGridCellElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEGridCellElement\r\n            );\r\n        assignedCells.forEach((cell_i, i) => {\r\n            cell_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEGridRowElement: HTMLEGridRowElementConstructor = HTMLEGridRowElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLEGridCellElement } from \"./GridCell\";\r\n\r\nexport { HTMLEGridRowGroupElement };\r\n\r\ninterface HTMLEGridRowGroupElementConstructor {\r\n    prototype: HTMLEGridRowGroupElement;\r\n    new(): HTMLEGridRowGroupElement;\r\n}\r\n\r\ninterface HTMLEGridRowGroupElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridrowgroup\": HTMLEGridRowGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridrowgroup\"\r\n})\r\nclass HTMLEGridRowGroupElementBase extends HTMLElement implements HTMLEGridRowGroupElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: table-row-group;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this));\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedItems = <HTMLEGridCellElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEGridCellElement\r\n            );\r\n        assignedItems.forEach((item_i, i) => {\r\n            item_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEGridRowGroupElement: HTMLEGridRowGroupElementConstructor = HTMLEGridRowGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEListItemElement } from \"./ListItem\";\r\nimport { HTMLEListItemGroupElement } from \"./ListItemGroup\";\r\n\r\nexport { HTMLEListElement };\r\n\r\ninterface HTMLEListElementConstructor {\r\n    prototype: HTMLEListElement;\r\n    new(): HTMLEListElement;\r\n}\r\n\r\ninterface HTMLEListElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly activeItem: HTMLEListItemElement | null;\r\n    readonly dropTargetItem: HTMLEListItemElement | null;\r\n    name: string;\r\n    droptarget: boolean;\r\n    items(): HTMLEListItemElement[];\r\n    beginSelection(): void;\r\n    endSelection(): void;\r\n    selectedItems(): HTMLEListItemElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-list\": HTMLEListElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-list\"\r\n})\r\nclass HTMLEListElementBase extends HTMLElement implements HTMLEListElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get activeItem(): HTMLEListItemElement | null {\r\n        return this.querySelector<HTMLEListItemElement>(\r\n            \"e-listitem[active]\"\r\n        );\r\n    }\r\n\r\n    get dropTargetItem(): HTMLEListItemElement | null {\r\n        return this.querySelector<HTMLEListItemElement>(\r\n            \"e-listitem[droptarget]\"\r\n        );\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n    \r\n    @AttributeProperty({type: Boolean})\r\n    droptarget!: boolean;\r\n\r\n    #onSelection: boolean;\r\n    #hasSelectionChanged: boolean;\r\n    #walker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"style\", {\r\n                children: [\r\n                    /*css*/`\r\n\r\n                    `\r\n                ]\r\n            }),\r\n            element(\"slot\", {\r\n                children: [\r\n                    element(\"slot\")\r\n                ]\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    items(): HTMLEListItemElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEListItemElement>(\r\n            \":is(:scope, :scope > e-listitemgroup) > e-listitem\"\r\n        ));\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        this.#onSelection = false;\r\n        this.#hasSelectionChanged = false;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        this.addEventListener(\"dragend\", this.#handleDragEndEvent.bind(this));\r\n        this.addEventListener(\"dragenter\", this.#handleDragEnterEvent.bind(this));\r\n        this.addEventListener(\"dragover\", this.#handleDragOverEvent.bind(this));\r\n        this.addEventListener(\"dragleave\", this.#handleDragLeaveEvent.bind(this));\r\n        this.addEventListener(\"dragstart\", this.#handleDragStartEvent.bind(this));\r\n        this.addEventListener(\"drop\", this.#handleDropEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const tabIndex = this.getAttribute(\"tabindex\");\r\n        this.tabIndex = tabIndex === null ? 0 : parseInt(tabIndex);\r\n    }\r\n\r\n    beginSelection(): void {\r\n        this.#onSelection = true;\r\n    }\r\n\r\n    endSelection(): void {\r\n        this.#onSelection = false;\r\n        if (this.#hasSelectionChanged) {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged = false;\r\n        }\r\n    }\r\n\r\n    selectedItems(): HTMLEListItemElement[] {\r\n        const selectedItems = [];\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        let item = this.#firstItem();\r\n        while (item !== null) {\r\n            if (item.selected) {\r\n                selectedItems.push(item);\r\n            }\r\n            item = this.#nextItem(item);\r\n        }\r\n        return selectedItems;\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEListItemElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEListItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getItemsRange(from: HTMLEListItemElement, to: HTMLEListItemElement): HTMLEListItemElement[] {\r\n        const items = this.items();\r\n        const fromIndex = items.indexOf(from);\r\n        const toIndex = items.indexOf(to);\r\n        if (fromIndex > -1 && toIndex > -1) {\r\n            if (from == to) {\r\n                return [from];\r\n            }\r\n            return items.slice(\r\n                Math.min(fromIndex, toIndex),\r\n                Math.max(fromIndex, toIndex) + 1\r\n            );\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setSelection(...items: HTMLEListItemElement[]): void {\r\n        this.beginSelection();\r\n        const selectedItems = this.selectedItems();\r\n        selectedItems.forEach((selectedItem_i) => {\r\n            if (!items.includes(selectedItem_i)) {\r\n                selectedItem_i.selected = false;\r\n            }\r\n        });\r\n        items.forEach((item_i) => {\r\n            if (this.contains(item_i) && !item_i.selected) {\r\n                item_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #addToSelection(...items: HTMLEListItemElement[]): void {\r\n        this.beginSelection();\r\n        items.forEach((item_i) => {\r\n            if (!item_i.selected) {\r\n                item_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #removeFromSelection(...items: HTMLEListItemElement[]): void {\r\n        this.beginSelection();\r\n        const selectedItems = this.selectedItems();\r\n        items.forEach((item_i) => {\r\n            if (selectedItems.includes(item_i)) {\r\n                item_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #clearSelection(): void {\r\n        this.beginSelection();\r\n        const selectedItems = this.selectedItems();\r\n        selectedItems.forEach((item_i) => {\r\n            if (item_i.selected) {\r\n                item_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #setActiveItem(item: HTMLEListItemElement | null): void {\r\n        const {activeItem, items} = this;\r\n        if (activeItem !== null && activeItem !== item) {\r\n            activeItem.active = false;\r\n            activeItem.tabIndex = -1;\r\n        }\r\n        if (item !== null) {\r\n            item.active = true;\r\n            item.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #setDropTargetItem(item: HTMLEListItemElement | null): void {\r\n        const {dropTargetItem} = this;\r\n        if (dropTargetItem !== null && dropTargetItem !== item) {\r\n            dropTargetItem.droptarget = false;\r\n        }\r\n        if (item !== null) {\r\n            this.droptarget = true;\r\n            item.droptarget = true;\r\n        }\r\n        else {\r\n            this.droptarget = false;\r\n        }\r\n    }\r\n\r\n    #firstItem(): HTMLEListItemElement | null {\r\n        const walker = this.#walker;\r\n        const {root} = walker;\r\n        walker.currentNode = root;\r\n        return <HTMLEListItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLEListItemElement | null {\r\n        const walker = this.#walker;\r\n        const {root} = walker;\r\n        walker.currentNode = root;\r\n        return <HTMLEListItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLEListItemElement): HTMLEListItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousItem = <HTMLEListItemElement | null>walker.previousNode();\r\n        return previousItem;\r\n    }\r\n\r\n    #nextItem(item: HTMLEListItemElement): HTMLEListItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const nextItem = <HTMLEListItemElement | null>walker.nextNode();\r\n        return nextItem;\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent) {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEListItemElement) {\r\n            const selectedItems = this.selectedItems();\r\n            if (!selectedItems.includes(target)) {\r\n                this.#setSelection(target);\r\n            }\r\n            target.focus({preventScroll: true});\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    #handleDragEndEvent(): void {\r\n        this.#setDropTargetItem(null);\r\n    }\r\n\r\n    #handleDragEnterEvent(event: DragEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEListItemElement) {\r\n            this.#setDropTargetItem(target);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n    \r\n    #handleDragOverEvent(event: DragEvent): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragLeaveEvent(event: DragEvent): void {\r\n        const {relatedTarget} = event;\r\n        let rootNode = <Node>relatedTarget;\r\n        while (!(rootNode instanceof HTMLEListItemElement || rootNode instanceof Document)) {\r\n            rootNode = rootNode.getRootNode();\r\n            if (rootNode instanceof ShadowRoot) {\r\n                rootNode = rootNode.host;\r\n            }\r\n        }\r\n        if (rootNode instanceof Document) {\r\n            this.#setDropTargetItem(null);\r\n        }\r\n    }\r\n\r\n    #handleDragStartEvent(event: DragEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEListItemElement) {\r\n            const selectedItems = this.selectedItems();\r\n            if (!selectedItems.includes(target)) {\r\n                this.#setSelection(target);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(): void {\r\n        this.#setDropTargetItem(null);\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {activeItem} = this;\r\n        if (activeItem && relatedTarget !== activeItem) {\r\n            activeItem.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEListItemElement) {\r\n            this.#setActiveItem(target);\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent) {\r\n        const {key} = event;\r\n        const {activeItem} = this;\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey) {\r\n                    const walker = this.#walker;\r\n                    const {root} = walker;\r\n                    const firstItem = <HTMLEListItemElement>(\r\n                        walker.currentNode = walker.parentNode() ?? root, walker.firstChild()\r\n                    );\r\n                    const lastItem = <HTMLEListItemElement>(\r\n                        walker.currentNode = walker.parentNode() ?? root, walker.lastChild()\r\n                    );\r\n                    const range = this.#getItemsRange(\r\n                        firstItem,\r\n                        lastItem\r\n                    );\r\n                    if (range) {\r\n                        this.#setSelection(...range);\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            previousItem.selected ?\r\n                                this.#removeFromSelection(previousItem) :\r\n                                this.#addToSelection(previousItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.#firstItem();\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            nextItem.selected ?\r\n                                this.#removeFromSelection(nextItem) :\r\n                                this.#addToSelection(nextItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem();\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.#firstItem();\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                const {activeItem} = this;\r\n                if (activeItem) {\r\n                    this.#setSelection(activeItem);\r\n                    activeItem.click();\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                this.#clearSelection();\r\n                this.#setActiveItem(null);\r\n                this.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {target, ctrlKey, shiftKey} = event;\r\n        const selectedItems = this.selectedItems();\r\n        if (target instanceof HTMLEListItemElement) {\r\n            if (!shiftKey && !ctrlKey) {\r\n                this.#setSelection(target);\r\n            }\r\n            else if (ctrlKey) {\r\n                (!target.selected) ?\r\n                    this.#addToSelection(target) :\r\n                    this.#removeFromSelection(target);\r\n                event.stopPropagation();\r\n            }\r\n            else if (shiftKey) {\r\n                const lastSelectedItem = selectedItems[selectedItems.length - 1];\r\n                if (lastSelectedItem) {\r\n                    const range = this.#getItemsRange(\r\n                        lastSelectedItem,\r\n                        target\r\n                    );\r\n                    if (range) {\r\n                        if (selectedItems.includes(target)) {\r\n                            this.#removeFromSelection(...range);\r\n                        }\r\n                        else {\r\n                            this.#addToSelection(...range);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.#setSelection(target);\r\n                }\r\n                event.stopPropagation();\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(): void {\r\n        if (!this.#onSelection) {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n        }\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedItems = <HTMLEListItemElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEListItemElement\r\n            );\r\n        assignedItems.forEach((item_i, i) => {\r\n            item_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEListElement: HTMLEListElementConstructor = HTMLEListElementBase;","import { CustomElement, element, AttributeProperty } from \"../../Element\";\r\nimport { HTMLEMenuElement } from \"../menus/Menu\";\r\nimport { HTMLEToolBarElement } from \"../toolbars/ToolBar\";\r\n\r\nexport { HTMLEListItemElement };\r\n\r\ninterface HTMLEListItemElementConstructor {\r\n    prototype: HTMLEListItemElement;\r\n    new(): HTMLEListItemElement;\r\n}\r\n\r\ninterface HTMLEListItemElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly badge: HTMLSpanElement | null;\r\n    readonly toolbar: HTMLEToolBarElement | null;\r\n    readonly menu: HTMLEMenuElement | null;\r\n    name: string;\r\n    posinset: number;\r\n    label: string;\r\n    droptarget: boolean;\r\n    selected: boolean;\r\n    active: boolean;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-listitem\": HTMLEListItemElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-listitem\"\r\n})\r\nclass HTMLEListItemElementBase extends HTMLElement implements HTMLEListItemElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    get badge(): HTMLElement | null {\r\n        return this.#badge;\r\n    }\r\n\r\n    get toolbar(): HTMLEToolBarElement | null {\r\n        return this.#toolbar;\r\n    }\r\n\r\n    get menu(): HTMLEMenuElement | null {\r\n        return this.#menu;\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Number})\r\n    posinset!: number;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    droptarget!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    selected!: boolean;\r\n\r\n    #badge: HTMLElement | null;\r\n    #toolbar: HTMLEToolBarElement | null;\r\n    #menu: HTMLEMenuElement | null;\r\n    \r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                user-select: none;\r\n                line-height: 22px;\r\n            }\r\n            \r\n            :host([droptarget]) {\r\n                background-color: var(--droptarget-item-color);\r\n            }\r\n            \r\n            :host(:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([active]) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                background-color: var(--focus-background-color);\r\n            }\r\n            \r\n            :host([selected]) {\r\n                background-color: var(--selected-item-color);\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.#badge = null;\r\n        this.#menu = null;\r\n        this.#toolbar = null;\r\n        shadowRoot.addEventListener(\"slotchange\", this.#handleSlotChangeEvent.bind(this))\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"selected\": {\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n            case \"label\": {\r\n                const {shadowRoot} = this;\r\n                const labelPart = shadowRoot.querySelector(\"[part=label]\");\r\n                if (labelPart) {\r\n                    labelPart.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const {name: slotName} = <HTMLSlotElement>target ;\r\n        switch (slotName) {\r\n            case \"toolbar\": {\r\n                const element = (<HTMLSlotElement>target).assignedElements()[0];\r\n                this.#toolbar = element instanceof HTMLEToolBarElement ? element : null;\r\n                break;\r\n            }\r\n            case \"badge\": {\r\n                const element = (<HTMLSlotElement>target).assignedElements()[0];\r\n                this.#badge = element instanceof HTMLSpanElement ? element : null;\r\n                break;\r\n            }\r\n            case \"menu\": {\r\n                const element = (<HTMLSlotElement>target).assignedElements()[0];\r\n                this.#menu = element instanceof HTMLEMenuElement ? element : null;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEListItemElement: HTMLEListItemElementConstructor = HTMLEListItemElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLEListItemElement } from \"./ListItem\";\r\n\r\nexport { HTMLEListItemGroupElement };\r\n\r\ninterface HTMLEListItemGroupElementConstructor {\r\n    prototype: HTMLEListItemGroupElement;\r\n    new(): HTMLEListItemGroupElement;\r\n}\r\n\r\ninterface HTMLEListItemGroupElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-listitemgroup\": HTMLEListItemGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-listitemgroup\"\r\n})\r\nclass HTMLEListItemGroupElementBase extends HTMLElement implements HTMLEListItemGroupElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        shadowRoot.addEventListener(\r\n            \"slotchange\", this.#handleSlotChangeEvent.bind(this)\r\n        );\r\n    }\r\n\r\n    #handleSlotChangeEvent(event: Event): void {\r\n        const {target} = event;\r\n        const assignedItems = <HTMLEListItemElement[]>(<HTMLSlotElement>target)\r\n            .assignedElements()\r\n            .filter(\r\n                element_i => element_i instanceof HTMLEListItemElement\r\n            );\r\n        assignedItems.forEach((item_i, i) => {\r\n            item_i.posinset = i;\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEListItemGroupElement: HTMLEListItemGroupElementConstructor = HTMLEListItemGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEMenuItemElement } from \"./MenuItem\";\r\nimport { HTMLEMenuItemGroupElement } from \"./MenuItemGroup\";\r\n\r\nexport { HTMLEMenuElement };\r\nexport { EMenu };\r\n\r\ninterface HTMLEMenuElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly activeItem: HTMLEMenuItemElement | null;\r\n    firstItem(): HTMLEMenuItemElement | null;\r\n    items(): HTMLEMenuItemElement[];\r\n    name: string;\r\n    contextual: boolean;\r\n    connectedCallback(): void;\r\n    positionContextual(x: number, y: number): void;\r\n}\r\n\r\ninterface HTMLEMenuElementConstructor {\r\n    prototype: HTMLEMenuElement;\r\n    new(): HTMLEMenuElement;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-menu\": HTMLEMenuElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\nvar toggleAnimations: WeakMap<HTMLEMenuItemElement, Animation>;\r\nvar HIDE_DELAY_MS = 200;\r\nvar SHOW_DELAY_MS = 400;\r\n\r\n@CustomElement({\r\n    name: \"e-menu\"\r\n})\r\nclass HTMLEMenuElementBase extends HTMLElement implements HTMLEMenuElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    items(): HTMLEMenuItemElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem\"\r\n        ));\r\n    }\r\n\r\n    get activeIndex(): number {\r\n        return this.#activeIndex;\r\n    }\r\n\r\n    get activeItem(): HTMLEMenuItemElement | null {\r\n        const {activeIndex} = this;\r\n        return this.querySelector<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem:focus-within\"\r\n        ) ?? activeIndex > -1 ? this.items()[activeIndex] ?? null : null;\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    contextual!: boolean;\r\n\r\n    #walker: TreeWalker;\r\n    #activeIndex: number;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                flex-direction: column;\r\n            \r\n                padding: 3px;\r\n                background-color: white;\r\n                width: max-content;\r\n                box-sizing: border-box;\r\n            \r\n                -webkit-box-shadow: var(--menu-box-shadow);\r\n                box-shadow: var(--menu-box-shadow);\r\n            }\r\n            \r\n            :host([contextual]) {\r\n                z-index: 1;\r\n                position: absolute;\r\n            \r\n                transition-property: opacity;\r\n                transition-duration: 0.2s;\r\n                opacity: 0;\r\n            }\r\n            \r\n            :host([contextual]:focus-within) {\r\n                opacity: 1;\r\n            }\r\n        `;\r\n        toggleAnimations = new WeakMap();\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#activeIndex = -1;\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        this.addEventListener(\"mouseout\", this.#handleMouseOutEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const tabindex = this.getAttribute(\"tabindex\");\r\n        this.tabIndex = tabindex !== null ? parseInt(tabindex) : -1;\r\n    }\r\n\r\n    positionContextual(x: number, y: number): void {\r\n        const {style} = this;\r\n        const {width: menuWidth, height: menuHeight} = this.getBoundingClientRect();\r\n        const {scrollX, scrollY} = window;\r\n        const left = x + scrollX;\r\n        const top = y + scrollY;\r\n        const {clientWidth, clientHeight} = document.body;\r\n        const overflowX = left + menuWidth - clientWidth;\r\n        const overflowY = top + menuHeight - clientHeight;\r\n        style.setProperty(\"left\", `${overflowX > 0 ? left - menuWidth : left}px`);\r\n        style.setProperty(\"top\", `${overflowY > 0 ? top - menuHeight : top}px`);\r\n    }\r\n\r\n    #collapseSubmenus(): void {\r\n        this.querySelectorAll<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem[expanded]\"\r\n        )\r\n        .forEach((item_i) => {\r\n            item_i.collapse();\r\n        });\r\n    }\r\n    \r\n    #nearestItem(target: Element): HTMLEMenuItemElement | null {\r\n        return Array.from(this.querySelectorAll<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem\"\r\n        )).find(item_i => item_i.contains(target)) ?? null;\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEMenuItemElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEMenuItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    firstItem(): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEMenuItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEMenuItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEMenuItemElement | null>walker.previousNode();\r\n    }\r\n\r\n    #nextItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEMenuItemElement | null>walker.nextNode();\r\n    }\r\n\r\n    #firstChildItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const {menu} = item;\r\n        return menu instanceof HTMLEMenuElementBase ?\r\n            menu.firstItem() :\r\n            null;\r\n    }\r\n\r\n    #setActiveItem(item: HTMLEMenuItemElement | null): void {\r\n        if (item !== null) {\r\n            this.#activeIndex = this.items().indexOf(item);\r\n        }\r\n    }\r\n    \r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetItem = (<HTMLElement>target).closest(\"e-menuitem\");\r\n        if (targetItem) {\r\n            const {type, checked} = targetItem;\r\n            switch (type) {\r\n                case \"checkbox\": {\r\n                    targetItem.checked = !checked;\r\n                    break;\r\n                }\r\n                case \"radio\": {\r\n                    const {name, value} = targetItem;\r\n                    targetItem.checked = true;\r\n                    this.querySelectorAll<HTMLEMenuItemElement>(\r\n                        `:is(:scope, :scope > e-menuitemgroup) > e-menuitem[type=radio][name=${name}]`\r\n                    )\r\n                    .forEach((radio_i) => {\r\n                        radio_i.checked = radio_i.value == value;\r\n                    });\r\n                    break;\r\n                }\r\n                case \"menu\":\r\n                case \"submenu\": {\r\n                    targetItem.toggle();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEMenuItemElement) {\r\n            const nearestItem = this.#nearestItem(target);\r\n            if (nearestItem) {\r\n                this.#setActiveItem(nearestItem);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            const {contextual} = this;\r\n            if (contextual) {\r\n                try {\r\n                    this.remove();\r\n                }\r\n                catch (error) {};\r\n            }\r\n            else {\r\n                const {activeItem} = this;\r\n                if (activeItem?.expanded) {\r\n                    activeItem.collapse();\r\n                }\r\n                this.#setActiveItem(null);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent) {\r\n        const {key} = event;\r\n        const {activeItem} = this;\r\n        switch (key) {\r\n            case \"ArrowUp\": {\r\n                const previousItem = activeItem ?\r\n                    this.#previousItem(activeItem) ?? this.#lastItem() :\r\n                    this.firstItem();\r\n                previousItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                const nextItem = activeItem ?\r\n                    this.#nextItem(activeItem) ?? this.firstItem() :\r\n                    this.firstItem();\r\n                nextItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.firstItem();\r\n                firstItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                lastItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\":\r\n            case \" \": {\r\n                if (activeItem) {\r\n                    const {type} = activeItem;\r\n                    switch (type) {\r\n                        case \"menu\":\r\n                        case \"submenu\": {\r\n                            activeItem.expand();\r\n                            if (activeItem.expanded) {\r\n                                const firstChildItem = this.#firstChildItem(activeItem);\r\n                                firstChildItem?.focus({preventScroll: true});\r\n                            }\r\n                            break;\r\n                        }\r\n                        default: {\r\n                            activeItem.click();\r\n                            break;\r\n                        }\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (activeItem) {\r\n                    const isClosestTargetMenu = event.composedPath().find(\r\n                        target_i => target_i instanceof HTMLEMenuElement\r\n                    ) == this;\r\n                    if (!isClosestTargetMenu) {\r\n                        activeItem.collapse();\r\n                        activeItem.focus({preventScroll: true});\r\n                        event.stopPropagation();\r\n                    }\r\n                    else {\r\n                        const {contextual} = this;\r\n                        if (contextual) {\r\n                            this.blur();\r\n                            this.dispatchEvent(new Event(\"close\", {bubbles: true}));\r\n                            event.stopPropagation();\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const isClosestTargetMenu = event.composedPath().find(\r\n                        target_i => target_i instanceof HTMLEMenuElement\r\n                    ) == this;\r\n                    if (!isClosestTargetMenu) {\r\n                        activeItem.collapse();\r\n                        activeItem.focus({preventScroll: true});\r\n                        event.stopPropagation();\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const {type} = activeItem;\r\n                    switch (type) {\r\n                        case \"submenu\": {\r\n                            if (!activeItem.expanded) {\r\n                                activeItem.expand();\r\n                                const firstChildItem = this.#firstChildItem(activeItem);\r\n                                firstChildItem?.focus({preventScroll: true});\r\n                                event.stopPropagation();\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseOutEvent(event: MouseEvent): void {\r\n        const {target, relatedTarget} = event;\r\n        if (target instanceof HTMLEMenuItemElement) {\r\n            const nearestItem = this.#nearestItem(target);\r\n            if (nearestItem !== null) {\r\n                if (nearestItem.type == \"submenu\" &&\r\n                    !nearestItem.expanded) {\r\n                    toggleAnimations.get(nearestItem)?.cancel();\r\n                }\r\n                const isTargetClosestMenu = event.composedPath().find(\r\n                    target_i => target_i instanceof HTMLEMenuElement\r\n                ) == this;\r\n                if (isTargetClosestMenu) {\r\n                    const {activeItem} = this;\r\n                    if (activeItem?.type == \"submenu\" &&\r\n                        activeItem.expanded) {\r\n                        let toggleAnimation = toggleAnimations.get(activeItem);\r\n                        if (toggleAnimation) {\r\n                            toggleAnimation.cancel();\r\n                        }\r\n                        toggleAnimation = activeItem.animate(null, {\r\n                            duration: HIDE_DELAY_MS\r\n                        });\r\n                        toggleAnimations.set(activeItem, toggleAnimation);\r\n                        const {finished} = toggleAnimation;\r\n                        finished\r\n                            .then(() => {\r\n                                activeItem.collapse();\r\n                            })\r\n                            .catch(() => undefined)\r\n                            .finally(() => {\r\n                                toggleAnimations.delete(activeItem);\r\n                            });\r\n                    }\r\n                    const {clientX, clientY} = event;\r\n                    const {left, right, top, bottom} = this.getBoundingClientRect();\r\n                    const intersectsWithMouse = !(\r\n                        left > clientX || right < clientX || top > clientY || bottom < clientY\r\n                    );\r\n                    const containsRelatedTarget = this.contains(<Node>relatedTarget);\r\n                    if (intersectsWithMouse && containsRelatedTarget) {\r\n                        if (relatedTarget instanceof HTMLEMenuElement && relatedTarget !== this) {\r\n                            relatedTarget.focus({preventScroll: true});\r\n                        }\r\n                        else {\r\n                            this.focus({preventScroll: true});\r\n                            this.#setActiveItem(null);\r\n                        }\r\n                    }\r\n                    if (!intersectsWithMouse) {\r\n                        this.focus({preventScroll: true});\r\n                        this.#setActiveItem(null);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof HTMLEMenuItemElement) {\r\n            const nearestItem = this.#nearestItem(target);\r\n            if (nearestItem !== null) {\r\n                if (nearestItem.type === \"submenu\" && nearestItem.expanded) {\r\n                    toggleAnimations.get(nearestItem)?.cancel();\r\n                }\r\n                const isTargetClosestMenu = event.composedPath().find(\r\n                    target_i => target_i instanceof HTMLEMenuElement\r\n                ) == this;\r\n                if (isTargetClosestMenu) {\r\n                    const {activeItem} = this;\r\n                    if (activeItem?.type === \"submenu\" &&\r\n                        activeItem.expanded && \r\n                        !activeItem.contains(<Node>target)) {\r\n                        let toggleAnimation = toggleAnimations.get(activeItem);\r\n                        if (toggleAnimation) {\r\n                            toggleAnimation.cancel();\r\n                        }\r\n                        toggleAnimation = activeItem.animate(null, {\r\n                            duration: SHOW_DELAY_MS\r\n                        });\r\n                        toggleAnimations.set(activeItem, toggleAnimation);\r\n                        const {finished} = toggleAnimation;\r\n                        finished\r\n                            .then(() => {\r\n                                activeItem.collapse();\r\n                            })\r\n                            .catch(() => undefined)\r\n                            .finally(() => {\r\n                                toggleAnimations.delete(activeItem);\r\n                            });\r\n                    }\r\n                    this.#setActiveItem(nearestItem);\r\n                    nearestItem.focus({preventScroll: true});\r\n                    if (nearestItem.type === \"submenu\") {\r\n                        if (!nearestItem.expanded) {\r\n                            let toggleAnimation = toggleAnimations.get(nearestItem);\r\n                            if (toggleAnimation) {\r\n                                toggleAnimation.cancel();\r\n                            }\r\n                            toggleAnimation = nearestItem.animate(null, {\r\n                                duration: HIDE_DELAY_MS\r\n                            });\r\n                            toggleAnimations.set(nearestItem, toggleAnimation);\r\n                            const {finished} = toggleAnimation;\r\n                            finished\r\n                                .then(() => {\r\n                                    const {activeItem} = this;\r\n                                    this.#collapseSubmenus();\r\n                                    if (activeItem) {\r\n                                        toggleAnimations.get(activeItem)?.cancel();\r\n                                        activeItem.expand();\r\n                                        activeItem.menu?.focus({preventScroll: true});\r\n                                    }\r\n                                })\r\n                                .catch(() => undefined)\r\n                                .finally(() => {\r\n                                    toggleAnimations.delete(nearestItem);\r\n                                });\r\n                        }\r\n                        else {\r\n                            nearestItem.menu?.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEMenuElement: HTMLEMenuElementConstructor = HTMLEMenuElementBase;\r\n\r\ninterface EMenuConstructor {\r\n    prototype: HTMLEMenuElement;\r\n    new(init: {\r\n        name?: string;\r\n        children?: (HTMLEMenuItemElement | HTMLEMenuItemGroupElement | HTMLHRElement)[];\r\n    }): HTMLEMenuElement;\r\n}\r\n\r\nvar EMenu = <EMenuConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        name?: string;\r\n        children?: (HTMLEMenuItemElement | HTMLEMenuItemGroupElement | HTMLHRElement)[];\r\n    }) {\r\n        const {name, children} = init;\r\n        return element(\"e-menu\", {\r\n            attributes: {\r\n                name: name,\r\n                tabindex: -1,\r\n            },\r\n            children: children\r\n        });\r\n    }, {\r\n        prototype: HTMLEMenuElement.prototype,\r\n    }\r\n);","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEMenuItemElement } from \"./MenuItem\";\r\nimport { HTMLEMenuItemGroupElement } from \"./MenuItemGroup\";\r\n\r\nexport { HTMLEMenuBarElement };\r\n\r\ninterface HTMLEMenuBarElementConstructor {\r\n    prototype: HTMLEMenuBarElement;\r\n    new(): HTMLEMenuBarElement;\r\n}\r\n\r\ninterface HTMLEMenuBarElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    items(): HTMLEMenuItemElement[];\r\n    readonly activeItem: HTMLEMenuItemElement | null;\r\n    readonly activeIndex: number;\r\n    name: string;\r\n    expanded: boolean;\r\n    connectedCallback(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-menubar\": HTMLEMenuBarElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-menubar\"\r\n})\r\nclass HTMLEMenuBarElementBase extends HTMLElement implements HTMLEMenuBarElement {\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    expanded!: boolean;\r\n    \r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    #activeIndex: number;\r\n    #walker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                flex-direction: row;\r\n                width: max-content;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        this.#activeIndex = -1;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const tabindex = this.getAttribute(\"tabindex\");\r\n        this.tabIndex = tabindex !== null ? parseInt(tabindex) : -1;\r\n    }\r\n\r\n    items(): HTMLEMenuItemElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem\"\r\n        ));\r\n    }\r\n\r\n    get activeIndex(): number {\r\n        return this.#activeIndex;\r\n    }\r\n\r\n    get activeItem(): HTMLEMenuItemElement | null {\r\n        const {activeIndex} = this;\r\n        return this.querySelector<HTMLEMenuItemElement>(\r\n            \":is(:scope, :scope > e-menuitemgroup) > e-menuitem:focus-within\"\r\n        ) ?? activeIndex > -1 ? this.items()[activeIndex] ?? null : null;\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEMenuItemElement && !(node.disabled || node.hidden)) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEMenuItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    firstItem(): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEMenuItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEMenuItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEMenuItemElement | null>walker.previousSibling();\r\n    }\r\n\r\n    #nextItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEMenuItemElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #firstChildItem(item: HTMLEMenuItemElement): HTMLEMenuItemElement | null {\r\n        const {menu} = item;\r\n        if (menu) {\r\n            const walker = this.#walker;\r\n            walker.currentNode = menu;\r\n            return <HTMLEMenuItemElement | null>walker.firstChild();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #setActiveItem(item: HTMLEMenuItemElement | null): void {\r\n        const {activeItem, expanded} = this;\r\n        if (activeItem !== null && activeItem !== item) {\r\n            activeItem.collapse();\r\n        }\r\n        if (item !== null) {\r\n            if (expanded) {\r\n                item.expand();\r\n            }\r\n            this.#activeIndex = this.items().indexOf(item);\r\n        }\r\n        else {\r\n            this.#activeIndex = -1;\r\n        }\r\n    }\r\n\r\n    get #items(): HTMLEMenuItemElement[] {\r\n        return Array.from(\r\n            this.querySelectorAll(\":is(:scope, :scope > e-menuitemgroup) > e-menuitem\")\r\n        );\r\n    }\r\n\r\n    #isClosestMenu(target: Element): boolean {\r\n        return target.closest(\":is(e-menubar, e-menu)\") == this;\r\n    }\r\n\r\n    #nearestItem(target: Element): HTMLEMenuItemElement | null {\r\n        return this.#items.find(item_i => item_i.contains(target)) ?? null;\r\n    }\r\n    \r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {activeItem} = this;\r\n        if (!this.contains(<Node | null>relatedTarget)) {\r\n            (activeItem ?? this.firstItem())?.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        if (target instanceof Element) {\r\n            const nearestItem = this.#nearestItem(target);\r\n            this.#setActiveItem(nearestItem);\r\n            this.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {target, relatedTarget} = event;\r\n        if (target instanceof HTMLElement) {\r\n            const nearestItem = this.#nearestItem(target);\r\n            if (nearestItem) {\r\n                nearestItem.collapse();\r\n            }\r\n        }\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.expanded = false;\r\n            this.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const {expanded, activeItem} = this;\r\n        if (target instanceof HTMLEMenuItemElement) {\r\n            const isClosestMenu = this.#isClosestMenu(target);\r\n            if (isClosestMenu && target !== activeItem && expanded) {\r\n                const {menu} = target;\r\n                if (menu) {\r\n                    target.expand();\r\n                    menu.focus({preventScroll: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const {expanded, activeItem} = this;\r\n        if (target instanceof HTMLEMenuItemElement) {\r\n            const isClosestMenu = this.#isClosestMenu(target);\r\n            if (isClosestMenu) {\r\n                const isExpanded = !expanded;\r\n                this.expanded = isExpanded;\r\n                if (isExpanded) {\r\n                    if (activeItem && !activeItem.expanded) {\r\n                        activeItem.expand();\r\n                    }\r\n                    const {menu} = target;\r\n                    menu?.focus({preventScroll: true});\r\n                }\r\n                else {\r\n                    if (activeItem) {\r\n                        activeItem.collapse();\r\n                        activeItem.blur();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {expanded} = this;\r\n        let {activeItem} = this;\r\n        switch (key) {\r\n            case \"ArrowLeft\": {\r\n                const previousItem = activeItem ?\r\n                    this.#previousItem(activeItem) ?? this.#lastItem() :\r\n                    this.firstItem();\r\n                previousItem?.focus({preventScroll: true});\r\n                ({activeItem} = this);\r\n                if (expanded && activeItem) {\r\n                    const firstChildItem = this.#firstChildItem(activeItem);\r\n                    firstChildItem?.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                const nextItem = activeItem ?\r\n                    this.#nextItem(activeItem) ?? this.firstItem() : \r\n                    this.#lastItem();\r\n                nextItem?.focus({preventScroll: true});\r\n                ({activeItem} = this);\r\n                if (expanded && activeItem) {\r\n                    const firstChildItem = this.#firstChildItem(activeItem);\r\n                    firstChildItem?.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n            case \"Enter\":\r\n            case \" \": {\r\n                if (activeItem) {\r\n                    this.expanded = !expanded;\r\n                    if (!expanded) {\r\n                        const firstChildItem = this.#firstChildItem(activeItem);\r\n                        firstChildItem?.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (expanded) {\r\n                    this.expanded = false;\r\n                    if (activeItem) {\r\n                        activeItem.collapse();\r\n                        activeItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    this.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEMenuBarElement: HTMLEMenuBarElementConstructor = HTMLEMenuBarElementBase;","import { CustomElement, AttributeProperty, element, QueryProperty } from \"../../Element\";\r\nimport { HTMLEMenuElement } from \"./Menu\";\r\nimport { HTMLEMenuItemElement } from \"./MenuItem\";\r\n\r\nexport { HTMLEMenuButtonElement };\r\nexport { EMenuButton };\r\n\r\ninterface HTMLEMenuButtonElementConstructor {\r\n    prototype: HTMLEMenuButtonElement;\r\n    new(): HTMLEMenuButtonElement;\r\n}\r\n\r\ninterface HTMLEMenuButtonElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly menu: HTMLEMenuElement | null;\r\n    readonly firstItem: HTMLEMenuItemElement | null;\r\n    name: string;\r\n    disabled: boolean;\r\n    expanded: boolean;\r\n    connectedCallback(): void;\r\n    toggle(force?: boolean): void;\r\n    expand(): void;\r\n    collapse(): void;\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-menubutton\"\r\n})\r\nclass HTMLEMenuButtonElementBase extends HTMLElement implements HTMLEMenuButtonElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    @QueryProperty({selector: \":scope > e-menu[slot=menu]\"})\r\n    readonly menu!: HTMLEMenuElement | null;\r\n    \r\n    @QueryProperty({selector: \":scope > e-menu[slot=menu] e-menuitem\"})\r\n    readonly firstItem!: HTMLEMenuItemElement | null;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    disabled!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    expanded!: boolean;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\"),\r\n            element(\"slot\", {\r\n                attributes: {\r\n                    name: \"menu\"\r\n                }\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: inline-block;\r\n                padding: 2px;\r\n                line-height: 18px;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                cursor: pointer;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            :host(:focus-within:not(:focus)) {\r\n                background-color: var(--focused-item-color);\r\n            }\r\n            \r\n            :host(:hover:not(:focus-within)) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                color: lightgray;\r\n            }\r\n            \r\n            ::slotted([slot=\"menu\"]) {\r\n                z-index: 1;\r\n                position: absolute;\r\n                color: initial;\r\n            }\r\n            \r\n            :host(:not([expanded])) ::slotted([slot=\"menu\"]) {\r\n                opacity: 0;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host::after {\r\n                display: inline-block;\r\n                text-align: center;\r\n                width: 18px;\r\n                height: 18px;\r\n                content: \"▾\";\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const tabindex = this.getAttribute(\"tabindex\");\r\n        this.tabIndex = tabindex !== null ? parseInt(tabindex) : -1;\r\n    }\r\n\r\n    toggle(force?: boolean): void {\r\n        const {expanded} = this;\r\n        const expand = force ?? !expanded;\r\n        expand ? this.expand() : this.collapse();\r\n    }\r\n\r\n    expand(): void {\r\n        const {expanded} = this;\r\n        if (!expanded) {\r\n            this.expanded = true;\r\n            this.#positionMenu();\r\n        }\r\n    }\r\n\r\n    collapse(): void {\r\n        const {expanded} = this;\r\n        if (expanded) {\r\n            this.expanded = false;\r\n        }\r\n    }\r\n\r\n    #positionMenu(): void {\r\n        const {menu} = this;\r\n        if (menu !== null) {\r\n            const {style: menuStyle} = menu;\r\n            let {top: itemTop, bottom: itemBottom, left: itemLeft, right: itemRight} = this.getBoundingClientRect();\r\n            const {width: menuWidth, height: menuHeight} = menu.getBoundingClientRect();\r\n            const {clientWidth, clientHeight} = document.body;\r\n            const offsetParent = <HTMLElement>(menu.offsetParent ?? document.body);\r\n            const {offsetLeft, offsetTop} = offsetParent;\r\n            const overflowX = itemRight + menuWidth - clientWidth;\r\n            const overflowY = itemTop + menuHeight - clientHeight;\r\n            itemLeft -= offsetLeft;\r\n            itemRight -= offsetLeft;\r\n            itemTop -= offsetTop;\r\n            itemBottom -= offsetTop;\r\n            menuStyle.setProperty(\"left\", `${\r\n                overflowX > 0 ?\r\n                itemRight - menuWidth :\r\n                itemLeft\r\n            }px`);\r\n            menuStyle.setProperty(\"top\", `${\r\n                overflowY > 0 ?\r\n                itemTop - menuHeight :\r\n                itemBottom\r\n            }px`);\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const {menu} = this;\r\n        if (menu && !menu.contains(<Node>target)) {\r\n            this.toggle();\r\n            const {expanded} = this;\r\n            if (expanded) {\r\n                menu?.focus({preventScroll: true});\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {expanded} = this;\r\n        switch (key) {\r\n            case \"ArrowDown\":\r\n            case \"Enter\":\r\n                if (!expanded) {\r\n                    this.expand();\r\n                    this.firstItem?.focus({preventScroll: true});\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            case \"Escape\":\r\n                if (expanded) {\r\n                    this.collapse();\r\n                }\r\n                this.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEMenuButtonElement: HTMLEMenuButtonElementConstructor = HTMLEMenuButtonElementBase;\r\n\r\ninterface EMenuButtonConstructor {\r\n    prototype: HTMLEMenuButtonElement;\r\n    new(init: {\r\n        menu: HTMLEMenuElement\r\n    }): HTMLEMenuButtonElement;\r\n}\r\n\r\nvar EMenuButton = <EMenuButtonConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        menu: HTMLEMenuElement\r\n    }) {\r\n        const {menu} = init;\r\n        menu.slot = \"menu\";\r\n        return element(\"e-menubutton\", {\r\n            attributes: {\r\n                tabindex: -1\r\n            },\r\n            children: [menu]\r\n        });\r\n    }, {\r\n        prototype: HTMLEMenuButtonElement.prototype,\r\n    }\r\n);","import { CustomElement, AttributeProperty, QueryProperty, element } from \"../../Element\";\r\nimport { HTMLEMenuElement } from \"./Menu\";\r\n\r\nexport { HTMLEMenuItemElement };\r\nexport { EMenuItem };\r\n\r\ninterface HTMLEMenuItemElementConstructor {\r\n    prototype: HTMLEMenuItemElement;\r\n    new(): HTMLEMenuItemElement;\r\n}\r\n\r\ninterface HTMLEMenuItemElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n    get menu(): HTMLEMenuElement | null;\r\n    name: string;\r\n    label: string | null;\r\n    value: string;\r\n    hotkey: string;\r\n    disabled: boolean;\r\n    checked: boolean;\r\n    expanded: boolean;\r\n    type: \"button\" | \"checkbox\" | \"radio\" | \"menu\" | \"submenu\";\r\n    connectedCallback(): void;\r\n    attributeChangedCallback(attributeName: string, oldValue: string | null, newValue: string | null): void;\r\n    toggle(force?: boolean): void;\r\n    expand(): void;\r\n    collapse(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-menuitem\": HTMLEMenuItemElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-menuitem\"\r\n})\r\nclass HTMLEMenuItemElementBase extends HTMLElement implements HTMLEMenuItemElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n    \r\n    @QueryProperty({selector: \":scope > e-menu[slot=menu]\"})\r\n    menu!: HTMLEMenuElement | null;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string | null;\r\n\r\n    @AttributeProperty({type: String})\r\n    value!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    hotkey!: string;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    disabled!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    checked!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    expanded!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    overflown!: boolean;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"button\", observed: true})\r\n    type!: \"button\" | \"checkbox\" | \"radio\" | \"menu\" | \"submenu\";\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"icon\"\r\n                }\r\n            }),\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"label\"\r\n                },\r\n                children: [\r\n                    element(\"slot\")\r\n                ]\r\n            }),\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"arrow\"\r\n                }\r\n            }),\r\n            element(\"slot\", {\r\n                attributes: {\r\n                    name: \"menu\"\r\n                }\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                box-sizing: border-box;\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host(:focus-within) {\r\n                background-color: var(--focused-item-color);\r\n            }\r\n\r\n            :host(:focus-visible) {\r\n                outline: none;\r\n            }\r\n            \r\n            :host(:is([type=\"menu\"], [type=\"submenu\"])) ::slotted([slot=\"menu\"]) {\r\n                z-index: 1;\r\n                position: absolute;\r\n            }\r\n            \r\n            :host(:is([type=\"menu\"], [type=\"submenu\"]):not([expanded])) ::slotted([slot=\"menu\"]) {\r\n                opacity: 0;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host([type=\"submenu\"]) [part=\"icon\"] {\r\n                visibility: hidden;\r\n            }\r\n            \r\n            :host([type=\"menu\"]) [part=\"icon\"],\r\n            :host(:not([type=\"submenu\"])) [part=\"arrow\"] {\r\n                display: none;\r\n            }\r\n            \r\n            :host(:is([type=\"checkbox\"], [type=\"radio\"])[checked]) {\r\n                --icon-color: black;\r\n                --icon-image: url(\"/assets/done_FILL0_wght400_GRAD0_opsz48.svg\");\r\n            }\r\n            \r\n            :host([type=\"submenu\"]) {\r\n                --arrow-color: black;\r\n                --arrow-image: url(\"/assets/arrow_right_FILL0_wght400_GRAD0_opsz48.svg\");\r\n            }\r\n            \r\n            [part=\"icon\"],\r\n            [part=\"label\"],\r\n            [part=\"arrow\"] {\r\n                pointer-events: none;\r\n            }\r\n            \r\n            [part=\"icon\"] {\r\n                flex: none;\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                padding: 2px;\r\n                overflow: hidden;\r\n                margin-right: 4px;\r\n            }\r\n            \r\n            [part=\"label\"] {\r\n                flex: auto;\r\n                line-height: 18px;\r\n                padding: 2px;\r\n                margin-left: 8px;\r\n                margin-right: 8px;\r\n            }\r\n            \r\n            :host(:is(:not([type]), [type=\"button\"], [type=\"radio\"], [type=\"checkbox\"])[checked]) [part=\"icon\"] {\r\n                background-color: var(--activated-item-color);\r\n            }\r\n            \r\n            :host(:is(:not([type]), [type=\"button\"], [type=\"radio\"], [type=\"checkbox\"])) [part=\"icon\"]::before {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                content: \"\";\r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--icon-color, none);\r\n                -webkit-mask-image: var(--icon-image, none);\r\n                mask-image: var(--icon-image, none);\r\n                filter: var(--icon-filter, none);\r\n            }\r\n            \r\n            [part=\"arrow\"] {\r\n                flex: none;\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px 4px 1px 1px;\r\n            }\r\n            \r\n            [part=\"arrow\"]::after {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px;\r\n                content: \"\";\r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--arrow-color, none);\r\n                -webkit-mask-image: var(--arrow-image, none);\r\n                mask-image: var(--arrow-image, none);\r\n                filter: var(--arrow-filter, none);\r\n            }\r\n\r\n            :host(:hover):host-context(e-menubar:focus),\r\n            :host(:hover):host-context(e-menubar:not(:focus-within)) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const internals = this.attachInternals();\r\n        this.internals = internals;\r\n        internals.role = \"menuitem\";\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    attributeChangedCallback(attributeName: string, oldValue: string | null, newValue: string | null): void {\r\n        const {internals} = this;\r\n        switch (attributeName) {\r\n            case \"type\": {\r\n                switch (newValue) {\r\n                    case \"checkbox\":\r\n                    case \"radio\": {\r\n                        internals.role = `menuitem${newValue}`;\r\n                        break;\r\n                    }\r\n                    default: {\r\n                        internals.role = \"menuitem\";\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"checked\": {\r\n                internals.ariaChecked = String(newValue !== null);\r\n                break;\r\n            }\r\n            case \"disabled\": {\r\n                internals.ariaDisabled = String(newValue !== null);\r\n                break;\r\n            }\r\n            case \"expanded\": {\r\n                internals.ariaExpanded = String(newValue !== null);\r\n                break;\r\n            }\r\n            case \"label\": {\r\n                internals.ariaLabel = newValue;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    toggle(force?: boolean): void {\r\n        const {type, expanded} = this;\r\n        switch (type) {\r\n            case \"menu\":\r\n            case \"submenu\": {\r\n                const expand = force ?? !expanded;\r\n                this.expanded = expand;\r\n                if (expand) {\r\n                    this.#positionMenu();\r\n                }\r\n                this.dispatchEvent(new Event(\"toggle\", {bubbles: true}));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    expand(): void {\r\n        const {type, expanded} = this;\r\n        switch (type) {\r\n            case \"menu\":\r\n            case \"submenu\": {\r\n                if (!expanded) {\r\n                    this.expanded = true;\r\n                    this.#positionMenu();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    collapse(): void {\r\n        const {type, expanded} = this;\r\n        switch (type) {\r\n            case \"menu\":\r\n            case \"submenu\": {\r\n                if (expanded) {\r\n                    this.expanded = false;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #positionMenu(): void {\r\n        const {menu} = this;\r\n        if (menu !== null) {\r\n            const {style: menuStyle} = menu;\r\n            let {top: itemTop, bottom: itemBottom, left: itemLeft, right: itemRight} = this.getBoundingClientRect();\r\n            const {width: menuWidth, height: menuHeight} = menu.getBoundingClientRect();\r\n            const {clientWidth, clientHeight} = document.body;\r\n            const {type} = this;\r\n            if (type === \"menu\") {\r\n                const offsetParent = <HTMLElement>(menu.offsetParent ?? document.body);\r\n                const {offsetLeft, offsetTop} = offsetParent;\r\n                const overflowX = itemRight + menuWidth - clientWidth;\r\n                const overflowY = itemTop + menuHeight - clientHeight;\r\n                itemLeft -= offsetLeft;\r\n                itemRight -= offsetLeft;\r\n                itemTop -= offsetTop;\r\n                itemBottom -= offsetTop;\r\n                menuStyle.setProperty(\"left\", `${\r\n                    overflowX > 0 ?\r\n                    itemRight - menuWidth :\r\n                    itemLeft\r\n                }px`);\r\n                menuStyle.setProperty(\"top\", `${\r\n                    overflowY > 0 ?\r\n                    itemTop - menuHeight  :\r\n                    itemBottom\r\n                }px`);\r\n            }\r\n            else {\r\n                const overflowX = itemRight + menuWidth - clientWidth;\r\n                const overflowY = itemTop + menuHeight - clientHeight;\r\n                const closestMenu = this.closest(\"e-menu\");\r\n                if (closestMenu !== null) {\r\n                    const {top: closestMenuTop, left: closestMenuLeft} = closestMenu.getBoundingClientRect();\r\n                    itemLeft -= closestMenuLeft;\r\n                    itemRight -= closestMenuLeft;\r\n                    itemTop -= closestMenuTop;\r\n                    itemBottom -= closestMenuTop;\r\n                }\r\n                menuStyle.setProperty(\"left\", `${\r\n                    overflowX > 0 ?\r\n                    itemLeft - menuWidth :\r\n                    itemRight\r\n                }px`);\r\n                menuStyle.setProperty(\"top\", `${\r\n                    overflowY > 0 ?\r\n                    itemBottom - menuHeight :\r\n                    itemTop\r\n                }px`);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEMenuItemElement: HTMLEMenuItemElementConstructor = HTMLEMenuItemElementBase;\r\n\r\ninterface EMenuItemConstructor {\r\n    prototype: HTMLEMenuItemElement;\r\n    new(init: {\r\n        name?: string;\r\n        label: string;\r\n        type?: \"button\" | \"checkbox\" | \"radio\" | \"menu\" | \"submenu\";\r\n        value?: string;\r\n        trigger?: () => void;\r\n        menu?: HTMLEMenuElement;\r\n    }): HTMLEMenuItemElement;\r\n    button(init: {\r\n        name?: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEMenuItemElement;\r\n    checkbox(init: {\r\n        name?: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEMenuItemElement;\r\n    radio(init: {\r\n        name?: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEMenuItemElement;\r\n    menu(init: {\r\n        name?: string;\r\n        label: string;\r\n        menu: HTMLEMenuElement;\r\n    }): HTMLEMenuItemElement;\r\n    submenu(init: {\r\n        name?: string;\r\n        label: string;\r\n        menu: HTMLEMenuElement;\r\n    }): HTMLEMenuItemElement;\r\n}\r\n\r\nvar EMenuItem = <EMenuItemConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        name?: string;\r\n        label: string;\r\n        type?: \"button\" | \"checkbox\" | \"radio\" | \"menu\" | \"submenu\";\r\n        value?: string;\r\n        trigger?: () => void;\r\n        menu?: HTMLEMenuElement;\r\n    }) {\r\n        const {label, name, type, value, trigger, menu} = init;\r\n        if (menu) {\r\n            menu.slot = \"menu\";\r\n        }\r\n        return element(\"e-menuitem\", {\r\n            attributes: {\r\n                tabindex: -1,\r\n                title: label,\r\n                name: name,\r\n                value: value,\r\n                type: type\r\n            },\r\n            children: menu ? [\r\n                label,\r\n                menu\r\n            ] : [\r\n                label\r\n            ],\r\n            listeners: {\r\n                click: trigger\r\n            }\r\n        });\r\n    }, {\r\n        prototype: HTMLEMenuItemElement.prototype,\r\n        button(init: {\r\n            name?: string,\r\n            label: string,\r\n            value?: string,\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EMenuItem({\r\n                ...init, type: \"button\"\r\n            });\r\n        },\r\n        checkbox(init: {\r\n            name?: string;\r\n            label: string;\r\n            value?: string;\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EMenuItem({\r\n                ...init, type: \"checkbox\"\r\n            });\r\n        },\r\n        radio(init: {\r\n            name?: string;\r\n            label: string;\r\n            value?: string;\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EMenuItem({\r\n                ...init, type: \"radio\"\r\n            });\r\n        },\r\n        menu(init: {\r\n            name?: string;\r\n            label: string;\r\n            menu: HTMLEMenuElement;\r\n        }) {\r\n            return new EMenuItem({\r\n                ...init, type: \"menu\"\r\n            });\r\n        },\r\n        submenu(init: {\r\n            name?: string;\r\n            label: string;\r\n            menu: HTMLEMenuElement;\r\n        }) {\r\n            return new EMenuItem({\r\n                ...init, type: \"submenu\"\r\n            });\r\n        }\r\n    }\r\n);","import { element, CustomElement, AttributeProperty } from \"../../Element\";\r\nimport { HTMLEMenuItemElement, EMenuItem } from \"./MenuItem\";\r\n\r\nexport { HTMLEMenuItemGroupElement };\r\nexport { EMenuItemGroup };\r\n\r\ninterface HTMLEMenuItemGroupElementConstructor {\r\n    prototype: HTMLEMenuItemGroupElement;\r\n    new(): HTMLEMenuItemGroupElement;\r\n}\r\n\r\ninterface HTMLEMenuItemGroupElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    name: string;\r\n    label: string;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-menuitemgroup\": HTMLEMenuItemGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-menuitemgroup\"\r\n})\r\nclass HTMLEMenuItemGroupElementBase extends HTMLElement implements HTMLEMenuItemGroupElement {\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"label\"\r\n                }\r\n            }),\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                flex-direction: column;\r\n            }\r\n            \r\n            [part=\"label\"] {\r\n                font-weight: bold;\r\n            }\r\n            \r\n            :host([label]) [part=\"label\"] {\r\n                padding-bottom: 6px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        const internals = this.attachInternals();\r\n        internals.role = \"group\";\r\n        this.internals = internals;\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        const {internals} = this;\r\n        switch (name) {\r\n            case \"label\":\r\n                internals.ariaLabel = newValue;\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEMenuItemGroupElement: HTMLEMenuItemGroupElementConstructor = HTMLEMenuItemGroupElementBase;\r\n\r\ninterface EMenuItemGroupConstructor {\r\n    prototype: HTMLEMenuItemGroupElement;\r\n    new(init: {\r\n        name?: string;\r\n        items: HTMLEMenuItemElement[];\r\n    }): HTMLEMenuItemGroupElement;\r\n    radios(init: {name: string, items: {label: string, value: string}[]}): HTMLEMenuItemGroupElement;\r\n}\r\n\r\nvar EMenuItemGroup = <EMenuItemGroupConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        name?: string,\r\n        items: HTMLEMenuItemElement[]\r\n    }) {\r\n        const {name, items} = init;\r\n        return element(\"e-menuitemgroup\", {\r\n            attributes: {\r\n                name: name\r\n            },\r\n            children: items\r\n        });\r\n    }, {\r\n        prototype: HTMLEMenuItemGroupElement.prototype,\r\n        radios: (init: {\r\n            name: string,\r\n            items: {\r\n                label: string,\r\n                value: string\r\n            }[]\r\n        }) => {\r\n            const {name, items} = init;\r\n            return element(\"e-menuitemgroup\", {\r\n                attributes: {\r\n                    name: name\r\n                },\r\n                children: items.map(\r\n                    ({label, value}) => new EMenuItem({name, label, type: \"radio\", value})\r\n                )\r\n            });\r\n        }\r\n    }\r\n);","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEStatusItemElement } from \"./StatusItem\";\r\nimport { HTMLEStatusItemGroupElement } from \"./StatusItemGroup\";\r\n\r\nexport { HTMLEStatusBarElement };\r\n\r\n\r\ninterface HTMLEStatusBarElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly activeItem: HTMLEStatusItemElement | null;\r\n    items(): HTMLEStatusItemElement[];\r\n    firstItem(): HTMLEStatusItemElement | null;\r\n}\r\n\r\ninterface HTMLEToolbarElementConstructor {\r\n    prototype: HTMLEStatusBarElement;\r\n    new(): HTMLEStatusBarElement;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-statusbar\": HTMLEStatusBarElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-statusbar\"\r\n})\r\nclass HTMLEStatusBarElementBase extends HTMLElement implements HTMLEStatusBarElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get activeItem(): HTMLEStatusItemElement | null {\r\n        return this.querySelector<HTMLEStatusItemElement>(\r\n            \"e-statusitem[active]\"\r\n        );\r\n    }\r\n\r\n    items(): HTMLEStatusItemElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEStatusItemElement>(\r\n            \":is(:scope, :scope > e-statusitemgroup) > e-statusitem\"\r\n        ));\r\n    }\r\n\r\n    #walker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                flex-direction: row;\r\n            }\r\n\r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n\r\n            ::slotted(e-statusitem:not(:first-child)) {\r\n                margin-left: 4px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#nodeFilter.bind(this)\r\n        );\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        this.addEventListener(\"dblclick\", this.#handleDblClickEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    #nodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEStatusItemElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEStatusItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    firstItem(): HTMLEStatusItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEStatusItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLEStatusItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEStatusItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLEStatusItemElement): HTMLEStatusItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousItem = <HTMLEStatusItemElement | null>walker.previousSibling();\r\n        return previousItem;\r\n    }\r\n\r\n    #nextItem(item: HTMLEStatusItemElement): HTMLEStatusItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEStatusItemElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #setActiveItem(item: HTMLEStatusItemElement | null): void {\r\n        const {activeItem} = this;\r\n        if (activeItem !== null && activeItem !== item) {\r\n            activeItem.active = false;\r\n        }\r\n        if (item !== null) {\r\n            item.active = true;\r\n        }\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleDblClickEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {activeItem} = this;\r\n        if (!this.contains(<Node>relatedTarget)) {\r\n            (activeItem ?? this.firstItem())?.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLEStatusItemElement | null>(<HTMLElement>target).closest(\"e-statusitem\");\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetItem);\r\n            this.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {activeItem} = this;\r\n        switch (key) {\r\n            case \"Enter\": {\r\n                if (activeItem) {\r\n                    activeItem.click();\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.firstItem();\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem();\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.firstItem();\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                this.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEStatusBarElement: HTMLEToolbarElementConstructor = HTMLEStatusBarElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\n\r\nexport { HTMLEStatusItemElement };\r\nexport { EStatusItem };\r\n\r\ninterface HTMLEStatusItemElementConstructor {\r\n    prototype: HTMLEStatusItemElement;\r\n    new(): HTMLEStatusItemElement;\r\n}\r\n\r\ninterface HTMLEStatusItemElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    name: string;\r\n    active: boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-statusitem\": HTMLEStatusItemElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-statusitem\"\r\n})\r\nclass HTMLEStatusItemElementBase extends HTMLElement implements HTMLEStatusItemElement {\r\n    \r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"content\"\r\n                },\r\n                children: element(\"slot\")\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                cursor: pointer;\r\n                line-height: 22px;\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host(:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host(:focus-within):host-context(e-statusbar:focus-within) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            [part=\"content\"] {\r\n                padding: 0 4px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n}\r\n\r\nvar HTMLEStatusItemElement: HTMLEStatusItemElementConstructor = HTMLEStatusItemElementBase;\r\n\r\ninterface EStatusItemConstructor {\r\n    prototype: HTMLEStatusItemElement;\r\n    new(init: {\r\n        name: string;\r\n        label: string;\r\n        onclick?: () => void;\r\n    }): HTMLEStatusItemElement;\r\n}\r\n\r\nvar EStatusItem = <EStatusItemConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        name: string;\r\n        label: string;\r\n        onclick?: () => void;\r\n    }) {\r\n        const {label, name, onclick} = init;\r\n        return element(\"e-statusitem\", {\r\n            attributes: {\r\n                title: label,\r\n                name: name,\r\n            },\r\n            children: label,\r\n            listeners: {\r\n                click: onclick\r\n            }\r\n        });\r\n    }, {\r\n        prototype: HTMLEStatusItemElement.prototype\r\n    }\r\n);","\r\nimport { element, CustomElement, AttributeProperty } from \"../../Element\";\r\n\r\nexport { HTMLEStatusItemGroupElement };\r\n\r\ninterface HTMLEStatusItemGroupElementConstructor {\r\n    prototype: HTMLEStatusItemGroupElement;\r\n    new(): HTMLEStatusItemGroupElement;\r\n}\r\n\r\ninterface HTMLEStatusItemGroupElement extends HTMLElement {\r\n    name: string;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-statusitemgroup\": HTMLEStatusItemGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-statusitemgroup\"\r\n})\r\nclass HTMLEStatusItemGroupElementBase extends HTMLElement implements HTMLEStatusItemGroupElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                width: max-content;\r\n                flex-direction: row;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"label\": {\r\n                const label = this.shadowRoot.querySelector<HTMLLabelElement>(\"[part='label']\");\r\n                if (label) {\r\n                    label.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEStatusItemGroupElement: HTMLEStatusItemGroupElementConstructor = HTMLEStatusItemGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLETabPanelElement } from \"./TabPanel\";\r\n\r\nexport { HTMLETabElement };\r\n\r\ninterface HTMLETabElementConstructor {\r\n    prototype: HTMLETabElement;\r\n    new(): HTMLETabElement;\r\n}\r\n\r\ninterface HTMLETabElement extends HTMLElement {\r\n    get panel(): HTMLETabPanelElement | null;\r\n    name: string;\r\n    active: boolean;\r\n    disabled: boolean;\r\n    controls: string;\r\n    selected: boolean;\r\n    select(): void;\r\n    connectedCallback(): void;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-tab\": HTMLETabElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-tab\"\r\n})\r\nclass HTMLETabElementBase extends HTMLElement implements HTMLETabElement {\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    disabled!: boolean;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    controls!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    selected!: boolean;\r\n    \r\n    get panel(): HTMLETabPanelElement | null {\r\n        const {controls} = this;\r\n        return (<Document | ShadowRoot>this.getRootNode()).querySelector<HTMLETabPanelElement>(`e-tabpanel[id='${controls}']`);\r\n    }\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: inline-block;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                padding: 4px;\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host(:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host(:focus-visible):host-context(e-tablist:focus-within) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"selected\": {\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    select(): void {\r\n        this.selected = true;\r\n    }\r\n}\r\n\r\nvar HTMLETabElement: HTMLETabElementConstructor = HTMLETabElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLETabElement } from \"./Tab\";\r\n\r\nexport { HTMLETabListElement };\r\n\r\ninterface HTMLETabListElementConstructor {\r\n    prototype: HTMLETabListElement;\r\n    new(): HTMLETabListElement;\r\n}\r\n\r\ninterface HTMLETabListElement extends HTMLElement {\r\n    get activeTab(): HTMLETabElement | null;\r\n    get selectedTab(): HTMLETabElement | null;\r\n    get tabs(): HTMLETabElement[];\r\n    firstItem(): HTMLETabElement | null;\r\n    connectedCallback(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-tablist\": HTMLETabListElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\nvar SELECT_ANIMATION_DURATION = 300;\r\n\r\n@CustomElement({\r\n    name: \"e-tablist\"\r\n})\r\nclass HTMLETabListElementBase extends HTMLElement implements HTMLETabListElement {\r\n\r\n    #walker: TreeWalker;\r\n    \r\n    get tabs(): HTMLETabElement[] {\r\n        return Array.from(\r\n            this.querySelectorAll(\"e-tab\")\r\n        );\r\n    }\r\n\r\n    get activeTab(): HTMLETabElement | null {\r\n        return this.querySelector(\r\n            \"e-tab[active]\"\r\n        );\r\n    }\r\n\r\n    get selectedTab(): HTMLETabElement | null {\r\n        return this.querySelector(\r\n            \"e-tab[selected]\"\r\n        );\r\n    }\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n            }\r\n\r\n            :host::after {\r\n                position: absolute;\r\n                display: inline-block;\r\n                content: \" \";\r\n                transform: translateY(-100%);\r\n                box-sizing: border-box;\r\n                border-top: 2px solid var(--focused-item-outline-color);\r\n            }\r\n\r\n            ::slotted(e-tab) {\r\n                transform: translateY(1px);\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex, selectedTab} = this;\r\n        this.tabIndex = tabIndex;\r\n        customElements.upgrade(this);\r\n        const tabToSelect = selectedTab ?? this.firstItem();\r\n        if (tabToSelect) {\r\n            this.#selectTab(tabToSelect);\r\n            setTimeout(() => {\r\n                let {width: tabWidth, left: tabLeft, bottom: tabBottom} = tabToSelect.getBoundingClientRect();\r\n                const offsetParent = <HTMLElement>(tabToSelect.offsetParent ?? document.body);\r\n                const {offsetLeft, offsetTop} = offsetParent;\r\n                tabLeft -= offsetLeft;\r\n                tabBottom -= offsetTop;\r\n                this.animate([{\r\n                    width: `${tabWidth}px`,\r\n                    left: `${tabLeft}px`,\r\n                    top: `${tabBottom}px`\r\n                }], {\r\n                    duration: 0,\r\n                    fill: \"forwards\",\r\n                    easing: \"ease-in-out\",\r\n                    pseudoElement: \"::after\"\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLETabElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    firstItem(): HTMLETabElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLETabElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLETabElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLETabElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLETabElement): HTMLETabElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLETabElement | null>walker.previousNode();\r\n    }\r\n\r\n    #nextItem(item: HTMLETabElement): HTMLETabElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLETabElement | null>walker.nextNode();\r\n    }\r\n\r\n    #setActiveTab(item: HTMLETabElement | null): void {\r\n        const {activeTab} = this;\r\n        if (activeTab !== null && activeTab !== item) {\r\n            activeTab.active = false;\r\n        }\r\n        if (item !== null) {\r\n            item.active = true;\r\n        }\r\n    }\r\n\r\n    #selectTab(tab: HTMLETabElement) {\r\n        const {selectedTab} = this;\r\n        if (tab !== selectedTab) {\r\n            tab.selected = true;\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetTab = (<Element>target).closest(\"e-tab\");\r\n        if (targetTab) {\r\n            targetTab.select();\r\n            const {width: tabWidth, left: tabLeft, bottom: tabBottom} = targetTab.getBoundingClientRect();\r\n            const {left: dialogLeft, top: dialogTop} = this.closest(\"dialog\")?.getBoundingClientRect() ?? {left: 0, top: 0};\r\n            this.animate([{\r\n                width: `${tabWidth}px`,\r\n                left: `${tabLeft - dialogLeft}px`,\r\n                top: `${tabBottom - dialogTop}px`\r\n            }], {\r\n                duration: SELECT_ANIMATION_DURATION,\r\n                fill: \"forwards\",\r\n                easing: \"ease-in-out\",\r\n                pseudoElement: \"::after\"\r\n            });\r\n        }\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {selectedTab} = this;\r\n        if (!this.contains(<Node>relatedTarget)) {\r\n            (selectedTab ?? this.firstItem())?.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetTab = <HTMLETabElement | null>(<HTMLElement>target).closest(\"e-tab\");\r\n        if (targetTab) {\r\n            this.#setActiveTab(targetTab);\r\n            this.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {activeTab} = this;\r\n        switch (key) {\r\n            case \"ArrowLeft\": {\r\n                const previousTab = activeTab ?\r\n                    this.#previousItem(activeTab) ?? this.#lastItem() :\r\n                    this.firstItem();\r\n                previousTab?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                const nextTab = activeTab ?\r\n                    this.#nextItem(activeTab) ?? this.firstItem() :\r\n                    this.#lastItem();\r\n                nextTab?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.firstItem();\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                activeTab?.click();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(event: Event) {\r\n        const {target} = event;\r\n        const targetTab = <HTMLETabElement>target;\r\n        if (targetTab.selected) {\r\n            const {tabs} = this;\r\n            tabs.forEach((tab_i) => {\r\n                if (tab_i !== targetTab) {\r\n                    tab_i.selected = false;\r\n                    const {panel} = tab_i;\r\n                    if (panel) {\r\n                        panel.hidden = true;\r\n                    }\r\n                }\r\n            });\r\n            const {panel} = targetTab;\r\n            if (panel) {\r\n                panel.hidden = false;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLETabListElement: HTMLETabListElementConstructor = HTMLETabListElementBase;","import { CustomElement, element } from \"../../Element\";\r\nimport { HTMLETabElement } from \"./Tab\";\r\n\r\nexport { HTMLETabPanelElement };\r\n\r\ninterface HTMLETabPanelElementConstructor {\r\n    prototype: HTMLETabPanelElement;\r\n    new(): HTMLETabPanelElement;\r\n}\r\n\r\ninterface HTMLETabPanelElement extends HTMLElement {\r\n    get tab(): HTMLETabElement | null;\r\n    connectedCallback(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-tabpanel\": HTMLETabPanelElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-tabpanel\"\r\n})\r\nclass HTMLETabPanelElementBase extends HTMLElement implements HTMLETabPanelElement {\r\n\r\n    get tab(): HTMLETabElement | null {\r\n        const {id} = this;\r\n        return (<Document | ShadowRoot>this.getRootNode()).querySelector<HTMLETabElement>(`e-tab[controls=${id}]`);\r\n    }\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                padding: 4px;\r\n            }\r\n            \r\n            :host([hidden]) {\r\n                display: none;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tab} = this;\r\n        if (tab) {\r\n            customElements.upgrade(tab);\r\n            const {selected} = tab;\r\n            this.hidden = !selected;\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLETabPanelElement: HTMLETabPanelElementConstructor = HTMLETabPanelElementBase;\r\n","import { HTMLESelectElement } from \"../../controls/forms/Select\";\r\nimport { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEToolBarItemElement } from \"./ToolBarItem\";\r\nimport { HTMLEToolBarItemGroupElement } from \"./ToolBarItemGroup\";\r\n\r\nexport { HTMLEToolBarElement };\r\n\r\ntype ToolBarOrientation = \"horizontal\" | \"vertical\";\r\n\r\ninterface HTMLEToolBarElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly activeItem: HTMLEToolBarItemElement | null;\r\n    items(): HTMLEToolBarItemElement[];\r\n    firstItem(): HTMLEToolBarItemElement | null;\r\n    name: string;\r\n    orientation: ToolBarOrientation;\r\n}\r\n\r\ninterface HTMLEToolbarElementConstructor {\r\n    prototype: HTMLEToolBarElement;\r\n    new(): HTMLEToolBarElement;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-toolbar\": HTMLEToolBarElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\nvar wasExpandedOnMouseDown: WeakMap<HTMLEToolBarItemElement, boolean>;\r\n\r\n@CustomElement({\r\n    name: \"e-toolbar\"\r\n})\r\nclass HTMLEToolBarElementBase extends HTMLElement implements HTMLEToolBarElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get activeItem(): HTMLEToolBarItemElement | null {\r\n        return this.querySelector<HTMLEToolBarItemElement>(\r\n            \"e-toolbaritem[active]\"\r\n        );\r\n    }\r\n\r\n    items(): HTMLEToolBarItemElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEToolBarItemElement>(\r\n            \":is(:scope, :scope > e-toolbaritemgroup) > e-toolbaritem\"\r\n        ));\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    orientation!: ToolBarOrientation;\r\n\r\n    #walker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        wasExpandedOnMouseDown = new WeakMap();\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                flex-direction: row;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#nodeFilter.bind(this)\r\n        );\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        this.addEventListener(\"dblclick\", this.#handleDblClickEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    #nodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEToolBarItemElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLEToolBarItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    firstItem(): HTMLEToolBarItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEToolBarItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLEToolBarItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEToolBarItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLEToolBarItemElement): HTMLEToolBarItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousItem = <HTMLEToolBarItemElement | null>walker.previousSibling();\r\n        return previousItem;\r\n    }\r\n\r\n    #nextItem(item: HTMLEToolBarItemElement): HTMLEToolBarItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLEToolBarItemElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #setActiveItem(item: HTMLEToolBarItemElement | null): void {\r\n        const {activeItem} = this;\r\n        if (activeItem !== null && activeItem !== item) {\r\n            activeItem.active = false;\r\n        }\r\n        if (item !== null) {\r\n            item.active = true;\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetItem = (<HTMLElement>target).closest(\"e-toolbaritem\");\r\n        if (targetItem) {\r\n            const {type, pressed} = targetItem;\r\n            switch (type) {\r\n                case \"checkbox\": {\r\n                    targetItem.pressed = !pressed;\r\n                    break;\r\n                }\r\n                case \"radio\": {\r\n                    targetItem.pressed = true;\r\n                    break;\r\n                }\r\n                case \"menubutton\": {\r\n                    const {menubutton} = targetItem;\r\n                    if (menubutton && !menubutton.contains(<Node>target)) {\r\n                        const force = !wasExpandedOnMouseDown.get(targetItem) ?? true;\r\n                        menubutton.toggle(force);\r\n                        if (force) {\r\n                            menubutton.firstItem?.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n                case \"select\": {\r\n                    const {select} = targetItem;\r\n                    if (select && !select.contains(<Node>target)) {\r\n                        const force = !wasExpandedOnMouseDown.get(targetItem) ?? true;\r\n                        select.toggle(force);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleDblClickEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {activeItem} = this;\r\n        if (!this.contains(<Node>relatedTarget)) {\r\n            (activeItem ?? this.firstItem())?.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLEToolBarItemElement | null>(<HTMLElement>target).closest(\"e-toolbaritem\");\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetItem);\r\n            this.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetItem = (<HTMLElement>target).closest(\"e-toolbaritem\");\r\n        if (targetItem) {\r\n            const {type} = targetItem;\r\n            switch (type) {\r\n                case \"menubutton\": {\r\n                    const {menubutton} = targetItem;\r\n                    if (menubutton && !menubutton.contains(<Node>target)) {\r\n                        wasExpandedOnMouseDown.set(targetItem, menubutton.expanded);\r\n                    }\r\n                    break;\r\n                }\r\n                case \"select\": {\r\n                    const {select} = targetItem;\r\n                    if (select && !select.contains(<Node>target)) {\r\n                        wasExpandedOnMouseDown.set(targetItem, select.expanded);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {activeItem} = this;\r\n        switch (key) {\r\n            case \"Enter\": {\r\n                if (activeItem) {\r\n                    const {type} = activeItem;\r\n                    switch (type) {\r\n                        case \"menubutton\": {\r\n                            const {menubutton} = activeItem;\r\n                            if (menubutton) {\r\n                                menubutton.expand();\r\n                                menubutton.firstItem?.focus({preventScroll: true});\r\n                            }\r\n                            break;\r\n                        }\r\n                        case \"select\": {\r\n                            const {select} = activeItem;\r\n                            if (select) {\r\n                                select.expand();\r\n                            }\r\n                            break;\r\n                        }\r\n                        default: {\r\n                            activeItem.click();\r\n                            break;\r\n                        }\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.firstItem();\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem();\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (activeItem) {\r\n                    const {type} = activeItem;\r\n                    switch (type) {\r\n                        case \"select\": {\r\n                            activeItem.select?.expand();\r\n                            event.stopPropagation();\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.firstItem();\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEToolBarElement: HTMLEToolbarElementConstructor = HTMLEToolBarElementBase;","import { HTMLESelectElement } from \"../../controls/forms/Select\";\r\nimport { CustomElement, AttributeProperty, element, QueryProperty } from \"../../Element\";\r\nimport { HTMLEMenuButtonElement } from \"../menus/MenuButton\";\r\n\r\nexport { HTMLEToolBarItemElement };\r\nexport { EToolBarItem };\r\n\r\ninterface HTMLEToolBarItemElementConstructor {\r\n    prototype: HTMLEToolBarItemElement;\r\n    new(): HTMLEToolBarItemElement;\r\n}\r\n\r\ninterface HTMLEToolBarItemElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly menubutton: HTMLEMenuButtonElement | null;\r\n    readonly select: HTMLESelectElement | null;\r\n    value: string;\r\n    name: string;\r\n    label: string;\r\n    active: boolean;\r\n    pressed: boolean;\r\n    iconed: boolean;\r\n    type: \"button\" | \"checkbox\" | \"radio\" | \"menubutton\" | \"select\";\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-toolbaritem\": HTMLEToolBarItemElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\nvar iconPart: HTMLElement;\r\n\r\n@CustomElement({\r\n    name: \"e-toolbaritem\"\r\n})\r\nclass HTMLEToolBarItemElementBase extends HTMLElement implements HTMLEToolBarItemElement {\r\n    \r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    @QueryProperty({selector: \":scope > e-menubutton[slot=menubutton]\"})\r\n    readonly menubutton!: HTMLEMenuButtonElement | null;\r\n    \r\n    @QueryProperty({selector: \":scope > e-select[slot=select]\"})\r\n    readonly select!: HTMLESelectElement | null;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    pressed!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    expanded!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    iconed!: boolean;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    value!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    type!: \"button\" | \"checkbox\" | \"radio\" | \"menubutton\" | \"select\";\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\"),\r\n            element(\"slot\", {\r\n                attributes: {\r\n                    name: \"select\"\r\n                }\r\n            }),\r\n            element(\"slot\", {\r\n                attributes: {\r\n                    name: \"menubutton\"\r\n                }\r\n            })\r\n        );\r\n        iconPart = element(\"span\", {\r\n            attributes: {\r\n                part: \"icon\"\r\n            }\r\n        });\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                cursor: pointer;\r\n                line-height: 22px;\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host(:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([pressed]) {\r\n                background-color: var(--activated-item-color);\r\n            }\r\n            \r\n            :host(:not([iconed])) [part=\"icon\"] {\r\n                display: none;\r\n            }\r\n\r\n            [part=\"icon\"] {\r\n                flex: none;\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                padding: 2px;\r\n                overflow: hidden;\r\n            }\r\n            \r\n            [part=\"icon\"]::before {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                content: \"\";\r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--icon-color, none);\r\n                -webkit-mask-image: var(--icon-image, none);\r\n                mask-image: var(--icon-image, none);\r\n                filter: var(--icon-filter, none);\r\n            }\r\n            \r\n            :host(:focus-within):host-context(e-toolbar:focus-within) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            /*:host([type=\"menubutton\"]) ::slotted(e-menubutton):focus,\r\n            :host([type=\"select\"]) ::slotted(e-select):focus {\r\n                outline: none;\r\n                outline-offset: none;\r\n            }*/\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"label\": {\r\n                //...\r\n                break;\r\n            }\r\n            case \"iconed\": {\r\n                const {shadowRoot} = this;\r\n                if (newValue !== null) {\r\n                    shadowRoot.prepend(iconPart.cloneNode(true));\r\n                }\r\n                else {\r\n                    const iconPart = shadowRoot.querySelector<HTMLElement>(\"[part=icon]\");\r\n                    if (iconPart) {\r\n                        iconPart.remove();\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEToolBarItemElement: HTMLEToolBarItemElementConstructor = HTMLEToolBarItemElementBase;\r\n\r\ninterface EToolBarItemConstructor {\r\n    prototype: HTMLEToolBarItemElement;\r\n    new(init: {\r\n        name: string;\r\n        label: string;\r\n        type: \"button\" | \"checkbox\" | \"radio\" | \"menubutton\" | \"select\";\r\n        value?: string;\r\n        trigger?: () => void;\r\n        menubutton?: HTMLEMenuButtonElement;\r\n        select?: HTMLESelectElement;\r\n    }): HTMLEToolBarItemElement;\r\n    button(init: {\r\n        name: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEToolBarItemElement;\r\n    checkbox(init: {\r\n        name: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEToolBarItemElement;\r\n    radio(init: {\r\n        name: string;\r\n        label: string;\r\n        value?: string;\r\n        trigger?: () => void;\r\n    }): HTMLEToolBarItemElement;\r\n    menubutton(init: {\r\n        name: string;\r\n        label: string;\r\n        menubutton: HTMLEMenuButtonElement;\r\n    }): HTMLEToolBarItemElement;\r\n    select(init: {\r\n        name: string;\r\n        label: string;\r\n        select: HTMLESelectElement;\r\n    }): HTMLEToolBarItemElement;\r\n}\r\n\r\nvar EToolBarItem = <EToolBarItemConstructor>Object.assign(\r\n    <Function>function(init: {\r\n        name: string;\r\n        label: string;\r\n        type: \"button\" | \"checkbox\" | \"radio\" | \"menubutton\" | \"select\";\r\n        value?: string;\r\n        trigger?: () => void;\r\n        menubutton?: HTMLEMenuButtonElement;\r\n        select?: HTMLESelectElement;\r\n    }) {\r\n        const {label, name, type, value, trigger, menubutton, select} = init;\r\n        if (menubutton) {\r\n            menubutton.slot = \"menubutton\";\r\n        }\r\n        if (select) {\r\n            select.slot = \"select\";\r\n        }\r\n        return element(\"e-toolbaritem\", {\r\n            attributes: {\r\n                tabindex: -1,\r\n                title: label,\r\n                name: name,\r\n                value: value,\r\n                type: type\r\n            },\r\n            children: menubutton ? [menubutton] : select ? [select] : undefined,\r\n            listeners: {\r\n                click: trigger\r\n            }\r\n        });\r\n    }, {\r\n        prototype: HTMLEToolBarItemElement.prototype,\r\n        button(init: {\r\n            name: string,\r\n            label: string,\r\n            value?: string,\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EToolBarItem({\r\n                ...init, type: \"button\"\r\n            });\r\n        },\r\n        checkbox(init: {\r\n            name: string;\r\n            label: string;\r\n            value?: string;\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EToolBarItem({\r\n                ...init, type: \"checkbox\"\r\n            });\r\n        },\r\n        radio(init: {\r\n            name: string;\r\n            label: string;\r\n            value?: string;\r\n            trigger?: () => void;\r\n        }) {\r\n            return new EToolBarItem({\r\n                ...init, type: \"radio\"\r\n            });\r\n        },\r\n        menubutton(init: {\r\n            name: string;\r\n            label: string;\r\n            menubutton: HTMLEMenuButtonElement;\r\n        }) {\r\n            return new EToolBarItem({\r\n                ...init, type: \"menubutton\"\r\n            });\r\n        },\r\n        select(init: {\r\n            name: string;\r\n            label: string;\r\n            select: HTMLESelectElement;\r\n        }) {\r\n            return new EToolBarItem({\r\n                ...init, type: \"select\"\r\n            });\r\n        },\r\n    }\r\n);","\r\nimport { element, CustomElement, AttributeProperty } from \"../../Element\";\r\n\r\nexport { HTMLEToolBarItemGroupElement };\r\n\r\ninterface HTMLEToolBarItemGroupElementConstructor {\r\n    prototype: HTMLEToolBarItemGroupElement;\r\n    new(): HTMLEToolBarItemGroupElement;\r\n}\r\n\r\ninterface HTMLEToolBarItemGroupElement extends HTMLElement {\r\n    name: string;\r\n    label: string;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-toolbaritemgroup\": HTMLEToolBarItemGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-toolbaritemgroup\"\r\n})\r\nclass HTMLEToolBarItemGroupElementBase extends HTMLElement implements HTMLEToolBarItemGroupElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                width: max-content;\r\n                flex-direction: row;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"label\": {\r\n                const label = this.shadowRoot.querySelector<HTMLLabelElement>(\"[part='label']\");\r\n                if (label) {\r\n                    label.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEToolBarItemGroupElement: HTMLEToolBarItemGroupElementConstructor = HTMLEToolBarItemGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLETreeItemElement } from \"./TreeItem\";\r\nimport { HTMLETreeItemGroupElement } from \"./TreeItemGroup\";\r\n\r\nexport { HTMLETreeElement };\r\n\r\ninterface HTMLETreeElementConstructor {\r\n    prototype: HTMLETreeElement;\r\n    new(): HTMLETreeElement;\r\n}\r\n\r\ninterface HTMLETreeElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly items: HTMLCollectionOf<HTMLETreeItemElement>;\r\n    readonly activeItem: HTMLETreeItemElement | null;\r\n    readonly dropTargetItem: HTMLETreeItemElement | null;\r\n    firstItem(): HTMLETreeItemElement | null;\r\n    droptarget: boolean;\r\n    name: string;\r\n    selectedItems(): HTMLETreeItemElement[];\r\n    beginSelection(): void;\r\n    endSelection(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-tree\": HTMLETreeElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-tree\"\r\n})\r\nclass HTMLETreeElementBase extends HTMLElement implements HTMLETreeElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly items: HTMLCollectionOf<HTMLETreeItemElement>;\r\n\r\n    get activeItem(): HTMLETreeItemElement | null {\r\n        return this.querySelector<HTMLETreeItemElement>(\r\n            \"e-treeitem[active]\"\r\n        );\r\n    }\r\n\r\n    get dropTargetItem(): HTMLETreeItemElement | null {\r\n        return this.querySelector<HTMLETreeItemElement>(\r\n            \"e-treeitem[droptarget]\"\r\n        );\r\n    }\r\n    \r\n    @AttributeProperty({type: Boolean})\r\n    droptarget!: boolean;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    #onSelection: boolean;\r\n    #hasSelectionChanged: boolean;\r\n    #walker: TreeWalker;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n            \r\n            :host(:focus) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#nodeFilter.bind(this)\r\n        );\r\n        this.#onSelection = false;\r\n        this.#hasSelectionChanged = false;\r\n        this.items = this.getElementsByTagName(\"e-treeitem\");\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        this.addEventListener(\"dblclick\", this.#handleDblClickEvent.bind(this));\r\n        this.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        this.addEventListener(\"dragend\", this.#handleDragEndEvent.bind(this));\r\n        this.addEventListener(\"dragenter\", this.#handleDragEnterEvent.bind(this));\r\n        this.addEventListener(\"dragleave\", this.#handleDragLeaveEvent.bind(this));\r\n        this.addEventListener(\"dragover\", this.#handleDragOverEvent.bind(this));\r\n        this.addEventListener(\"drop\", this.#handleDropEvent.bind(this));\r\n        this.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        this.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n\r\n    selectedItems(): HTMLETreeItemElement[] {\r\n        const selectedItems = [];\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        let item = this.firstItem();\r\n        while (item !== null) {\r\n            if (item.selected) {\r\n                selectedItems.push(item);\r\n            }\r\n            item = this.#nextItem(item);\r\n        }\r\n        return selectedItems;\r\n    }\r\n\r\n    beginSelection(): void {\r\n        this.#onSelection = true;\r\n    }\r\n\r\n    endSelection(): void {\r\n        this.#onSelection = false;\r\n        if (this.#hasSelectionChanged) {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged = false;\r\n        }\r\n    }\r\n\r\n    #nodeFilter(node: Node): number {\r\n        if (node instanceof HTMLETreeItemElement) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        if (node instanceof HTMLETreeItemGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getItemsRange(from: HTMLETreeItemElement, to: HTMLETreeItemElement): HTMLETreeItemElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextVisibleItem = this.#nextItem(from);\r\n            while (nextVisibleItem && nextVisibleItem !== to) {\r\n                range.push(nextVisibleItem);\r\n                nextVisibleItem = this.#nextItem(nextVisibleItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousVisibleItem = this.#previousItem(from);\r\n            while (previousVisibleItem && previousVisibleItem !== to) {\r\n                range.push(previousVisibleItem);\r\n                previousVisibleItem = this.#previousItem(previousVisibleItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setSelection(...items: HTMLETreeItemElement[]): void {\r\n        const selectedItems = this.selectedItems();\r\n        this.beginSelection();\r\n        selectedItems.forEach((selectedItem_i) => {\r\n            if (!items.includes(selectedItem_i)) {\r\n                selectedItem_i.selected = false;\r\n            }\r\n        });\r\n        items.forEach((item_i) => {\r\n            if (this.contains(item_i) && !item_i.selected) {\r\n                item_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #addToSelection(...items: HTMLETreeItemElement[]): void {\r\n        this.beginSelection();\r\n        items.forEach((item_i) => {\r\n            if (!item_i.selected) {\r\n                item_i.selected = true;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #removeFromSelection(...items: HTMLETreeItemElement[]): void {\r\n        const selectedItems = this.selectedItems();\r\n        this.beginSelection();\r\n        items.forEach((item_i) => {\r\n            if (selectedItems.includes(item_i)) {\r\n                item_i.selected = false;\r\n            }\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #clearSelection(): void {\r\n        const selectedItems = this.selectedItems();\r\n        this.beginSelection();\r\n        selectedItems.forEach((item_i) => {\r\n            item_i.selected = false;\r\n        });\r\n        this.endSelection();\r\n    }\r\n\r\n    #setActiveItem(item: HTMLETreeItemElement | null): void {\r\n        const {activeItem} = this;\r\n        if (activeItem !== null && activeItem !== item) {\r\n            activeItem.active = false;\r\n            activeItem.tabIndex = -1;\r\n        }\r\n        if (item !== null) {\r\n            const walker = this.#walker;\r\n            walker.currentNode = item;\r\n            item.active = true;\r\n            item.tabIndex = 0;\r\n        }\r\n    }\r\n    \r\n    #setDropTargetItem(item: HTMLETreeItemElement | null): void {\r\n        const {dropTargetItem} = this;\r\n        if (dropTargetItem !== null && dropTargetItem !== item) {\r\n            dropTargetItem.droptarget = false;\r\n        }\r\n        if (item !== null) {\r\n            this.droptarget = true;\r\n            item.droptarget = true;\r\n        }\r\n        else {\r\n            this.droptarget = false;\r\n        }\r\n    }\r\n\r\n    firstItem(): HTMLETreeItemElement | null {\r\n        const walker = this.#walker;\r\n        const {root} = walker;\r\n        walker.currentNode = root;\r\n        return <HTMLETreeItemElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(): HTMLETreeItemElement | null {\r\n        const walker = this.#walker;\r\n        const {root} = walker;\r\n        walker.currentNode = root;\r\n        return <HTMLETreeItemElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLETreeItemElement): HTMLETreeItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousSibling = <HTMLETreeItemElement | null>walker.previousSibling();\r\n        return previousSibling ?\r\n            this.#deepestItem(previousSibling) :\r\n            <HTMLETreeItemElement | null>walker.parentNode();\r\n    }\r\n\r\n    #nextItem(item: HTMLETreeItemElement): HTMLETreeItemElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const {type, expanded} = item;\r\n        return <HTMLETreeItemElement | null>(\r\n            type === \"leaf\" ?\r\n                walker.nextNode() :\r\n                expanded ?\r\n                    walker.nextNode() :\r\n                    walker.nextSibling() ??\r\n                    (walker.parentNode(), walker.nextSibling())\r\n        );\r\n    }\r\n\r\n    #deepestItem(item: HTMLETreeItemElement): HTMLETreeItemElement {\r\n        if (item.expanded) {\r\n            const walker = this.#walker;\r\n            const lastItem = <HTMLETreeItemElement>walker.lastChild();\r\n            if (lastItem) {\r\n                return this.#deepestItem(lastItem);\r\n            }\r\n        }\r\n        return item;\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, shiftKey, ctrlKey} = event;\r\n        const targetItem = <HTMLETreeItemElement | null>(<HTMLElement>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            if (!shiftKey && !ctrlKey) {\r\n                this.#setSelection(targetItem);\r\n                const {type} = targetItem;\r\n                if (type == \"parent\") {\r\n                    targetItem.toggle();\r\n                }\r\n            }\r\n        }\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleDblClickEvent(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    #handleDragEndEvent(): void {\r\n        this.#setDropTargetItem(null);\r\n    }\r\n\r\n    #handleDragEnterEvent(event: DragEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLETreeItemElement | null>(<HTMLElement>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            const {type} = targetItem;\r\n            if (type == \"parent\") {\r\n                targetItem.toggle(true);\r\n            }\r\n            this.#setDropTargetItem(targetItem);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragOverEvent(event: DragEvent): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragLeaveEvent(event: DragEvent): void {\r\n        const {relatedTarget} = event;\r\n        let rootNode = <Node>relatedTarget;\r\n        while (!(rootNode instanceof HTMLETreeItemElement || rootNode instanceof Document)) {\r\n            rootNode = rootNode.getRootNode();\r\n            if (rootNode instanceof ShadowRoot) {\r\n                rootNode = rootNode.host;\r\n            }\r\n        }\r\n        if (rootNode instanceof Document) {\r\n            this.#setDropTargetItem(null);\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(): void {\r\n        this.#setDropTargetItem(null);\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {activeItem} = this;\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey) {\r\n                    if (activeItem) {\r\n                        const walker = this.#walker;\r\n                        walker.currentNode = activeItem;\r\n                        const firstItem = <HTMLETreeItemElement>(\r\n                            walker.currentNode = walker.parentNode() ?? this, walker.firstChild()\r\n                        );\r\n                        const lastItem = <HTMLETreeItemElement>(\r\n                            walker.currentNode = walker.parentNode() ?? this, walker.lastChild()\r\n                        );\r\n                        if (firstItem && lastItem) {\r\n                            const range = this.#getItemsRange(\r\n                                firstItem,\r\n                                this.#deepestItem(lastItem)\r\n                            );\r\n                            if (range) {\r\n                                this.#setSelection(...range);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    if (activeItem.expanded) {\r\n                        activeItem.toggle();\r\n                    }\r\n                    else {\r\n                        const walker = this.#walker;\r\n                        const parentItem = <HTMLETreeItemElement>walker.parentNode();\r\n                        if (parentItem) {\r\n                            parentItem.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    if (!activeItem.expanded) {\r\n                        activeItem.toggle();\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            previousItem.selected ?\r\n                                this.#removeFromSelection(previousItem) :\r\n                                this.#addToSelection(previousItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.firstItem();\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            nextItem.selected ?\r\n                                this.#removeFromSelection(nextItem) :\r\n                                this.#addToSelection(nextItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem();\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.firstItem();\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem();\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                if (activeItem) {\r\n                    this.#setSelection(activeItem);\r\n                    activeItem.click();\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                this.#clearSelection();\r\n                this.#setActiveItem(null);\r\n                this.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const {activeItem} = this;\r\n        if (!this.contains(<Node | null>relatedTarget)) {\r\n            (activeItem ?? this.firstItem())?.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLETreeItemElement | null>(<HTMLElement>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetItem);\r\n            this.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node | null>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {target, ctrlKey, shiftKey, button} = event;\r\n        if (target instanceof HTMLETreeItemElement) {\r\n            const {selected} = target;\r\n            switch (button) {\r\n                case 0: {\r\n                    if (!shiftKey && !ctrlKey && !selected) {\r\n                        this.#setSelection(target);\r\n                    }\r\n                    else if (ctrlKey) {\r\n                        if (selected) {\r\n                            target.blur();\r\n                        }\r\n                        (!selected) ?\r\n                            this.#addToSelection(target) :\r\n                            this.#removeFromSelection(target);\r\n                        event.stopPropagation();\r\n                    }\r\n                    else if (shiftKey) {\r\n                        const {activeItem} = this\r\n                        if (activeItem) {\r\n                            const range = this.#getItemsRange(\r\n                                activeItem,\r\n                                target\r\n                            );\r\n                            if (range) {\r\n                                this.#setSelection(...range);\r\n                            }\r\n                        }\r\n                        event.stopPropagation();\r\n                    }\r\n                }\r\n                break;\r\n                case 2: {\r\n                    if (!selected) {\r\n                        this.#setSelection(target);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(): void {\r\n        if (this.#onSelection) {\r\n            this.#hasSelectionChanged = true;\r\n        }\r\n        else {\r\n            this.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLETreeElement: HTMLETreeElementConstructor = HTMLETreeElementBase;","import { CustomElement, element, AttributeProperty, QueryProperty } from \"../../Element\";\r\nimport { HTMLETreeItemGroupElement } from \"./TreeItemGroup\";\r\n\r\nexport { HTMLETreeItemElement };\r\n\r\nimport * as icon from \"assets/add_a_photo_FILL0_wght400_GRAD0_opsz48.svg\";\r\n\r\nconsole.log(icon);\r\n\r\ninterface HTMLETreeItemElementConstructor {\r\n    prototype: HTMLETreeItemElement;\r\n    new(): HTMLETreeItemElement;\r\n}\r\n\r\ninterface HTMLETreeItemElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly group: HTMLETreeItemGroupElement | null;\r\n    name: string;\r\n    posinset: number;\r\n    label: string;\r\n    droptarget: boolean;\r\n    expanded: boolean;\r\n    selected: boolean;\r\n    active: boolean;\r\n    level: number;\r\n    type: \"leaf\" | \"parent\";\r\n    toggle(force?: boolean): void;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-treeitem\": HTMLETreeItemElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-treeitem\"\r\n})\r\nclass HTMLETreeItemElementBase extends HTMLElement implements HTMLETreeItemElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: Number})\r\n    posinset!: number;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    expanded!: boolean;\r\n    \r\n    @AttributeProperty({type: Boolean})\r\n    droptarget!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    active!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    selected!: boolean;\r\n\r\n    @AttributeProperty({type: Number, observed: true})\r\n    level!: number;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"leaf\"})\r\n    type!: \"leaf\" | \"parent\";\r\n\r\n    @QueryProperty({selector: \":scope > e-treeitemgroup[slot=group]\"})\r\n    group!: HTMLETreeItemGroupElement | null;\r\n    \r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"content\"\r\n                },\r\n                children: [\r\n                    element(\"span\", {\r\n                        attributes: {\r\n                            part: \"arrow\"\r\n                        }\r\n                    }),\r\n                    element(\"slot\")\r\n                ]\r\n            }),\r\n            element(\"slot\", {\r\n                attributes: {\r\n                    name: \"group\"\r\n                }\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                user-select: none;\r\n            }\r\n            \r\n            :host([droptarget]) {\r\n                background-color: var(--droptarget-item-color);\r\n            }\r\n            \r\n            :host([active]:focus-visible) {\r\n                outline: none;\r\n            }\r\n            \r\n            :host([active]:is(:focus, :not(:focus-within))):host-context(e-tree:focus-within) [part=\"content\"] {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            [part=\"content\"]:hover {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host([selected]) [part=\"content\"] {\r\n                background-color: var(--selected-item-color);\r\n            }\r\n            \r\n            [part=\"content\"] {\r\n                display: flex;\r\n                line-height: 22px;\r\n                padding-left: calc(var(--level) * var(--indent-width, 12px));\r\n            }\r\n            \r\n            :host(:not([type=\"parent\"])) ::slotted([slot=\"group\"]),\r\n            :host(:not([expanded])) ::slotted([slot=\"group\"]) {\r\n                display: none;\r\n            }\r\n            \r\n            :host(:not([type=\"parent\"])) [part=\"arrow\"]::before {\r\n                visibility: hidden;\r\n            }\r\n            \r\n            [part=\"arrow\"] {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px 4px 1px 1px;\r\n            }\r\n            \r\n            [part=\"arrow\"]::before {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px;\r\n                content: \"\";\r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--arrow-color, none);\r\n                filter: var(--arrow-filter, none);\r\n            }\r\n            \r\n            :host(:not([expanded])) [part=\"arrow\"]::before {\r\n                -webkit-mask-image: var(--arrow-icon-collapsed, none);\r\n                mask-image: var(--arrow-icon-collapsed, none);\r\n            }\r\n            \r\n            :host([expanded]) [part=\"arrow\"]::before {\r\n                -webkit-mask-image: var(--arrow-icon-expanded, none);\r\n                mask-image: var(--arrow-icon-expanded, none);\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"expanded\": {\r\n                this.dispatchEvent(new Event(\"toggle\", {bubbles: true}));\r\n                break;\r\n            }\r\n            case \"selected\": {\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n            case \"label\": {\r\n                const labelPart = this.shadowRoot.querySelector(\"[part=label]\");\r\n                if (labelPart) {\r\n                    labelPart.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n            case \"level\": {\r\n                this.style.setProperty(\"--level\", `${this.level}`);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    toggle(force?: boolean): void {\r\n        const {expanded} = this;\r\n        this.expanded = force ?? !expanded;\r\n    }\r\n}\r\n\r\nvar HTMLETreeItemElement: HTMLETreeItemElementConstructor = HTMLETreeItemElementBase;","import { CustomElement, element } from \"../../Element\";\r\n\r\nexport { HTMLETreeItemGroupElement };\r\n\r\ninterface HTMLETreeItemGroupElementConstructor {\r\n    prototype: HTMLETreeItemGroupElement;\r\n    new(): HTMLETreeItemGroupElement;\r\n}\r\n\r\ninterface HTMLETreeItemGroupElement extends HTMLElement {}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-treeitemgroup\": HTMLETreeItemGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-treeitemgroup\"\r\n})\r\nclass HTMLETreeItemGroupElementBase extends HTMLElement implements HTMLETreeItemGroupElement {\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n}\r\n\r\nvar HTMLETreeItemGroupElement: HTMLETreeItemGroupElementConstructor = HTMLETreeItemGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\n\r\nexport { HTMLEDialogElement };\r\n\r\ninterface HTMLEDialogElementConstructor {\r\n    prototype: HTMLEDialogElement;\r\n    new(): HTMLEDialogElement;\r\n}\r\n\r\ntype DialogElementType = \"confirm\" | \"alert\";\r\n\r\ninterface HTMLEDialogElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    name: string;\r\n    type: DialogElementType;\r\n    open(): void;\r\n    close(): void;\r\n    cancel(): void;\r\n    confirm(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-dialog\": HTMLEDialogElement,\r\n    }\r\n    \r\n    interface HTMLElementEventMap {\r\n        \"open\": Event,\r\n        \"close\": Event,\r\n        \"cancel\": Event,\r\n        \"confirm\": Event,\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"e-dialog\"\r\n})\r\nclass HTMLEDialogElementBase extends HTMLElement implements HTMLEDialogElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    type!: DialogElementType;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.attachShadow({mode: \"open\"}).append(\r\n            element(\"style\", {\r\n                children: [\r\n                    /*css*/`\r\n                        :host {\r\n                            display: inline-block;\r\n                            \r\n                            padding: 6px;\r\n                            background-color: white;\r\n        \r\n                            -webkit-box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n                            -moz-box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n                            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n                        }\r\n        \r\n                        button {\r\n                            cursor: pointer;\r\n                        }\r\n        \r\n                        [part=\"actions\"] {\r\n                            display: flex;\r\n                            flex-direction: row;\r\n                            justify-content: flex-end;\r\n                        }\r\n        \r\n                        [part=\"header\"] {\r\n                            display: flex;\r\n                            flex-direction: row;\r\n                            justify-content: flex-end;\r\n                        }\r\n        \r\n                        [part=\"button\"]:not(:first-child) {\r\n                            margin-left: 4px;\r\n                        }\r\n        \r\n                        :host([type=\"confirm\"]) [part=\"ok-button\"] {\r\n                            display: none !important;\r\n                        }\r\n        \r\n                        :host([type=\"alert\"]) [part=\"cancel-button\"],\r\n                        :host([type=\"alert\"]) [part=\"confirm-button\"] {\r\n                            display: none !important;\r\n                        }\r\n                    `\r\n                    ]\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"header\"\r\n                },\r\n                children: [\r\n                    element(\"button\", {\r\n                        attributes: {\r\n                            part: \"button close-button\",\r\n                            type: \"button\",\r\n                            tabindex: 0\r\n                        },\r\n                        children: [\r\n                            \"x\"\r\n                        ]\r\n                    })\r\n                ]\r\n            }),\r\n            element(\"hr\", {\r\n                attributes: {\r\n                    part: \"separator\"\r\n                }\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"body\"\r\n                },\r\n                children: [\r\n                    element(\"slot\")\r\n                ]\r\n            }),\r\n            element(\"hr\", {\r\n                attributes: {\r\n                    part: \"separator\"\r\n                }\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"actions\",\r\n                },\r\n                children: [\r\n                    element(\"button\", {\r\n                        attributes: {\r\n                            part: \"button cancel-button\",\r\n                            type: \"button\",\r\n                            tabindex: 0\r\n                        },\r\n                        children: [\r\n                            \"Cancel\"\r\n                        ]\r\n                    }),\r\n                    element(\"button\", {\r\n                        attributes: {\r\n                            part: \"button confirm-button\",\r\n                            type: \"button\",\r\n                            tabindex: 0\r\n                        },\r\n                        children: [\r\n                            \"Confirm\"\r\n                        ]\r\n                    }),\r\n                    element(\"button\", {\r\n                        attributes: {\r\n                            part: \"button ok-button\",\r\n                            type: \"button\",\r\n                            tabindex: 0\r\n                        },\r\n                        children: [\r\n                            \"OK\"\r\n                        ]\r\n                    })\r\n                ]\r\n            }),\r\n        );\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.shadowRoot.addEventListener(\"click\", this);\r\n    }\r\n\r\n    handleEvent(event: Event) {\r\n        const {type, target} = event;\r\n        switch (type) {\r\n            case \"click\":\r\n                const {part} = <Element>target;\r\n                if (part.contains(\"close-button\") || part.contains(\"cancel-button\")) {\r\n                    this.cancel();\r\n                }\r\n                else if (part.contains(\"confirm-button\") || part.contains(\"ok-button\")) {\r\n                    this.confirm();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    open(): void {\r\n        this.dispatchEvent(new CustomEvent(\"open\", {bubbles: true}));\r\n    }\r\n\r\n    close(): void {\r\n        this.dispatchEvent(new CustomEvent(\"close\", {bubbles: true}));\r\n    }\r\n\r\n    cancel(): void {\r\n        this.dispatchEvent(new CustomEvent(\"cancel\", {bubbles: true}));\r\n        this.close();\r\n    }\r\n\r\n    confirm(): void {\r\n        this.dispatchEvent(new CustomEvent(\"confirm\", {bubbles: true}));\r\n        this.close();\r\n    }\r\n}\r\n\r\nvar HTMLEDialogElement: HTMLEDialogElementConstructor = HTMLEDialogElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\n\r\nexport { HTMLEDraggableElement };\r\n\r\ninterface HTMLEDraggableElementConstructor {\r\n    prototype: HTMLEDraggableElement;\r\n    new(): HTMLEDraggableElement;\r\n}\r\n\r\ninterface HTMLEDraggableElement extends HTMLElement {\r\n    readonly referee: this | null;\r\n    readonly references: this[];\r\n    selected: boolean;\r\n    dragged: boolean;\r\n    dragovered: boolean;\r\n\r\n    connectedCallback(): void;\r\n    disconnectedCallback(): void;\r\n    getReference(): this;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-draggable\": HTMLEDraggableElement,\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"e-draggable\"\r\n})\r\nclass HTMLEDraggableElementBase extends HTMLElement implements HTMLEDraggableElement {\r\n    \r\n    @AttributeProperty({type: Boolean})\r\n    selected!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    dragovered!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    dragged!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    disabled!: boolean;\r\n\r\n    #referee: this | null;\r\n    readonly references: this[];\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.attachShadow({mode: \"open\"}).append(\r\n            element(\"style\", {\r\n                children: [\r\n                    /*css*/`\r\n                        :host {\r\n                            display: inline-block;\r\n                            padding: 3px 4px;\r\n                            cursor: pointer;\r\n                            white-space: nowrap;\r\n                            border-radius: 4px;\r\n                            border: 1px solid black;\r\n                            user-select: none;\r\n                        }\r\n        \r\n                        :host([disabled]) {\r\n                            pointer-events: none;\r\n                            color: lightgray;\r\n                            border-color: lightgray;\r\n                        }\r\n        \r\n                        :host([selected]:active) {\r\n                            cursor: grabbing;\r\n                        }\r\n                        \r\n                        :host([selected]) {\r\n                            cursor: grab;\r\n                            font-weight: bold;\r\n                            outline: 1px auto black;\r\n                        }\r\n        \r\n                        :host([dragovered]) {\r\n                            border-style: dotted;\r\n                        }\r\n                        \r\n                        [part=\"container\"] {\r\n                            display: flex;\r\n                            align-items: center;\r\n                        }\r\n                    `\r\n                ]\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"container\"\r\n                },\r\n                children: [\r\n                    element(\"slot\", {\r\n                        children: [\r\n                            \"&nbsp;\"\r\n                        ]\r\n                    })\r\n                ]\r\n            })\r\n        );\r\n\r\n        this.references = [];\r\n        this.#referee = null;\r\n    }\r\n\r\n    get referee(): this | null {\r\n        return this.#referee;\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        this.tabIndex = this.tabIndex;\r\n        this.draggable = true;\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        if (this.referee) {\r\n            const thisRefIndex = this.referee.references.indexOf(this);\r\n            if (thisRefIndex > -1) {\r\n                this.referee.references.splice(thisRefIndex, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    getReference(): this {\r\n        const reference = <this>this.cloneNode(true);\r\n        reference.#referee = this;\r\n        return reference;\r\n    }\r\n}\r\n\r\nvar HTMLEDraggableElement: HTMLEDraggableElementConstructor = HTMLEDraggableElementBase","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEDraggableElement } from \"./Draggable\";\r\n\r\nexport { HTMLEDragzoneElement };\r\n\r\ninterface HTMLEDragzoneElementConstructor {\r\n    prototype: HTMLEDragzoneElement;\r\n    new(): HTMLEDragzoneElement\r\n}\r\n\r\ninterface HTMLEDragzoneElement extends HTMLElement {\r\n    readonly draggables: HTMLEDraggableElement[];\r\n    readonly selectedDraggables: HTMLEDraggableElement[];\r\n    disabled: boolean;\r\n    selectDraggable(draggable: HTMLEDraggableElement): void;\r\n    unselectDraggable(draggable: HTMLEDraggableElement): void;\r\n    clearSelection(): void;\r\n    connectedCallback(): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-dragzone\": HTMLEDragzoneElement,\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"e-dragzone\"\r\n})\r\nclass HTMLEDragzoneElementBase extends HTMLElement implements HTMLEDragzoneElement {\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    disabled!: boolean;\r\n\r\n    #draggables: HTMLEDraggableElement[];\r\n    #selectedDraggables: HTMLEDraggableElement[];\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.attachShadow({mode: \"open\"}).append(\r\n            element(\"style\", {\r\n                children: [\r\n                    /*css*/`\r\n                        :host {\r\n                            display: block;\r\n                        }\r\n        \r\n                        :host([disabled]) {\r\n                            pointer-events: none;\r\n                        }\r\n        \r\n                        [part=\"container\"] {\r\n                            position: relative;\r\n                            display: flex;\r\n                            flex-direction: column;\r\n                            padding-left: 2px;\r\n                            padding-right: 2px;\r\n                        }\r\n        \r\n                        ::slotted(*) {\r\n                            margin-top: 2px;\r\n                            margin-bottom: 2px;\r\n                        }\r\n                    `\r\n                ]\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"container\"\r\n                },\r\n                children: [\r\n                    element(\"slot\")\r\n                ]\r\n            })\r\n        );\r\n        this.#draggables = [];\r\n        this.#selectedDraggables = [];\r\n    }\r\n\r\n    get draggables(): HTMLEDraggableElement[] {\r\n        return this.#draggables;\r\n    }\r\n\r\n    get selectedDraggables(): HTMLEDraggableElement[] {\r\n        return this.#selectedDraggables;\r\n    }\r\n\r\n    selectDraggable(draggable: HTMLEDraggableElement): void {\r\n        if (!this.selectedDraggables.includes(draggable)) {\r\n            this.selectedDraggables.push(draggable);\r\n        }\r\n        if (!draggable.selected) {\r\n            draggable.selected = true;\r\n        }\r\n    }\r\n\r\n    unselectDraggable(draggable: HTMLEDraggableElement): void {\r\n        const index = this.selectedDraggables.indexOf(draggable);\r\n        if (index > -1) {\r\n            if (draggable.selected) {\r\n                draggable.selected = false;\r\n            }\r\n            this.selectedDraggables.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    clearSelection(): void {\r\n        this.selectedDraggables.forEach((draggable) => {\r\n            draggable.selected = false;\r\n        });\r\n        this.#selectedDraggables = [];\r\n    }\r\n    \r\n    connectedCallback(): void {\r\n        this.tabIndex = this.tabIndex;\r\n\r\n        const slot = this.shadowRoot?.querySelector(\"slot\");\r\n        if (slot) {\r\n            slot.addEventListener(\"slotchange\", () => {\r\n                const draggables = slot.assignedElements().filter(\r\n                    elem => elem instanceof HTMLEDraggableElement\r\n                ) as HTMLEDraggableElement[];\r\n                this.#draggables = draggables;\r\n                this.draggables.forEach((draggable) => {\r\n                    draggable.draggable = true;\r\n                });\r\n            });\r\n        }\r\n\r\n        this.addEventListener(\"keydown\", (event: KeyboardEvent) => {\r\n            switch (event.key) {\r\n                case \"Escape\":\r\n                    this.clearSelection();\r\n                    this.focus();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        this.addEventListener(\"dragstart\", (event: DragEvent) => {\r\n            const target = event.target as any;\r\n            if (this.draggables.includes(target)) {\r\n                this.selectedDraggables.forEach((thisSelectedDraggable) => {\r\n                    thisSelectedDraggable.dragged = true;\r\n                });\r\n                const dataTransfer = event.dataTransfer;\r\n                if (dataTransfer) {\r\n                    dataTransfer.dropEffect = \"move\";\r\n                    dataTransfer.setData(\"text/plain\", this.id);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.addEventListener(\"dragleave\", (event) => {\r\n            const dataTransfer = event.dataTransfer;\r\n            if (dataTransfer) {\r\n                dataTransfer.dropEffect = \"none\";\r\n            }\r\n        });\r\n        \r\n        this.addEventListener(\"dragend\", (event: DragEvent) => {\r\n            const target = event.target as any;\r\n            if (this.draggables.includes(target)) {\r\n                const thisDraggedDraggables = this.draggables.filter(draggable => draggable.dragged);\r\n                thisDraggedDraggables.forEach((thisDraggedDraggable) => {\r\n                    thisDraggedDraggable.dragged = false;\r\n                });\r\n            }\r\n        });\r\n\r\n        this.addEventListener(\"focusout\", (event: FocusEvent) => {\r\n            const relatedTarget = event.relatedTarget as any;\r\n            if (!this.contains(relatedTarget)) {\r\n                this.clearSelection();\r\n            }\r\n        });\r\n        \r\n        this.addEventListener(\"mousedown\", (event: MouseEvent) => {\r\n            const target = event.target as any;\r\n            if (event.button == 0) {\r\n                if (this.draggables.includes(target)) {\r\n                    if (!event.shiftKey && !event.ctrlKey) {\r\n                        if (!target.selected) {\r\n                            this.clearSelection();\r\n                            this.selectDraggable(target);\r\n                        }\r\n                    }\r\n                    else if (event.ctrlKey) {\r\n                        (!target.selected) ?\r\n                            this.selectDraggable(target) :\r\n                            this.unselectDraggable(target);\r\n                    }\r\n                    else if (event.shiftKey) {\r\n                        if (this.selectedDraggables.length > 0) {\r\n                            const targetIndex = this.draggables.indexOf(target);\r\n                            const firstIndex = this.draggables.indexOf(this.selectedDraggables[0]);\r\n                            const direction = Math.sign(targetIndex - firstIndex);\r\n                            const fromIndex = (direction > 0) ? 0 : this.draggables.length - 1;\r\n                            const toIndex = (direction > 0) ? this.draggables.length - 1 : 0;\r\n                            const startRangeIndex = (direction > 0) ? firstIndex : targetIndex;\r\n                            const endRangeIndex = (direction > 0) ? targetIndex : firstIndex;\r\n                            for (let index = fromIndex; index !== (toIndex + direction); index += direction) {\r\n                                (index >= startRangeIndex && index <= endRangeIndex) ? \r\n                                    this.selectDraggable(this.draggables[index]) :\r\n                                    this.unselectDraggable(this.draggables[index]);\r\n                            }\r\n                        }\r\n                        else {\r\n                            this.selectDraggable(target);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.clearSelection();\r\n                }\r\n            }\r\n        });\r\n        \r\n        this.addEventListener(\"mouseup\", (event: MouseEvent) => {\r\n            const target = event.target as any;\r\n            if (event.button == 0) {\r\n                if (this.draggables.includes(target)) {\r\n                    if (!event.shiftKey && !event.ctrlKey) {\r\n                        this.draggables.forEach((thisDraggable) => {\r\n                            if (thisDraggable !== target) {\r\n                                this.unselectDraggable(thisDraggable);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nvar HTMLEDragzoneElement: HTMLEDragzoneElementConstructor = HTMLEDragzoneElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEDraggableElement } from \"./Draggable\";\r\nimport { HTMLEDragzoneElement } from \"./Dragzone\";\r\n\r\nexport { HTMLEDropzoneElement };\r\nexport { EDataChangeEvent };\r\n\r\ninterface HTMLEDropzoneElementConstructor {\r\n    prototype: HTMLEDropzoneElement;\r\n    new(): HTMLEDropzoneElement;\r\n}\r\n\r\ninterface HTMLEDropzoneElement extends HTMLEDragzoneElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    dragovered: DropzoneDragoveredType | null;\r\n    name: string;\r\n    multiple: boolean;\r\n    placeholder: string;\r\n\r\n    droptest: ((dropzone: HTMLEDropzoneElement, draggables: HTMLEDraggableElement[]) => void) | null;\r\n\r\n    addDraggables(draggables: HTMLEDraggableElement[], position: number): void;\r\n    removeDraggables(predicate: (draggable: HTMLEDraggableElement, index: number) => boolean): void;\r\n\r\n    connectedCallback(): void;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\r\n}\r\n\r\ntype DropzoneDragoveredType = \"self\" | \"draggable\" | \"appendarea\";\r\n\r\ntype EDataChangeEvent = CustomEvent<{\r\n    action: \"insert\" | \"remove\";\r\n    draggables: HTMLEDraggableElement[];\r\n    position: number;\r\n}>;\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-dropzone\": HTMLEDropzoneElement,\r\n    }\r\n    \r\n    interface HTMLElementEventMap {\r\n        \"e_datachange\": EDataChangeEvent,\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"e-dropzone\"\r\n})\r\nclass HTMLEDropzoneElementBase extends HTMLEDragzoneElement implements HTMLEDropzoneElement {\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    dragovered!: DropzoneDragoveredType | null;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    placeholder!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    multiple!: boolean;\r\n\r\n    droptest!: ((dropzone: HTMLEDropzoneElement, draggables: HTMLEDraggableElement[]) => boolean) | null;\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.shadowRoot!.querySelector(\"style\")!.append(/*css*/`\r\n            :host {\r\n                border: 1px dashed gray;\r\n            }\r\n\r\n            :host(:not([multiple]):not(:empty)) [part=\"appendarea\"],\r\n            :host(:not(:empty):not([dragovered])) [part=\"appendarea\"] {\r\n                display: none !important;\r\n            }\r\n\r\n            [part=\"appendarea\"] {\r\n                display: block;\r\n                margin: 2px;\r\n                border-radius: 4px;\r\n                border: 1px dotted black;\r\n            }\r\n\r\n            :host(:not([dragovered=\"appendarea\"])) [part=\"appendarea\"] {\r\n                border-color: transparent;\r\n            }\r\n            \r\n            [part=\"placeholder\"] {\r\n                display: inline-block;\r\n                color: grey;\r\n                pointer-events: none;\r\n                user-select: none;\r\n            }\r\n        `);\r\n\r\n        this.shadowRoot.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"appendarea\"\r\n                },\r\n                children: [\r\n                    element(\"span\", {\r\n                        attributes: {\r\n                            part: \"placeholder\"\r\n                        },\r\n                        children: [\r\n                            \"&nbsp;\"\r\n                        ]\r\n                    })\r\n                ]\r\n            })\r\n        );\r\n\r\n        this.droptest = null;\r\n    }\r\n    \r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const appendAreaPart = this.shadowRoot!.querySelector<HTMLDivElement>(\"[part='appendarea']\");\r\n\r\n        this.addEventListener(\"keydown\", (event: KeyboardEvent) => {\r\n            switch (event.key) {\r\n                case \"Delete\":\r\n                    if (this == event.target) {\r\n                        this.removeDraggables();\r\n                    }\r\n                    else {\r\n                        this.removeDraggables(draggable => draggable.selected);\r\n                    }\r\n                    event.stopPropagation();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        this.addEventListener(\"dragover\", (event: DragEvent) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        this.shadowRoot!.addEventListener(\"dragover\", (event) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        this.addEventListener(\"dragenter\", (event: DragEvent) => {\r\n            const target = event.target as any;\r\n            if (this.draggables.includes(target)) {\r\n                target.dragovered = true;\r\n                this.dragovered = \"draggable\";\r\n            }\r\n            else {\r\n                this.dragovered = \"self\";\r\n            }\r\n            event.preventDefault();\r\n        });\r\n\r\n        this.shadowRoot!.addEventListener(\"dragenter\", (event) => {\r\n            const target = event.target as any;\r\n            if (target == appendAreaPart) {\r\n                this.dragovered = \"appendarea\";\r\n            }\r\n            event.preventDefault();\r\n        });\r\n\r\n        this.addEventListener(\"dragleave\", (event: DragEvent) => {\r\n            const relatedTarget = event.relatedTarget as any;\r\n            const target = event.target as any;\r\n            if (target == this || this.draggables.includes(target)) {\r\n                if (target == this) {\r\n                    if (appendAreaPart) {\r\n                        this.dragovered = \"self\";\r\n                    }\r\n                    if (!this.draggables.includes(relatedTarget)) {\r\n                        this.dragovered = null;\r\n                    }\r\n                }\r\n                else {\r\n                    target.dragovered = false;\r\n                }\r\n            }\r\n            event.preventDefault();\r\n        });\r\n\r\n        this.shadowRoot!.addEventListener(\"dragleave\", (event) => {\r\n            const target = event.target as any;\r\n            if (target == appendAreaPart) {\r\n                this.dragovered = \"self\";\r\n            }\r\n            event.preventDefault();\r\n        });\r\n        \r\n        this.addEventListener(\"drop\", (event) => {\r\n            const target = event.target as any;\r\n            if (target == this || this.draggables.includes(target)) {\r\n                let dropIndex = this.draggables.length;\r\n                if (target == this) {\r\n                    this.dragovered = null;\r\n                }\r\n                else {\r\n                    target.dragovered = false;\r\n                    dropIndex = this.draggables.indexOf(target);\r\n                }\r\n\r\n                const dataTransfer = event.dataTransfer;\r\n                if (dataTransfer) {\r\n                    const dragzoneId = dataTransfer.getData(\"text/plain\");\r\n                    const dragzone = document.getElementById(dragzoneId);\r\n                    if (dragzone instanceof HTMLEDragzoneElement) {\r\n                        const selectedDraggables = dragzone.selectedDraggables;\r\n                        if (selectedDraggables) {\r\n                            selectedDraggables.forEach((selectedDraggable) => {\r\n                                selectedDraggable.dragged = false;\r\n                            });\r\n                            if (dragzone instanceof HTMLEDropzoneElement) {\r\n                                dragzone.removeDraggables((draggable) => selectedDraggables.includes(draggable));\r\n                            }\r\n                            dragzone.clearSelection();\r\n                            this.addDraggables(selectedDraggables, dropIndex);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.dragovered = null;\r\n            event.preventDefault();\r\n        });\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"placeholder\": {\r\n                const placeholderPart = this.shadowRoot.querySelector(\"[part='placeholder']\");\r\n                if (placeholderPart) {\r\n                    placeholderPart.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    addDraggables(draggables: HTMLEDraggableElement[], position: number): HTMLEDraggableElement[] | null {\r\n        if (draggables.length > 0) {\r\n            let dataTransferSuccess = true;\r\n            if (this.droptest) {\r\n                dataTransferSuccess = this.droptest(this, draggables);\r\n            }\r\n            \r\n            let newDraggables: HTMLEDraggableElement[] = [];\r\n            let insertionPosition = -1;\r\n            if (dataTransferSuccess) {\r\n                if (this.multiple) {\r\n                    draggables.forEach((draggable) => {\r\n                        let newDraggable = draggable.getReference();\r\n                        if (position > -1 && position < this.draggables.length) {\r\n                            this.draggables[position].insertAdjacentElement(\"beforebegin\", newDraggable);\r\n                            insertionPosition = (insertionPosition < 0) ? position : insertionPosition;\r\n                        }\r\n                        else {\r\n                            this.appendChild(newDraggable);\r\n                            insertionPosition = (insertionPosition < 0) ? this.draggables.length - 1 : insertionPosition;\r\n                        }\r\n                        newDraggables.push(newDraggable);\r\n                    });\r\n                }\r\n                else {\r\n                    let newDraggable = draggables[0].getReference();\r\n                    if (this.draggables.length > 0) {\r\n                        this.replaceChild(newDraggable, this.draggables[0]);\r\n                    }\r\n                    else {\r\n                        this.appendChild(newDraggable);\r\n                    }\r\n                    newDraggables.push(newDraggable);\r\n                    insertionPosition = 0;\r\n                }\r\n            }\r\n            \r\n            const slot = this.shadowRoot?.querySelector(\"slot\");\r\n            if (slot) {\r\n                slot.addEventListener(\"slotchange\", () => {\r\n                    this.dispatchEvent(new CustomEvent(\"e_datachange\", {\r\n                        bubbles: true,\r\n                        detail: {\r\n                            action: \"insert\",\r\n                            draggables: newDraggables,\r\n                            position: insertionPosition\r\n                        }\r\n                    }));\r\n                }, {once: true});\r\n            }\r\n            return newDraggables;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    removeDraggables(predicate: (draggable: HTMLEDraggableElement, index: number) => boolean = () => true) {\r\n        let toRemove = this.draggables.filter(\r\n            (value: HTMLEDraggableElement, index: number) => {\r\n                return predicate(value, index);\r\n            }\r\n        );\r\n        let atPosition = this.draggables.indexOf(toRemove[0]);\r\n        toRemove.forEach((draggable) => {\r\n            draggable.remove(); \r\n        });\r\n        const slot = this.shadowRoot?.querySelector(\"slot\");\r\n        if (slot) {\r\n            slot.addEventListener(\"slotchange\", () => {\r\n                this.dispatchEvent(new CustomEvent(\"e_datachange\", {\r\n                    bubbles: true,\r\n                    detail: {\r\n                        action: \"remove\",\r\n                        draggables: toRemove,\r\n                        position: atPosition\r\n                    }\r\n                }));\r\n            }, {once: true});\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEDropzoneElement: HTMLEDropzoneElementConstructor = HTMLEDropzoneElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\n\r\nexport { HTMLEOptionElement };\r\n\r\ninterface HTMLEOptionElementConstructor {\r\n    prototype: HTMLEOptionElement;\r\n    new(): HTMLEOptionElement;\r\n}\r\n\r\ninterface HTMLEOptionElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n    name: string;\r\n    value: string;\r\n    label: string;\r\n    disabled: boolean;\r\n    selected: boolean;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-option\": HTMLEOptionElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-option\"\r\n})\r\nclass HTMLEOptionElementBase extends HTMLElement implements HTMLEOptionElement {\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String})\r\n    value!: string;\r\n    \r\n    @AttributeProperty({type: String, observed: true})\r\n    label!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    disabled!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    selected!: boolean;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"span\", {\r\n                attributes: {\r\n                    part: \"label\"\r\n                }\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: flex;\r\n                user-select: none;\r\n                white-space: nowrap;\r\n                line-height: 22px;\r\n                padding: 0 12px;\r\n            }\r\n            \r\n            :host(:hover) {\r\n                background-color: var(--hovered-item-color);\r\n            }\r\n            \r\n            :host(:focus-within) {\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n            }\r\n            \r\n            :host([selected]) {\r\n                background-color: var(--selected-item-color);\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host(::before) {\r\n                display: flex;\r\n                content: \"\";\r\n                width: 18px;\r\n                height: 18px;\r\n                margin-right: 6px;\r\n            \r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--icon-color, none);\r\n                -webkit-mask-image: var(--icon-image, none);\r\n                mask-image: var(--icon-image, none);\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const internals = this.attachInternals();\r\n        internals.role = \"option\";\r\n        this.internals = internals;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {tabIndex} = this;\r\n        this.tabIndex = tabIndex;\r\n    }\r\n    \r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"label\": {\r\n                const {shadowRoot} = this;\r\n                const labelPart = shadowRoot.querySelector<HTMLElement>(\"[part=label]\");\r\n                if (labelPart) {\r\n                    labelPart.textContent = newValue;\r\n                }\r\n                break;\r\n            }\r\n            case \"selected\": {\r\n                const {internals, selected} = this;\r\n                internals.ariaSelected = String(selected);\r\n                this.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEOptionElement: HTMLEOptionElementConstructor = HTMLEOptionElementBase;","import { CustomElement, element } from \"../../Element\";\r\n\r\nexport { HTMLEOptionGroupElement };\r\n\r\ninterface HTMLEOptionGroupElementConstructor {\r\n    prototype: HTMLEOptionGroupElement;\r\n    new(): HTMLEOptionGroupElement;\r\n}\r\n\r\ninterface HTMLEOptionGroupElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-optiongroup\": HTMLEOptionGroupElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-optiongroup\"\r\n})\r\nclass HTMLEOptionGroupElementBase extends HTMLElement implements HTMLEOptionGroupElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"slot\")\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n}\r\n\r\nvar HTMLEOptionGroupElement: HTMLEOptionGroupElementConstructor = HTMLEOptionGroupElementBase;","import { CustomElement, AttributeProperty, element } from \"../../Element\";\r\nimport { HTMLEOptionElement } from \"./Option\";\r\nimport { HTMLEOptionGroupElement } from \"./OptionGroup\";\r\n\r\nexport { HTMLESelectElement };\r\n\r\ninterface HTMLESelectElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n    get options(): HTMLEOptionElement[];\r\n    get activeOption(): HTMLEOptionElement | null;\r\n    get selectedOption(): HTMLEOptionElement | null;\r\n    name: string;\r\n    value: string;\r\n    expanded: boolean;\r\n    expand(): void;\r\n    collapse(): void;\r\n    toggle(force?: boolean): void;\r\n}\r\n\r\ninterface HTMLESelectElementConstructor {\r\n    prototype: HTMLESelectElement;\r\n    new(): HTMLESelectElement;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-select\": HTMLESelectElement,\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\nvar mutationObserver: MutationObserver;\r\n\r\n@CustomElement({\r\n    name: \"e-select\"\r\n})\r\nclass HTMLESelectElementBase extends HTMLElement implements HTMLESelectElement {\r\n    \r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly internals: ElementInternals;\r\n\r\n    static get formAssociated(): boolean {\r\n        return true;\r\n    }\r\n\r\n    get options(): HTMLEOptionElement[] {\r\n        return Array.from(this.querySelectorAll<HTMLEOptionElement>(\r\n            \"e-option\"\r\n        ));\r\n    }\r\n\r\n    get activeOption(): HTMLEOptionElement | null {\r\n        return this.querySelector(\"e-option:focus-within\") ?? null;\r\n    }\r\n\r\n    get selectedOption(): HTMLEOptionElement | null {\r\n        return this.querySelector(\"e-option[selected]\") ?? null;\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    name!: string;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    value!: string;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"select\", observed: true})\r\n    type!: string;\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    expanded!: boolean;\r\n\r\n    #walker: TreeWalker;\r\n    #wasExpandedOnMouseDown: boolean;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"content\"\r\n                },\r\n                children: [\r\n                    element(\"output\", {\r\n                        attributes: {\r\n                            part: \"value\"\r\n                        }\r\n                    })\r\n                ]\r\n            }),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"box\"\r\n                },\r\n                children: element(\"slot\")\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: inline-block;\r\n                user-select: none;\r\n                line-height: 22px;\r\n                border: 1px solid var(--item-border-color);\r\n            }\r\n\r\n            :host(:focus-visible) {\r\n                outline: none;\r\n            }\r\n            \r\n            :host(:focus-within) {\r\n                background-color: var(--focused-item-color);\r\n            }\r\n            \r\n            :host([disabled]) {\r\n                opacity: 0.38;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            [part=\"content\"] {\r\n                display: flex;\r\n                overflow: hidden;\r\n                padding: 0 4px;\r\n            }\r\n            \r\n            [part=\"content\"]::after {\r\n                display: inline-block;\r\n                text-align: center;\r\n                width: 22px;\r\n                height: 22px;\r\n                margin-left: 6px;\r\n                content: \"▾\";\r\n            }\r\n            \r\n            [part=\"value\"] {\r\n                margin-right: auto;\r\n                text-align: right;\r\n            }\r\n            \r\n            [part=\"box\"] {\r\n                z-index: 1;\r\n                position: fixed;\r\n            \r\n                display: block;\r\n                padding: 6px 0;\r\n                width: max-content;\r\n            \r\n                background-color: white;\r\n            \r\n                -webkit-box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n                -moz-box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 6px;\r\n            }\r\n            \r\n            :host(:not([expanded])) [part=\"box\"] {\r\n                opacity: 0;\r\n                pointer-events: none;\r\n            }\r\n        `;\r\n        mutationObserver = new MutationObserver(\r\n            (mutationsList: MutationRecord[]) => {\r\n                mutationsList.forEach((mutation: MutationRecord) => {\r\n                    const {target} = mutation;\r\n                    const select = <HTMLESelectElementBase>target;\r\n                    const {selectedOption, value, options} = select;\r\n                    if (!selectedOption) {\r\n                        const optionToSelect = value ? options.find(\r\n                            option_i => option_i.value === value\r\n                        ) : select.#firstOption();\r\n                        if (optionToSelect) {\r\n                            optionToSelect.selected = true;\r\n                        }\r\n                        else {\r\n                            select.#setSelectedOption(null);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        );\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const internals = this.attachInternals();\r\n        internals.role = \"combobox\";\r\n        this.internals = internals;\r\n        this.#wasExpandedOnMouseDown = false;\r\n        this.#walker = document.createTreeWalker(\r\n            this, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        this.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        this.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        this.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        this.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        this.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        mutationObserver.observe(\r\n            this, {\r\n                childList: true,\r\n                subtree: true\r\n            }\r\n        );\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {options, selectedOption, value} = this;\r\n        const tabindex = this.getAttribute(\"tabindex\");\r\n        this.tabIndex = tabindex !== null ? parseInt(tabindex) : 0;\r\n        customElements.upgrade(this);\r\n        const optionToSelect = selectedOption ?? (\r\n            value ? options.find(\r\n                option_i => option_i.value === value\r\n            ) : null\r\n        ) ?? this.#firstOption();\r\n        if (optionToSelect) {\r\n            if (optionToSelect === selectedOption) {\r\n                this.#setSelectedOption(selectedOption);\r\n            }\r\n            else {\r\n                this.#selectOption(optionToSelect);\r\n            }\r\n        }\r\n    }\r\n\r\n    expand(): void {\r\n        const {expanded} = this;\r\n        if (!expanded) {\r\n            this.expanded = true;\r\n            this.#positionBox();\r\n            const {selectedOption} = this;\r\n            if (selectedOption) {\r\n                selectedOption.focus({preventScroll: true});\r\n            }\r\n        }\r\n    }\r\n\r\n    collapse(): void {\r\n        const {expanded} = this;\r\n        if (expanded) {\r\n            this.expanded = false;\r\n            this.focus();\r\n        }\r\n    }\r\n\r\n    toggle(force?: boolean): void {\r\n        const {expanded} = this;\r\n        const expand = force ?? !expanded;\r\n        expand ? this.expand() : this.collapse();\r\n    }\r\n    \r\n    #value(): HTMLElement {\r\n        return this.shadowRoot.querySelector<HTMLElement>(\"[part=value]\")!;\r\n    }\r\n\r\n    #box(): HTMLElement {\r\n        return this.shadowRoot.querySelector<HTMLElement>(\"[part=box]\")!;\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLEOptionElement && !node.disabled && !node.hidden) {\r\n            return NodeFilter.FILTER_ACCEPT;\r\n        }\r\n        else if (node instanceof HTMLEOptionGroupElement) {\r\n            return NodeFilter.FILTER_SKIP;\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #firstOption(): HTMLEOptionElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEOptionElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastOption(): HTMLEOptionElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = walker.root;\r\n        return <HTMLEOptionElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousOption(option: HTMLEOptionElement): HTMLEOptionElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = option;\r\n        return <HTMLEOptionElement | null>walker.previousNode();\r\n    }\r\n\r\n    #nextOption(option: HTMLEOptionElement): HTMLEOptionElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = option;\r\n        return <HTMLEOptionElement | null>walker.nextNode();\r\n    }\r\n\r\n    #selectOption(option: HTMLEOptionElement) {\r\n        const {selectedOption} = this;\r\n        if (option !== selectedOption) {\r\n            option.selected = true;\r\n        }\r\n    }\r\n    \r\n    #setSelectedOption(option: HTMLEOptionElement | null) {\r\n        const {label, value} = option ?? {\r\n            label: \"\",\r\n            value: \"\"\r\n        };\r\n        const {internals} = this;\r\n        this.#value().textContent = label;\r\n        internals.setFormValue(value);\r\n    }\r\n\r\n    #positionBox(): void {\r\n        const box = this.#box()\r\n        const {style: optionsStyle} = box;\r\n        const {bottom, left} = this.getBoundingClientRect();\r\n        const {scrollX, scrollY} = window;\r\n        optionsStyle.setProperty(\"top\", `${bottom + scrollY}px`);\r\n        optionsStyle.setProperty(\"left\", `${left + scrollX}px`);\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const wasExpandedOnMouseDown = this.#wasExpandedOnMouseDown;\r\n        if (!wasExpandedOnMouseDown) {\r\n            const {selectedOption} = this;\r\n            this.expand();\r\n            (selectedOption ?? this.#firstOption() ?? this).focus({preventScroll: true});\r\n        }\r\n        else {\r\n            this.collapse();\r\n            const targetOption = (<HTMLElement>target).closest<HTMLEOptionElement>(\"e-option\");\r\n            if (targetOption) {\r\n                this.#selectOption(targetOption);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {relatedTarget} = event;\r\n        const lostFocusWithin = !this.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin || this === relatedTarget) {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(): void {\r\n        const {expanded} = this;\r\n        this.#wasExpandedOnMouseDown = expanded;\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetOption = (<Element>target).closest<HTMLEOptionElement>(\"e-option\");\r\n        if (targetOption) {\r\n            targetOption.focus({preventScroll: true});\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        const {expanded, activeOption, selectedOption} = this;\r\n        switch (key) {\r\n            case \"ArrowUp\": {\r\n                if (expanded) {\r\n                    const previousOption = activeOption ?\r\n                        this.#previousOption(activeOption) :\r\n                        this.#firstOption();\r\n                    if (previousOption) {\r\n                        previousOption.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const previousOption = selectedOption ?\r\n                        this.#previousOption(selectedOption) :\r\n                        this.#firstOption();\r\n                    if (previousOption) {\r\n                        this.#selectOption(previousOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (expanded) {\r\n                    const nextOption = activeOption ?\r\n                        this.#nextOption(activeOption) :\r\n                        this.#lastOption();\r\n                    if (nextOption) {\r\n                        nextOption.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const nextOption = selectedOption ?\r\n                        this.#nextOption(selectedOption) :\r\n                        this.#lastOption();\r\n                    if (nextOption) {\r\n                        this.#selectOption(nextOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstOption = this.#firstOption();\r\n                if (firstOption) {\r\n                    if (expanded) {\r\n                        firstOption.focus({preventScroll: true});\r\n                    }\r\n                    else {\r\n                        this.#selectOption(firstOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastOption = this.#lastOption();\r\n                if (lastOption) {\r\n                    if (expanded) {\r\n                        lastOption.focus({preventScroll: true});\r\n                    }\r\n                    else {\r\n                        this.#selectOption(lastOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                this.toggle();\r\n                const {expanded} = this;\r\n                if (expanded) {\r\n                    const {selectedOption} = this;\r\n                    (selectedOption ?? this.#firstOption())?.focus({preventScroll: true});\r\n                }\r\n                else {\r\n                    if (activeOption) {\r\n                        this.#selectOption(activeOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (expanded) {\r\n                    this.collapse();\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                }\r\n                break;\r\n            }\r\n            default: {\r\n                const {length: keyLength} = key;\r\n                if (keyLength == 1) {\r\n                    const keyCode = key.charCodeAt(0);\r\n                    const {options} = this;\r\n                    const activeIndex = activeOption ? options.indexOf(activeOption) : -1;\r\n                    const matchingOption = options.find(\r\n                        (option_i, i) => option_i.label.toLowerCase().charCodeAt(0) == keyCode && i > activeIndex\r\n                    ) ?? options.find(\r\n                        (option_i) => option_i.label.toLowerCase().charCodeAt(0) == keyCode\r\n                    );\r\n                    if (matchingOption) {\r\n                        matchingOption.focus({preventScroll: true});\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    #handleSelectEvent(event: Event): void {\r\n        const {target} = event;\r\n        const targetOption = (<Element>target).closest<HTMLEOptionElement>(\"e-option\");\r\n        if (targetOption) {\r\n            const {selected} = targetOption;\r\n            if (selected) {\r\n                const {options} = this;\r\n                options.forEach((option_i) => {\r\n                    if (option_i !== targetOption && option_i.selected) {\r\n                        option_i.selected = false;\r\n                    }\r\n                });\r\n                this.#setSelectedOption(targetOption);\r\n            }\r\n            else {\r\n                const {selectedOption} = this;\r\n                if (selectedOption === null) {\r\n                    const firstOption = this.#firstOption();\r\n                    if (firstOption !== null) {\r\n                        this.#setSelectedOption(firstOption);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLESelectElement: HTMLESelectElementConstructor = HTMLESelectElementBase;","import { CustomElement, AttributeProperty, element } from \"../Element\";\r\n\r\nexport { HTMLEHandleElement };\r\n\r\ninterface HTMLEHandleElementConstructor {\r\n    prototype: HTMLEHandleElement;\r\n    new(): HTMLEHandleElement;\r\n}\r\n\r\ninterface HTMLEHandleElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    controls: string;\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-handle\": HTMLEHandleElement;\r\n    }\r\n    interface HTMLElementEventMap {\r\n        \"move\": Event;\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-handle\"\r\n})\r\nclass HTMLEHandleElementBase extends HTMLElement implements HTMLEHandleElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    controls!: string;\r\n\r\n    #target: HTMLElement | null;\r\n    #onCapture: boolean;\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                            \r\n                width: 24px;\r\n                height: 12px;\r\n                \r\n                background-color: var(--selected-item-color);\r\n\r\n                -webkit-mask-image: url(\"/assets/dots.png\");\r\n                mask-image: url(\"/assets/dots.png\");\r\n\r\n                -webkit-mask-repeat: repeat;\r\n                mask-repeat: repeat;\r\n                cursor: move;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.#target = null;\r\n        this.#onCapture = false;\r\n        this.addEventListener(\"pointerdown\", this.#handlePointerDownEvent.bind(this));\r\n        this.addEventListener(\"pointermove\", this.#handlePointerMoveEvent.bind(this));\r\n        this.addEventListener(\"pointerup\", this.#handlePointerUpEvent.bind(this));\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"controls\": {\r\n                const {controls} = this;\r\n                this.#target = document.getElementById(controls);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handlePointerUpEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        this.releasePointerCapture(pointerId);\r\n        this.#onCapture = false;\r\n    }\r\n\r\n    #handlePointerDownEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        const {controls} = this;\r\n        this.#target = document.getElementById(controls);\r\n        this.setPointerCapture(pointerId);\r\n        this.#onCapture = true;\r\n    }\r\n\r\n    #handlePointerMoveEvent(event: PointerEvent): void {\r\n        if (this.#onCapture) {\r\n            const target = this.#target;\r\n            if (target !== null) {\r\n                const targetComputedStyle = window.getComputedStyle(target);\r\n                const {movementX, movementY} = event;\r\n                const {width: rectWidth, height: rectHeight} = target.getBoundingClientRect();\r\n                const outerElement = target.parentElement ?? document.body;\r\n                const {\r\n                    left: outerRectLeft, right: outerRectRight,\r\n                    top: outerRectTop, bottom: outerRectBottom\r\n                } = outerElement.getBoundingClientRect();\r\n                const left = parseFloat(targetComputedStyle.getPropertyValue(\"left\"));\r\n                const newLeft = Math.max(outerRectLeft, Math.min(Math.trunc(left + movementX), outerRectRight - rectWidth));\r\n                const top = parseFloat(targetComputedStyle.getPropertyValue(\"top\"));\r\n                const newTop = Math.max(outerRectTop, Math.min(Math.trunc(top + movementY), outerRectBottom - rectHeight));\r\n                target.style.setProperty(\"left\", `${newLeft}px`);\r\n                target.style.setProperty(\"top\", `${newTop}px`);\r\n                this.dispatchEvent(new CustomEvent(\"move\"));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEHandleElement: HTMLEHandleElementConstructor = HTMLEHandleElementBase;","import { CustomElement, AttributeProperty, element } from \"../Element\";\r\n\r\nexport { HTMLEHeightSashElement };\r\n\r\ninterface HTMLEHeightSashElementConstructor {\r\n    prototype: HTMLEHeightSashElement;\r\n    new(): HTMLEHeightSashElement;\r\n}\r\n\r\ninterface HTMLEHeightSashElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly target: HTMLElement | null;\r\n    controls: string;\r\n    growdir: \"top\" | \"bottom\";\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-hsash\": HTMLEHeightSashElement;\r\n    }\r\n    interface HTMLElementEventMap {\r\n        \"resize\": Event;\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-hsash\"\r\n})\r\nclass HTMLEHeightSashElementBase extends HTMLElement implements HTMLEHeightSashElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get target(): HTMLElement | null {\r\n        return this.#target;\r\n    }\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                background-color: var(--selected-item-color);\r\n                transition-property: opacity;\r\n                transition-delay: 0.2s;\r\n                transition-duration: 0.2s;\r\n                transition-timing-function: ease-out;\r\n                \r\n                height: 4px;\r\n                cursor: ns-resize;\r\n            }\r\n        `;\r\n    }\r\n\r\n    @AttributeProperty({type: String})\r\n    controls!: string;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"top\"})\r\n    growdir!: \"top\" | \"bottom\";\r\n\r\n    #target: HTMLElement | null;\r\n    #onCapture: boolean;\r\n    #queuedPointerCallback: FrameRequestCallback | null;\r\n    #pointerMovement: number;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#target = null;\r\n        this.#queuedPointerCallback = null;\r\n        this.#pointerMovement = 0;\r\n        this.#onCapture = false;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.addEventListener(\"pointerdown\", this.#handlePointerDownEvent.bind(this));\r\n        this.addEventListener(\"pointermove\", this.#handlePointerMoveEvent.bind(this));\r\n        this.addEventListener(\"pointerup\", this.#handlePointerUpEvent.bind(this));\r\n    }\r\n\r\n    #pointerMoveCallback(): void {\r\n        const target = this.#target;\r\n        if (target !== null) {\r\n            const targetComputedStyle = window.getComputedStyle(target);\r\n            const {style} = target;\r\n            const {growdir} = this;\r\n            const movementY = this.#pointerMovement;\r\n            const height = parseFloat(targetComputedStyle.getPropertyValue(\"height\"));\r\n            const newHeight = Math.trunc(height + (growdir == \"top\" ? -1 : 1) * movementY);\r\n            style.setProperty(\"height\", `${newHeight}px`);\r\n            const computedNewHeight = parseFloat(targetComputedStyle.getPropertyValue(\"height\"));\r\n            style.setProperty(\"height\", `${computedNewHeight}px`);\r\n            this.dispatchEvent(new Event(\"resize\"));\r\n        }\r\n        this.#queuedPointerCallback = null;\r\n    }\r\n\r\n    #handlePointerDownEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        const {controls} = this;\r\n        const rootNode = <ShadowRoot | Document>this.getRootNode();\r\n        this.#target = rootNode.getElementById(controls);\r\n        this.setPointerCapture(pointerId);\r\n        this.#onCapture = true;\r\n    }\r\n\r\n    #handlePointerMoveEvent(event: PointerEvent): void {\r\n        if (this.#onCapture) {\r\n            if (this.#queuedPointerCallback == null) {\r\n                this.#pointerMovement = event.movementY;\r\n                this.#queuedPointerCallback = this.#pointerMoveCallback.bind(this);\r\n                requestAnimationFrame(this.#queuedPointerCallback);\r\n            }\r\n            else {\r\n                this.#pointerMovement += event.movementY;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handlePointerUpEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        this.releasePointerCapture(pointerId);\r\n        this.#onCapture = false;\r\n    }\r\n}\r\n\r\nvar HTMLEHeightSashElement: HTMLEHeightSashElementConstructor = HTMLEHeightSashElementBase;","import { CustomElement, AttributeProperty } from \"../Element\";\r\n\r\nexport { HTMLEImportElement };\r\n\r\ninterface HTMLEImportElementConstructor {\r\n    prototype: HTMLEImportElement;\r\n    new(): HTMLEImportElement;\r\n}\r\n\r\ninterface HTMLEImportElement extends HTMLElement {\r\n    src: string;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-import\": HTMLEImportElement;\r\n    }\r\n    interface HTMLElementEventMap {\r\n        \"load\": Event;\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"e-import\"\r\n})\r\nclass HTMLEImportElementBase extends HTMLElement implements HTMLEImportElement {\r\n\r\n    @AttributeProperty({type: String})\r\n    src!: string;\r\n    \r\n    connectedCallback(): void {\r\n        const {src} = this;\r\n        if (src) {\r\n            this.#importRequest(src);\r\n        }\r\n    }\r\n\r\n    async #importRequest(src: string): Promise<void> {\r\n        this.outerHTML = await fetch(src).then((response: Response) => {\r\n            if (response.ok) {\r\n                return response.text();\r\n            }\r\n            else {\r\n                throw new Error(response.statusText);\r\n            }\r\n        });\r\n        this.dispatchEvent(new Event(\"load\", {bubbles: true}));\r\n    }\r\n}\r\n\r\nvar HTMLEImportElement: HTMLEImportElementConstructor = HTMLEImportElementBase;","import { CustomElement, AttributeProperty, element, trimMultilineIndent } from \"../Element\";\r\n\r\nexport { HTMLELoaderElement };\r\n\r\ninterface HTMLELoaderElementConstructor {\r\n    prototype: HTMLELoaderElement;\r\n    new(): HTMLELoaderElement;\r\n}\r\n\r\ninterface HTMLELoaderElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    type: \"bar\" | \"spinner\";\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-loader\": HTMLELoaderElement,\r\n    }\r\n}\r\n\r\nvar barShadowTemplate: HTMLTemplateElement;\r\nvar spinnerShadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-loader\"\r\n})\r\nclass HTMLELoaderElementBase extends HTMLElement implements HTMLELoaderElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    \r\n    @AttributeProperty({type: String, defaultValue: \"bar\", observed: true})\r\n    type!: \"bar\" | \"spinner\";\r\n\r\n    static {\r\n        barShadowTemplate = element(\"template\");\r\n        barShadowTemplate.content.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"bar\"\r\n                },\r\n                children: [\r\n                    element(\"div\", {\r\n                        attributes: {\r\n                            part: \"slider\"\r\n                        },\r\n                        children: [\r\n                            element(\"div\", {\r\n                                attributes: {\r\n                                    part: \"cursor\"\r\n                                }\r\n                            })\r\n                        ]\r\n                    })\r\n                ]\r\n            })\r\n        );\r\n        spinnerShadowTemplate = element(\"template\");\r\n        spinnerShadowTemplate.content.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"spinner\"\r\n                }\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: inline-block;\r\n            }\r\n\r\n            :host(:is(:not([type]), [type=\"bar\"])) {\r\n                border: 1px solid gainsboro;\r\n                border-radius: 4px;\r\n            }\r\n        \r\n            [part=\"bar\"] {\r\n                position: relative;\r\n                overflow: hidden;\r\n                height: 6px;\r\n                width: 100%;\r\n                width: 86px;\r\n                border-radius: 4px;\r\n            }\r\n        \r\n            [part=\"slider\"] {\r\n                display: flex;\r\n                position: absolute;\r\n                width: 100%;\r\n                height: 100%;\r\n                animation-name: slider;\r\n            }\r\n        \r\n            [part=\"slider\"],\r\n            [part=\"cursor\"] {\r\n                border-radius: 4px;\r\n                will-change: transform;\r\n                animation-duration: 1s;\r\n                animation-timing-function: linear;\r\n                animation-iteration-count: infinite;\r\n            }\r\n        \r\n            [part=\"cursor\"] {\r\n                display: block;\r\n                width: 32px;\r\n                background-color: rgb(0, 128, 255);\r\n                animation-name: cursor;\r\n            }\r\n        \r\n            :host([type=\"spinner\"]) {\r\n                display: inline-block;\r\n                width: 20px;\r\n                height: 20px;\r\n            }\r\n        \r\n            [part=\"spinner\"] {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n            }\r\n        \r\n            [part=\"spinner\"]::after {\r\n                content: \" \";\r\n                display: block;\r\n                width: 12px;\r\n                height: 12px;\r\n                border-radius: 50%;\r\n                border-width: 4px;\r\n                border-style: solid;\r\n                border-color: transparent rgb(0, 128, 255);\r\n                animation: spin 1.2s linear infinite;\r\n            }\r\n        \r\n            @keyframes slider {\r\n                0% {\r\n                    transform: translateX(0%);\r\n                }\r\n                100% {\r\n                    transform: translateX(100%);\r\n                }\r\n            }\r\n        \r\n            @keyframes cursor {\r\n                0% {\r\n                    transform: translateX(-100%);\r\n                }\r\n                100% {\r\n                    transform: translateX(100%);\r\n                }\r\n            }\r\n        \r\n            @keyframes spin {\r\n                0% {\r\n                    transform: rotate(0);\r\n                }\r\n                100% {\r\n                    transform: rotate(360deg);\r\n                }\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.replaceChildren(\r\n            barShadowTemplate.content.cloneNode(true)\r\n        );\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"type\": {\r\n                this.#updateTemplate();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #updateTemplate(): void {\r\n        const {type, shadowRoot} = this;\r\n        switch (type) {\r\n            case \"spinner\": {\r\n                shadowRoot.replaceChildren(\r\n                    spinnerShadowTemplate.content.cloneNode(true)\r\n                );\r\n                break;\r\n            }\r\n            case \"bar\": {\r\n                shadowRoot.replaceChildren(\r\n                    barShadowTemplate.content.cloneNode(true)\r\n                );\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLELoaderElement: HTMLELoaderElementConstructor = HTMLELoaderElementBase;","import { CustomElement } from \"../Element\";\r\n\r\nexport { HTMLESeparatorElement };\r\n\r\ninterface HTMLESeparatorElementConstructor {\r\n    prototype: HTMLESeparatorElement;\r\n    new(): HTMLESeparatorElement;\r\n}\r\n\r\ninterface HTMLESeparatorElement extends HTMLElement {}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-separator\": HTMLESeparatorElement,\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-separator\"\r\n})\r\nclass HTMLESeparatorElementBase extends HTMLElement implements HTMLESeparatorElement {\r\n    #internals: ElementInternals;\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                margin: 10px 0 10px 27px;\r\n                border: none;\r\n                border-top: 1px solid lightgrey;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.#internals = this.attachInternals();\r\n        this.#internals.role = \"separator\";\r\n    }\r\n}\r\n\r\nvar HTMLESeparatorElement: HTMLESeparatorElementConstructor = HTMLESeparatorElementBase;","import { CustomElement, AttributeProperty, element } from \"../Element\";\r\n\r\nexport { HTMLEToolTipElement };\r\n\r\ninterface HTMLEToolTipElementConstructor {\r\n    prototype: HTMLEToolTipElement;\r\n    new(): HTMLEToolTipElement;\r\n}\r\n\r\ninterface HTMLEToolTipElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly target: HTMLElement | null;\r\n    htmlFor: string;\r\n    position: \"top\" | \"bottom\" | \"right\" | \"left\";\r\n    visible: boolean;\r\n    show(options?: {immediate?: boolean}): void;\r\n    hide(options?: {immediate?: boolean}): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-tooltip\": HTMLEToolTipElement;\r\n    }\r\n}\r\n\r\nvar shadowTemplate: HTMLTemplateElement;\r\nvar style: string;\r\n\r\nvar HIDE_DELAY_MS = 100;\r\nvar SHOW_DELAY_MS = 200;\r\nvar ANIMATION_DURATION = 100;\r\n\r\n@CustomElement({\r\n    name: \"e-tooltip\"\r\n})\r\nclass HTMLEToolTipElementBase extends HTMLElement implements HTMLEToolTipElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get target(): HTMLElement | null {\r\n        return this.#target;\r\n    }\r\n\r\n    @AttributeProperty({type: String, observed: true, name: \"for\"})\r\n    htmlFor!: string;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"top\"})\r\n    position!: \"top\" | \"bottom\" | \"right\" | \"left\";\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    visible!: boolean;\r\n\r\n    #target: HTMLElement | null;\r\n    #targetListenerObject: EventListenerObject;\r\n    #documentListenerObject: EventListenerObject;\r\n    #toggleAnimation: Animation | null;\r\n\r\n    static {\r\n        shadowTemplate = element(\"template\");\r\n        shadowTemplate.content.append(\r\n            element(\"div\", {\r\n                attributes: {\r\n                    part: \"container\"\r\n                },\r\n                children: [\r\n                    element(\"span\", {\r\n                        attributes: {\r\n                            part: \"arrow\"\r\n                        }\r\n                    }),\r\n                    element(\"slot\")\r\n                ]\r\n            })\r\n        );\r\n        style = /*css*/`\r\n            :host {\r\n                display: inline-block;\r\n                position: fixed;\r\n                padding: 4px;\r\n                border-radius: 3px;\r\n                box-sizing: border-box;\r\n                background-color: white;\r\n                border: 1px solid black;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            :host([hidden]) {\r\n                display: none;\r\n            }\r\n\r\n            :host(:not([visible])) {\r\n                opacity: 0;\r\n            }\r\n            \r\n            [part=\"arrow\"] {\r\n                display: inline-block;\r\n                position: fixed;\r\n                z-index: 1;\r\n                width: 4px;\r\n                height: 4px;\r\n                box-sizing: border-box;\r\n                background-color: white;\r\n                border: 1px solid black;\r\n                border-width: 0 1px 1px 0;\r\n            }\r\n            \r\n            :host(:is(:not([position]), [position=\"top\"])) [part=\"arrow\"] {\r\n                transform: translate(-2px, -2px) rotate(45deg);\r\n            }\r\n            \r\n            :host(:is([position=\"bottom\"])) [part=\"arrow\"] {\r\n                transform: translate(-2px, -2px) rotate(225deg);\r\n            }\r\n            \r\n            :host(:is([position=\"left\"])) [part=\"arrow\"] {\r\n                transform: translate(-2px, -2px) rotate(315deg);\r\n            }\r\n            \r\n            :host(:is([position=\"right\"])) [part=\"arrow\"] {\r\n                transform: translate(-2px, -2px) rotate(135deg);\r\n            }        \r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        shadowRoot.append(\r\n            shadowTemplate.content.cloneNode(true)\r\n        );\r\n        this.#target = null;\r\n        this.#toggleAnimation = null;\r\n        this.#targetListenerObject = (function(tooltip) {\r\n            return {\r\n                handleEvent(event: Event) {\r\n                    const {type} = event;\r\n                    switch (type) {\r\n                        case \"mouseenter\": {\r\n                            tooltip.#handleTargetMouseEnterEvent();\r\n                            break;\r\n                        }\r\n                        case \"mouseleave\": {\r\n                            tooltip.#handleTargetMouseLeaveEvent();\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n        })(this);\r\n        this.#documentListenerObject = (function(tooltip) {\r\n            return {\r\n                handleEvent(event: Event) {\r\n                    const {type} = event;\r\n                    switch (type) {\r\n                        case \"keydown\": {\r\n                            tooltip.#handleDocumentKeyDownEvent(<KeyboardEvent>event);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n        })(this);\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        const {htmlFor} = this;\r\n        this.#setTarget(htmlFor);\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"for\": {\r\n                this.#setTarget(newValue);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    show(options?: {immediate?: boolean}): void {\r\n        const {immediate = false} = options ?? {};\r\n        let toggleAnimation = this.#toggleAnimation;\r\n        if (toggleAnimation !== null) {\r\n            const {id} = toggleAnimation;\r\n            if (id === \"hide\") {\r\n                toggleAnimation.cancel();\r\n            }\r\n        }\r\n        if (!this.visible) {\r\n            this.hidden = false;\r\n            toggleAnimation = this.animate([\r\n                { opacity: 0 },\r\n                { opacity: 1 }\r\n            ], {\r\n                id: \"show\",\r\n                delay: immediate ? 0 : SHOW_DELAY_MS,\r\n                duration: immediate ? 0 : ANIMATION_DURATION\r\n            });\r\n            const {finished} = toggleAnimation;\r\n            finished.then(\r\n                () => {\r\n                    this.visible = true;\r\n                }\r\n            );\r\n            this.#toggleAnimation = toggleAnimation;\r\n            this.#position();\r\n        }\r\n        else {\r\n            this.#toggleAnimation = null;\r\n        }\r\n    }\r\n\r\n    hide(options?: {immediate?: boolean}): void {\r\n        const {immediate = false} = options ?? {};\r\n        let toggleAnimation = this.#toggleAnimation;\r\n        if (toggleAnimation !== null) {\r\n            const {id} = toggleAnimation;\r\n            if (id === \"show\") {\r\n                toggleAnimation.cancel();\r\n            }\r\n        }\r\n        if (this.visible) {\r\n            toggleAnimation = this.animate([\r\n                { opacity: 1 },\r\n                { opacity: 0 }\r\n            ], {\r\n                id: \"hide\",\r\n                delay: immediate ? 0 : HIDE_DELAY_MS,\r\n                duration: immediate ? 0 : ANIMATION_DURATION\r\n            });\r\n            const {finished} = toggleAnimation;\r\n            finished.then(\r\n                () => {\r\n                    this.visible = false;\r\n                    this.hidden = true;\r\n                }\r\n            );\r\n            this.#toggleAnimation = toggleAnimation;\r\n        }\r\n        else {\r\n            this.#toggleAnimation = null;\r\n        }\r\n    }\r\n\r\n    #arrow(): HTMLElement {\r\n        return this.shadowRoot.querySelector<HTMLElement>(\"[part=arrow]\")!;\r\n    }\r\n\r\n    #setTarget(id: string | null): void {\r\n        const target = id ? document.getElementById(id) : null;\r\n        if (target !== null) {\r\n            const oldTarget = this.#target;\r\n            const targetListenerObject = this.#targetListenerObject;\r\n            if (oldTarget) {\r\n                oldTarget.removeEventListener(\"mouseenter\", targetListenerObject);\r\n                oldTarget.removeEventListener(\"mouseleave\", targetListenerObject);\r\n            }\r\n            target.addEventListener(\"mouseenter\", targetListenerObject);\r\n            target.addEventListener(\"mouseleave\", targetListenerObject);\r\n        }\r\n        this.#target = target;\r\n    }\r\n\r\n    #position(): void {\r\n        const target = this.#target;\r\n        if (target !== null) {\r\n            const {top: targetTop, bottom: targetBottom, left: targetLeft, right: targetRight} = target.getBoundingClientRect();\r\n            const {width: tooltipWidth, height: tooltipHeight} = this.getBoundingClientRect();\r\n            const tooltipHalfWidth = tooltipWidth / 2;\r\n            const tooltipHalfHeight = tooltipHeight / 2;\r\n            const targetCenter = (targetRight + targetLeft) / 2;\r\n            const targetMiddle = (targetBottom + targetTop) / 2;\r\n            const {position, style: tooltipStyle} = this;\r\n            const arrow = this.#arrow();\r\n            const {style: arrowStyle} = arrow;\r\n            const {width: arrowWidth, height: arrowHeight} = arrow.getBoundingClientRect();\r\n            const arrowHalfWidth = arrowWidth / 2;\r\n            const arrowHalfHeight = arrowHeight / 2;\r\n            const {clientWidth} = document.body;\r\n            switch (position) {\r\n                case \"top\": {\r\n                    tooltipStyle.setProperty(\"top\", `${targetTop - tooltipHeight - arrowHalfHeight}px`);\r\n                    tooltipStyle.setProperty(\"left\", `${\r\n                        Math.max(0, Math.min(targetCenter - tooltipHalfWidth, clientWidth - tooltipWidth))\r\n                    }px`);\r\n                    arrowStyle.setProperty(\"top\", `${targetTop - arrowHalfHeight}px`);\r\n                    arrowStyle.setProperty(\"left\", `${targetCenter}px`);\r\n                    break;\r\n                }\r\n                case \"bottom\": {\r\n                    tooltipStyle.setProperty(\"top\", `${targetBottom + arrowHalfHeight}px`);\r\n                    tooltipStyle.setProperty(\"left\", `${\r\n                        Math.max(0, Math.min(targetCenter - tooltipHalfWidth, clientWidth - tooltipWidth))\r\n                    }px`);\r\n                    arrowStyle.setProperty(\"top\", `${targetBottom + arrowHalfHeight}px`);\r\n                    arrowStyle.setProperty(\"left\", `${targetCenter}px`);\r\n                    break;\r\n                }\r\n                case \"left\": {\r\n                    tooltipStyle.setProperty(\"top\", `${targetMiddle - tooltipHalfHeight}px`);\r\n                    tooltipStyle.setProperty(\"left\", `${targetLeft - tooltipWidth - arrowHalfWidth}px`);\r\n                    arrowStyle.setProperty(\"top\", `${targetMiddle}px`);\r\n                    arrowStyle.setProperty(\"left\", `${targetLeft - arrowHalfWidth}px`);\r\n                    break;\r\n                }\r\n                case \"right\": {\r\n                    tooltipStyle.setProperty(\"top\", `${targetMiddle - tooltipHalfHeight}px`);\r\n                    tooltipStyle.setProperty(\"left\", `${targetRight + arrowHalfWidth}px`);\r\n                    arrowStyle.setProperty(\"top\", `${targetMiddle}px`);\r\n                    arrowStyle.setProperty(\"left\", `${targetRight + arrowHalfWidth}px`);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleTargetMouseEnterEvent(): void {\r\n        this.show();\r\n        const toggleAnimation = this.#toggleAnimation;\r\n        if (toggleAnimation) {\r\n            const documentListenerObject = this.#documentListenerObject;\r\n            const {finished} = toggleAnimation;\r\n            finished.then(() => {\r\n                document.addEventListener(\"keydown\", documentListenerObject);\r\n            });\r\n        }\r\n    }\r\n\r\n    #handleTargetMouseLeaveEvent(): void {\r\n        this.hide();\r\n        const toggleAnimation = this.#toggleAnimation;\r\n        if (toggleAnimation) {\r\n            const documentListenerObject = this.#documentListenerObject;\r\n            const {finished} = toggleAnimation;\r\n            finished.then(() => {\r\n                document.removeEventListener(\"keydown\", documentListenerObject);\r\n            });\r\n        }\r\n    }\r\n\r\n    #handleDocumentKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key} = event;\r\n        switch (key) {\r\n            case \"Escape\": {\r\n                this.hide({\r\n                    immediate: true\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar HTMLEToolTipElement: HTMLEToolTipElementConstructor = HTMLEToolTipElementBase;","import { CustomElement, AttributeProperty, element } from \"../Element\";\r\n\r\nexport { HTMLEWidthSashElement };\r\n\r\ninterface HTMLEWidthSashElementConstructor {\r\n    prototype: HTMLEWidthSashElement;\r\n    new(): HTMLEWidthSashElement;\r\n}\r\n\r\ninterface HTMLEWidthSashElement extends HTMLElement {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly target: HTMLElement | null;\r\n    controls: string;\r\n    growdir: \"right\" | \"left\";\r\n    max: boolean;\r\n    setWidth(width: number): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-wsash\": HTMLEWidthSashElement;\r\n    }\r\n    interface HTMLElementEventMap {\r\n        \"resize\": Event;\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-wsash\"\r\n})\r\nclass HTMLEWidthSashElementBase extends HTMLElement implements HTMLEWidthSashElement {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n\r\n    get target(): HTMLElement | null {\r\n        return this.#target;\r\n    }\r\n\r\n    @AttributeProperty({type: String, observed: true})\r\n    controls!: string;\r\n\r\n    @AttributeProperty({type: String, defaultValue: \"right\"})\r\n    growdir!: \"right\" | \"left\";\r\n\r\n    @AttributeProperty({type: Boolean})\r\n    max!: boolean;\r\n\r\n    #target: HTMLElement | null;\r\n    #onCapture: boolean;\r\n    #queuedPointerCallback: FrameRequestCallback | null;\r\n    #pointerMovement: number;\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n                background-color: var(--selected-item-color);\r\n                transition-property: opacity;\r\n                transition-delay: 0.2s;\r\n                transition-duration: 0.2s;\r\n                transition-timing-function: ease-out;\r\n                \r\n                width: 4px;\r\n                cursor: ew-resize;\r\n            }\r\n        `;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#target = null;\r\n        this.#queuedPointerCallback = null;\r\n        this.#pointerMovement = 0;\r\n        this.#onCapture = false;\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.addEventListener(\"pointerdown\", this.#handlePointerDownEvent.bind(this));\r\n        this.addEventListener(\"pointermove\", this.#handlePointerMoveEvent.bind(this));\r\n        this.addEventListener(\"pointerup\", this.#handlePointerUpEvent.bind(this));\r\n    }\r\n\r\n    setWidth(width: number): void {\r\n        const target = this.#target;\r\n        if (target !== null) {\r\n            const {max} = this;\r\n            const {style} = target;\r\n            style.setProperty(\"width\", `${width}px`);\r\n            if (max) {\r\n                style.setProperty(\"max-width\", `${width}px`);\r\n            }\r\n        }\r\n    }\r\n\r\n    #pointerMoveCallback(): void {\r\n        const target = this.#target;\r\n        if (target !== null) {\r\n            const targetComputedStyle = window.getComputedStyle(target);\r\n            const {growdir} = this;\r\n            const movementX = this.#pointerMovement;\r\n            const width = parseFloat(targetComputedStyle.getPropertyValue(\"width\"));\r\n            const newWidth = width + (growdir == \"right\" ? 1 : -1) * movementX;\r\n            this.setWidth(newWidth);\r\n            this.dispatchEvent(new Event(\"resize\"));\r\n        }\r\n        this.#pointerMovement = 0;\r\n        this.#queuedPointerCallback = null;\r\n    }\r\n\r\n    #handlePointerDownEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        const {controls} = this;\r\n        const rootNode = <ShadowRoot | Document>this.getRootNode();\r\n        this.#target = rootNode.getElementById(controls);\r\n        this.setPointerCapture(pointerId);\r\n        this.#onCapture = true;\r\n    }\r\n\r\n    #handlePointerMoveEvent(event: PointerEvent): void {\r\n        if (this.#onCapture) {\r\n            if (this.#queuedPointerCallback == null) {\r\n                this.#queuedPointerCallback = this.#pointerMoveCallback.bind(this);\r\n                requestAnimationFrame(this.#queuedPointerCallback);\r\n            }\r\n            this.#pointerMovement += event.movementX;\r\n        }\r\n    }\r\n\r\n    #handlePointerUpEvent(event: PointerEvent): void {\r\n        const {pointerId} = event;\r\n        this.releasePointerCapture(pointerId);\r\n        this.#onCapture = false;\r\n    }\r\n}\r\n\r\nvar HTMLEWidthSashElement: HTMLEWidthSashElementConstructor = HTMLEWidthSashElementBase;","export { ModelChangeRecord };\r\nexport { ModelEvent };\r\nexport { ModelNode };\r\nexport { ModelObject };\r\nexport { ModelProperty };\r\nexport { ModelList };\r\nexport { ModelChangeObserverOptions };\r\nexport { ModelChangeObserver };\r\n\r\ninterface ModelChangeRecordConstructor {\r\n    prototype: ModelChangeRecord;\r\n    new(\r\n        init: {\r\n            target: ModelNode | ModelList;\r\n            changeType: number;\r\n            propertyName?: string;\r\n            oldValue?: any;\r\n            newValue?: any;\r\n            removedIndex?: number,\r\n            removedItems?: ModelNode[],\r\n            insertedIndex?: number,\r\n            insertedItems?: ModelNode[],\r\n            sortedIndices?: number[]\r\n        }\r\n    ): ModelChangeRecord;\r\n    readonly PROPERTY_CHANGE: number;\r\n    readonly LIST_REMOVE: number;\r\n    readonly LIST_INSERT: number;\r\n    readonly LIST_SORT: number;\r\n}\r\n\r\ninterface ModelChangeRecord {\r\n    readonly target: ModelNode | ModelList\r\n    readonly propertyName: string | null;\r\n    readonly oldValue: any;\r\n    readonly newValue: any;\r\n    readonly changeType: number;\r\n    readonly removedIndex: number;\r\n    readonly removedItems: ModelNodesList;\r\n    readonly insertedIndex: number;\r\n    readonly insertedItems: ModelNodesList;\r\n    readonly sortedIndices: number[];\r\n    readonly PROPERTY_CHANGE: number;\r\n    readonly LIST_REMOVE: number;\r\n    readonly LIST_INSERT: number;\r\n    readonly LIST_SORT: number;\r\n}\r\n\r\nclass ModelChangeRecordBase implements ModelChangeRecord {\r\n    readonly target: ModelNode | ModelList;\r\n    readonly changeType: number;\r\n    readonly propertyName: string | null;\r\n    readonly oldValue: any;\r\n    readonly newValue: any;\r\n    readonly removedIndex: number;\r\n    readonly removedItems: ModelNodesList;\r\n    readonly insertedIndex: number;\r\n    readonly insertedItems: ModelNodesList;\r\n    readonly sortedIndices: number[];\r\n\r\n    constructor(\r\n        init: {\r\n            target: ModelNode | ModelList;\r\n            changeType: number;\r\n            propertyName?: string;\r\n            oldValue?: any;\r\n            newValue?: any;\r\n            removedIndex?: number,\r\n            removedItems?: ModelNode[],\r\n            insertedIndex?: number,\r\n            insertedItems?: ModelNode[],\r\n            sortedIndices?: number[]\r\n        }\r\n    ) {\r\n        this.target = init.target;\r\n        this.changeType = init.changeType;\r\n        this.propertyName = init.propertyName ?? null;\r\n        this.oldValue = init.oldValue ?? undefined;\r\n        this.newValue = init.newValue ?? undefined;\r\n        this.removedIndex = init.removedIndex ?? 0;\r\n        this.removedItems = new ModelNodesList(init.removedItems ?? []);\r\n        this.insertedIndex = init.insertedIndex ?? 0;\r\n        this.insertedItems = new ModelNodesList(init.insertedItems ?? []);\r\n        this.sortedIndices = init.sortedIndices ?? [];\r\n    }\r\n\r\n    static get PROPERTY_CHANGE(): number {\r\n        return 1;\r\n    }\r\n\r\n    static get LIST_REMOVE(): number {\r\n        return 2;\r\n    }\r\n\r\n    static get LIST_INSERT(): number {\r\n        return 3;\r\n    }\r\n\r\n    static get LIST_SORT(): number {\r\n        return 4;\r\n    }\r\n\r\n    get PROPERTY_CHANGE(): number {\r\n        return ModelChangeRecordBase.PROPERTY_CHANGE;\r\n    }\r\n\r\n    get LIST_REMOVE(): number {\r\n        return ModelChangeRecordBase.LIST_REMOVE;\r\n    }\r\n\r\n    get LIST_INSERT(): number {\r\n        return ModelChangeRecordBase.LIST_INSERT;\r\n    }\r\n\r\n    get LIST_SORT(): number {\r\n        return ModelChangeRecordBase.LIST_SORT;\r\n    }\r\n}\r\n\r\nvar ModelChangeRecord: ModelChangeRecordConstructor = ModelChangeRecordBase;\r\n\r\ninterface ModelNodesListConstructor {\r\n    prototype: ModelNodesList;\r\n    new(items: any[]): ModelNodesList;\r\n}\r\n\r\ninterface ModelNodesList {\r\n    get length(): number;\r\n    item(index: number): ModelNode | null;\r\n    values(): IterableIterator<ModelNode>;\r\n}\r\n\r\nclass ModelNodesListBase implements ModelNodesList {\r\n    #items: ModelNode[];\r\n\r\n    constructor(items: ModelNode[]) {\r\n        this.#items = items.slice();\r\n    }\r\n\r\n    get length(): number {\r\n        return this.#items.length;\r\n    }\r\n\r\n    item(index: number): ModelNode | null {\r\n        return this.#items[index] ?? null;\r\n    }\r\n\r\n    values(): IterableIterator<ModelNode> {\r\n        return this.#items.values();\r\n    }\r\n}\r\n\r\nvar ModelNodesList: ModelNodesListConstructor = ModelNodesListBase;\r\n\r\ninterface ModelEventConstructor {\r\n    prototype: ModelEvent;\r\n    new(type: string): ModelEvent;\r\n}\r\n\r\ninterface ModelEvent {\r\n    readonly type: string;\r\n    readonly currentTarget: ModelEventTarget | null;\r\n    readonly target: ModelEventTarget | null;\r\n}\r\n\r\nclass ModelEventBase implements ModelEvent {\r\n    readonly type: string;\r\n\r\n    #currentTarget: ModelEventTarget | null;\r\n    #target: ModelEventTarget | null;\r\n\r\n    constructor(type: string) {\r\n        this.type = type;\r\n        this.#currentTarget = null;\r\n        this.#target = null;\r\n    }\r\n\r\n    get currentTarget(): ModelEventTarget | null {\r\n        return this.#currentTarget;\r\n    }\r\n\r\n    get target(): ModelEventTarget | null {\r\n        return this.#target;\r\n    }\r\n\r\n    static ModelEventTargetAccessor? = new class ModelEventTargetAccessor {\r\n        setCurrentTarget(event: ModelEvent, currentTarget: ModelEventTarget): void {\r\n            if (event instanceof ModelEventBase) {\r\n                event.#currentTarget = currentTarget;\r\n            }\r\n        }\r\n\r\n        setTarget(event: ModelEvent, target: ModelEventTarget): void {\r\n            if (event instanceof ModelEventBase) {\r\n                event.#target = target;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\ninterface ModelEventTargetAccessor {\r\n    setCurrentTarget(event: ModelEvent, currentTarget: ModelEventTarget): void;\r\n    setTarget(event: ModelEvent, target: ModelEventTarget): void;\r\n}\r\n\r\nvar ModelEventTargetAccessor: ModelEventTargetAccessor = ModelEventBase.ModelEventTargetAccessor!;\r\ndelete ModelEventBase.ModelEventTargetAccessor;\r\n\r\nvar ModelEvent: ModelEventConstructor = ModelEventBase;\r\n\r\ninterface ModelEventTargetConstructor {\r\n    prototype: ModelEventTarget;\r\n    new(): ModelEventTarget;\r\n}\r\n\r\ninterface ModelEventTarget {\r\n    addEventListener(type: string, callback: (event: ModelEvent) => void): void;\r\n    removeEventListener(type: string, callback: (event: ModelEvent) => void): void;\r\n    dispatchEvent(event: ModelEvent): void;\r\n    receiveEvent(event: ModelEvent): void;\r\n}\r\n\r\nclass ModelEventTargetBase implements ModelEventTarget {\r\n    #callbacks: Map<string, ((event: ModelEvent) => void)[]>;\r\n\r\n    constructor() {\r\n        this.#callbacks = new Map();\r\n    }\r\n\r\n    receiveEvent(event: ModelEvent): void {\r\n        const {type} = event;\r\n        const callbacks = this.#callbacks.get(type);\r\n        ModelEventTargetAccessor.setCurrentTarget(event, this);\r\n        if (callbacks) {\r\n            callbacks.forEach((callback_i) => {\r\n                callback_i(event);\r\n            });\r\n        }\r\n    }\r\n\r\n    addEventListener(type: string, callback: (event: ModelEvent) => void): void {\r\n        const callbacks = this.#callbacks.get(type);\r\n        if (callbacks) {\r\n            callbacks.push(callback);\r\n        }\r\n        else {\r\n            this.#callbacks.set(type, [callback]);\r\n        }\r\n    }\r\n\r\n    removeEventListener(type: string, callback: (event: ModelEvent) => void): void {\r\n        const callbacks = this.#callbacks.get(type);\r\n        if (callbacks) {\r\n            const callbackIndex = callbacks.findIndex(\r\n                callback_i => callback_i == callback\r\n            );\r\n            if (callbackIndex > -1) {\r\n                callbacks.splice(callbackIndex, 1);\r\n            }\r\n            if (callbacks.length == 0) {\r\n                this.#callbacks.delete(type);\r\n            }\r\n        }\r\n    }\r\n\r\n    dispatchEvent(event: ModelEvent): void {\r\n        ModelEventTargetAccessor.setTarget(event, this);\r\n        this.receiveEvent(event);\r\n    }\r\n}\r\n\r\nvar ModelEventTarget: ModelEventTargetConstructor = ModelEventTargetBase;\r\n\r\ninterface ModelNodeConstructor {\r\n    prototype: ModelNode;\r\n    new(): ModelNode;\r\n}\r\n\r\ninterface ModelNode extends ModelEventTarget {\r\n    readonly parentNode: ModelNode | null;\r\n    setParent(parentNode: ModelNode | null): void;\r\n    getRecords(): ModelChangeRecord[];\r\n    beginChanges(): void;\r\n    endChanges(): void;\r\n}\r\n\r\ninterface ModelNodeRecordsAccessor {\r\n    triggerChange(node: ModelNode, property: string, oldValue: any, newValue: any): void;\r\n    handleRecord(node: ModelNode, record: ModelChangeRecord): void;\r\n}\r\n\r\nclass ModelNodeBase extends ModelEventTargetBase implements ModelNode {\r\n    #parentNode: ModelNode | null;\r\n    #records: ModelChangeRecord[];\r\n    #isRecording: boolean;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#parentNode = null;\r\n        this.#records = [];\r\n        this.#isRecording = false;\r\n    }\r\n\r\n    get parentNode(): ModelNode | null {\r\n        return this.#parentNode;\r\n    }\r\n\r\n    setParent(parentNode: ModelNode | null): void {\r\n        if (parentNode !== null) {\r\n            let isCyclicReference = parentNode == this;\r\n            let {parentNode: ancestorNode} = parentNode;\r\n            while (!isCyclicReference && ancestorNode !== null) {\r\n                ({parentNode: ancestorNode} = ancestorNode);\r\n                isCyclicReference = ancestorNode == this;\r\n            }\r\n            if (!isCyclicReference) {\r\n                this.#parentNode = parentNode;\r\n            }\r\n            else {\r\n                throw new TypeError(\"Failed to set parent on ModelNode: circular reference detected in the hierarchy.\");\r\n            }\r\n        }\r\n        else {\r\n            this.#parentNode = null;\r\n        }\r\n    }\r\n    \r\n    beginChanges(): void {\r\n        this.#isRecording = true;\r\n    }\r\n\r\n    endChanges(): void {\r\n        this.dispatchEvent(new ModelEvent(\"modelchange\"));\r\n        this.#records.splice(0);\r\n        this.#isRecording = false;\r\n    }\r\n\r\n    getRecords(): ModelChangeRecord[] {\r\n        return this.#records.slice();\r\n    }\r\n\r\n    receiveEvent(event: ModelEvent): void {\r\n        super.receiveEvent(event);\r\n        const {parentNode} = this;\r\n        if (parentNode) {\r\n            parentNode.receiveEvent(event);\r\n        }\r\n    }\r\n\r\n    #triggerChange(property: string, oldValue: any, newValue: any): void {\r\n        const records = this.#records;\r\n        const record = new ModelChangeRecord({\r\n            target: this,\r\n            changeType: ModelChangeRecord.PROPERTY_CHANGE,\r\n            propertyName: property,\r\n            oldValue, newValue\r\n        });\r\n        records.push(record);\r\n        if (!this.#isRecording) {\r\n            this.dispatchEvent(new ModelEvent(\"modelchange\"));\r\n            records.splice(0);\r\n        }\r\n    }\r\n\r\n    #handleRecord(record: ModelChangeRecord): void {\r\n        this.#records.push(record);\r\n        if (!this.#isRecording) {\r\n            this.dispatchEvent(new ModelEvent(\"modelchange\"));\r\n            this.#records.splice(0);\r\n        }\r\n    }\r\n\r\n    static ModelNodeRecordsAccessor? = new class ModelNodeRecordsAccessor {\r\n        triggerChange(node: ModelNode, property: string, oldValue: any, newValue: any): void {\r\n            if (node instanceof ModelNodeBase) {\r\n                node.#triggerChange(property, oldValue, newValue);\r\n            }\r\n        }\r\n\r\n        handleRecord(node: ModelNode, record: ModelChangeRecord): void {\r\n            if (node instanceof ModelNodeBase) {\r\n                node.#handleRecord(record);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar ModelNodeRecordsAccessor: ModelNodeRecordsAccessor = ModelNodeBase.ModelNodeRecordsAccessor!;\r\ndelete ModelNodeBase.ModelNodeRecordsAccessor;\r\n\r\nvar ModelNode: ModelNodeConstructor = ModelNodeBase;\r\n\r\ninterface ModelPropertyDecorator {\r\n    (): <Model extends ModelObject>(target: Model, property: string) => void;\r\n}\r\n\r\nconst ModelProperty: ModelPropertyDecorator = function() {\r\n    return (\r\n        target: ModelObject, property: string\r\n    ) => {\r\n        const {constructor} = target;\r\n        const {prototype} = constructor;\r\n        const setter = function(this: ModelObject, value: any) {\r\n            const oldValue = ModelObjectPropertiesAccessor.getProperty(this, property);\r\n            ModelObjectPropertiesAccessor.setProperty(this, property, value);\r\n            if (value !== oldValue) {\r\n                ModelNodeRecordsAccessor.triggerChange(this, property, oldValue, value);\r\n            }\r\n            return true;\r\n        };\r\n        const getter = function(this: ModelObject) {\r\n            return ModelObjectPropertiesAccessor.getProperty(this, property);\r\n        };\r\n        Object.defineProperty(prototype, property, {\r\n            set: setter,\r\n            get: getter,\r\n            enumerable: true\r\n        });\r\n    }\r\n}\r\n\r\ninterface ModelObjectConstructor {\r\n    prototype: ModelObject;\r\n    new(): ModelObject;\r\n}\r\n\r\ninterface ModelObject extends ModelNode {}\r\n\r\ninterface ModelObjectPropertiesAccessor {\r\n    setProperty(node: ModelNode, property: string, value: any): void;\r\n    getProperty(node: ModelNode, property: string,): any;\r\n}\r\n\r\nclass ModelObjectBase extends ModelNodeBase implements ModelObject {\r\n    #properties: Map<string, any>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#properties = new Map();\r\n    }\r\n\r\n    static ModelObjectPropertiesAccessor? = new class ModelPropertiesAccessor {\r\n        setProperty(node: ModelObject, property: string, value: any): void {\r\n            if (node instanceof ModelObjectBase) {\r\n                node.#properties.set(property, value);\r\n            }\r\n        }\r\n\r\n        getProperty(node: ModelObject, property: string): any {\r\n            if (node instanceof ModelObjectBase) {\r\n                return node.#properties.get(property);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar ModelObjectPropertiesAccessor: ModelObjectPropertiesAccessor = ModelObjectBase.ModelObjectPropertiesAccessor!;\r\ndelete ModelObjectBase.ModelObjectPropertiesAccessor;\r\n\r\nvar ModelObject: ModelObjectConstructor = ModelObjectBase;\r\n\r\ninterface ModelListConstructor {\r\n    prototype: ModelList;\r\n    new<Model extends ModelNode>(): ModelList<Model>;\r\n    new<Model extends ModelNode>(items: Model[]): ModelList<Model>;\r\n}\r\n\r\ninterface ModelList<Model extends ModelNode = ModelNode> extends ModelNode {\r\n    readonly parentNode: ModelNode | null;\r\n    readonly length: number;\r\n    index(item: Model): number;\r\n    get(index: number): Model | null;\r\n    values(): IterableIterator<Model>;\r\n    sort(compareFunction: (item_a: any, item_b: any) => number): void;\r\n    insert(index: number, ...items: Model[]): void;\r\n    prepend(...items: Model[]): void;\r\n    append(...items: Model[]): void;\r\n    remove(item: Model): void;\r\n    clear(): void;\r\n}\r\n\r\nclass ModelListBase<Model extends ModelNode = ModelNode> extends ModelNodeBase implements ModelList<Model> {\r\n    #items: Model[];\r\n\r\n    constructor()\r\n    constructor(items: Model[])\r\n    constructor(items?: Model[]) {\r\n        super();\r\n        this.#items = items?.slice() ?? [];\r\n    }\r\n\r\n    setParent(parentNode: ModelNode | null): void {\r\n        super.setParent(parentNode);\r\n        this.#items.forEach((item_i) => {\r\n            item_i.setParent(parentNode);\r\n        });\r\n    }\r\n\r\n    get length(): number {\r\n        return this.#items.length;\r\n    }\r\n\r\n    get(index: number): Model | null {\r\n        return this.#items[index] ?? null;\r\n    }\r\n\r\n    index(item: Model): number {\r\n        return this.#items.indexOf(item);\r\n    }\r\n\r\n    values(): IterableIterator<Model> {\r\n        return this.#items.values();\r\n    }\r\n\r\n    sort(compareFunction: (item_a: any, item_b: any) => number): void {\r\n        const items = this.#items;\r\n        const indexedItems = items.map(\r\n            (item_i, i) => {\r\n                return {\r\n                    item: item_i,\r\n                    index: i\r\n                };\r\n            }\r\n        );\r\n        indexedItems.sort(\r\n            (indexedItem_a, indexedItem_b) => {\r\n                return compareFunction(\r\n                    indexedItem_a.item, indexedItem_b.item\r\n                )\r\n            }\r\n        );\r\n        this.#items = indexedItems.map(indexedItem_i => indexedItem_i.item);\r\n        const record = new ModelChangeRecord({\r\n            target: this,\r\n            changeType: ModelChangeRecord.LIST_SORT,\r\n            sortedIndices: indexedItems.map(indexedItem_i => indexedItem_i.index)\r\n        });\r\n        ModelNodeRecordsAccessor.handleRecord(this, record);\r\n    }\r\n\r\n    prepend(...items: Model[]): void {\r\n        const _items = this.#items;\r\n        const {parentNode} = this;\r\n        if (parentNode) {\r\n            items.forEach(item_i => {\r\n                item_i.setParent(parentNode);\r\n            });\r\n        }\r\n        _items.splice(0, 0, ...items);\r\n        const record = new ModelChangeRecord({\r\n            target: this,\r\n            changeType: ModelChangeRecord.LIST_INSERT,\r\n            insertedIndex: 0,\r\n            insertedItems: items\r\n        });\r\n        ModelNodeRecordsAccessor.handleRecord(this, record);\r\n    }\r\n\r\n    append(...items: Model[]): void {\r\n        const _items = this.#items;\r\n        const {length} = _items;\r\n        const {parentNode} = this;\r\n        if (parentNode) {\r\n            items.forEach(item_i => {\r\n                item_i.setParent(parentNode);\r\n            });\r\n        }\r\n        _items.push(...items);\r\n        const record = new ModelChangeRecord({\r\n            target: this,\r\n            changeType: ModelChangeRecord.LIST_INSERT,\r\n            insertedIndex: length,\r\n            insertedItems: items\r\n        });\r\n        ModelNodeRecordsAccessor.handleRecord(this, record);\r\n    }\r\n\r\n    insert(index: number, ...items: Model[]): void {\r\n        const _items = this.#items;\r\n        const {length} = _items;\r\n        const positiveIndex = Math.abs(index);\r\n        if (positiveIndex <= length) {\r\n            if (index >= 0) {\r\n                const {parentNode} = this;\r\n                items.forEach(item_i => {\r\n                    item_i.setParent(parentNode);\r\n                });\r\n                if (index < length) {\r\n                    _items.splice(index, 0, ...items);\r\n                }\r\n                else {\r\n                    _items.push(...items);\r\n                }\r\n            }\r\n            else if (index < 0) {\r\n                index = length - index;\r\n                const {parentNode} = this;\r\n                if (parentNode) {\r\n                    items.forEach(item_i => {\r\n                        item_i.setParent(parentNode);\r\n                    });\r\n                }\r\n                _items.splice(index, 0, ...items);\r\n            }\r\n            const record = new ModelChangeRecord({\r\n                target: this,\r\n                changeType: ModelChangeRecord.LIST_INSERT,\r\n                insertedIndex: index,\r\n                insertedItems: items.slice()\r\n            });\r\n            ModelNodeRecordsAccessor.handleRecord(this, record);\r\n        }\r\n    }\r\n\r\n    remove(item: Model): void {\r\n        const _items = this.#items;\r\n        const index = _items.indexOf(item);\r\n        if (index > -1) {\r\n            const item = _items.splice(index, 1)[0];\r\n            const {parentNode} = this;\r\n            if (parentNode) {\r\n                item.setParent(null);\r\n            }\r\n            const record = new ModelChangeRecord({\r\n                target: this,\r\n                changeType: ModelChangeRecord.LIST_REMOVE,\r\n                removedIndex: index,\r\n                removedItems: [item]\r\n            });\r\n            ModelNodeRecordsAccessor.handleRecord(this, record);\r\n        }\r\n    }\r\n\r\n    clear(): void {\r\n        const items = this.#items;\r\n        const {length} = items;\r\n        if (length > 0) {\r\n            const removedItems = items.splice(0);\r\n            const {parentNode} = this;\r\n            if (parentNode) {\r\n                removedItems.forEach((removedItem_i) => {\r\n                    removedItem_i.setParent(null);\r\n                });\r\n            }\r\n            const record = new ModelChangeRecord({\r\n                target: this,\r\n                changeType: ModelChangeRecord.LIST_REMOVE,\r\n                removedIndex: 0,\r\n                removedItems: removedItems\r\n            });\r\n            ModelNodeRecordsAccessor.handleRecord(this, record);\r\n        }\r\n    }\r\n};\r\n\r\nvar ModelList: ModelListConstructor = ModelListBase!;\r\n\r\ninterface ModelChangeObserverConstructor {\r\n    prototype: ModelChangeObserver;\r\n    new(callback: (records: ModelChangeRecord[]) => void): ModelChangeObserver;\r\n}\r\n\r\ninterface ModelChangeObserver {\r\n    observe(node: ModelNode, options: ModelChangeObserverOptions): void;\r\n    unobserve(node: ModelNode): void;\r\n    disconnect(): void;\r\n}\r\n\r\ntype ModelChangeObserverOptions = {\r\n    properties?: boolean;\r\n    propertiesFilter?: string[];\r\n    childList?: boolean;\r\n    subtree?: boolean;\r\n}\r\n\r\nclass ModelChangeObserverBase implements ModelChangeObserver {\r\n    #callback: (records: ModelChangeRecord[]) => void;\r\n    #records: ModelChangeRecord[];\r\n    #disconnected: boolean;\r\n\r\n    #references: WeakMap<ModelNode, {\r\n        listener: (event: ModelEvent) => void,\r\n        options: ModelChangeObserverOptions\r\n    }>;\r\n\r\n    constructor(callback: (records: ModelChangeRecord[]) => void) {\r\n        this.#callback = callback;\r\n        this.#records = [];\r\n        this.#disconnected = false;\r\n        this.#references = new WeakMap();\r\n    }\r\n\r\n    observe(node: ModelNode, options: ModelChangeObserverOptions): void {\r\n        this.#disconnected = false;\r\n        const references = this.#references;\r\n        let reference = references.get(node);\r\n        if (!reference) {\r\n            const listener = this.#handleModelEvent.bind(this);\r\n            node.addEventListener(\"modelchange\", listener);\r\n            reference = {listener, options};\r\n            references.set(node, reference);\r\n        }\r\n        else {\r\n            references.set(node, reference);\r\n        }\r\n    }\r\n\r\n    unobserve(node: ModelNode): void {\r\n        const references = this.#references;\r\n        let reference = references.get(node);\r\n        if (reference) {\r\n            const {listener} = reference;\r\n            node.removeEventListener(\"modelchange\", listener);\r\n        }\r\n    }\r\n\r\n    disconnect(): void {\r\n        this.#records.splice(0);\r\n        this.#disconnected = true;\r\n    }\r\n\r\n    #trigger(): void {\r\n        const records = this.#records.splice(0);\r\n        if (records.length > 0) {\r\n            this.#callback(records);\r\n        }\r\n    }\r\n\r\n    #handleModelEvent(event: ModelEvent): void {\r\n        if (!this.#disconnected) {\r\n            const {target, currentTarget} = event;\r\n            const reference = this.#references.get(<ModelNode>currentTarget);\r\n            if (reference) {\r\n                const {options} = reference;\r\n                const {properties, propertiesFilter, childList, subtree} = options;\r\n                if (subtree) {\r\n                    if (properties && target instanceof ModelNode) {\r\n                        if (propertiesFilter) {\r\n                            this.#records.push(\r\n                                ...target.getRecords()\r\n                                    .filter(record_i => {\r\n                                        const {propertyName} = record_i;\r\n                                        return propertiesFilter.includes(\r\n                                            propertyName!\r\n                                        )\r\n                                    })\r\n                            );\r\n                        }\r\n                        else {\r\n                            this.#records.push(\r\n                                ...target.getRecords()\r\n                            );\r\n                        }\r\n                        this.#trigger();\r\n                    }\r\n                    else if (childList && target instanceof ModelList) {\r\n                        this.#records.push(\r\n                            ...target.getRecords()\r\n                        );\r\n                        this.#trigger();\r\n                    }\r\n                }\r\n                else if (target == currentTarget) {\r\n                    if (properties && target instanceof ModelNode) {\r\n                        if (propertiesFilter) {\r\n                            this.#records.push(\r\n                                ...target.getRecords()\r\n                                    .filter(record_i => {\r\n                                        const {propertyName} = record_i;\r\n                                        return propertiesFilter.includes(\r\n                                            propertyName!\r\n                                        )\r\n                                    })\r\n                            );\r\n                        }\r\n                        else {\r\n                            this.#records.push(\r\n                                ...target.getRecords()\r\n                            );\r\n                        }\r\n                        this.#trigger();\r\n                    }\r\n                    else if (childList && target instanceof ModelList) {\r\n                        this.#records.push(\r\n                            ...target.getRecords()\r\n                        );\r\n                        this.#trigger();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar ModelChangeObserver: ModelChangeObserverConstructor = ModelChangeObserverBase;","export { NodeCollection };\r\n\r\ninterface NodeCollectionConstructor {\r\n    prototype: NodeCollection;\r\n    new(root: Node, filter: NodeFilter): NodeCollection<Node>;\r\n    new<N extends Node>(root: Node, filter: NodeFilter): NodeCollection<N>;\r\n}\r\n\r\ninterface NodeCollection<N extends Node = Node> {\r\n    readonly root: Node;\r\n    readonly filter: NodeFilter;\r\n    readonly length: number;\r\n    item(index: number): N | undefined;\r\n    values(): IterableIterator<N>;\r\n}\r\n\r\nclass NodeCollectionBase<N extends Node = Node> {\r\n    #root: Node;\r\n    #filter: NodeFilter;\r\n    #observer: MutationObserver;\r\n    #observerTargets: Node[];\r\n\r\n    #items: N[];\r\n\r\n    constructor(root: Node, filter: NodeFilter) {\r\n        this.#root = root;\r\n        this.#filter = filter;\r\n        this.#items = [];\r\n        this.#observer = new MutationObserver(\r\n            this.#handleMutationRecords.bind(this)\r\n        );\r\n        this.#observerTargets = [root];\r\n        this.#observer.observe(root, {\r\n            childList: true\r\n        });\r\n        this.#handleAddedNodes(root.childNodes);\r\n    }\r\n\r\n    get root() {\r\n        return this.#root;\r\n    }\r\n\r\n    get filter() {\r\n        return this.#filter;\r\n    }\r\n\r\n    get length() {\r\n        return this.#update(), this.#items.length;\r\n    }\r\n\r\n    item(index: number): N | undefined {\r\n        return this.#update(), this.#items[index];\r\n    }\r\n\r\n    values(): IterableIterator<N> {\r\n        return this.#update(), this.#items.values();\r\n    }\r\n\r\n    #update(): void {\r\n        const records = this.#observer.takeRecords();\r\n        if (records.length > 0) {\r\n            this.#handleMutationRecords(records);\r\n        }\r\n    }\r\n\r\n    #addObserverTargets(targets: Node[]): void {\r\n        const observer = this.#observer;\r\n        observer.disconnect();\r\n        this.#observerTargets.push(...targets);\r\n        this.#observerTargets.forEach((group_i) => {\r\n            observer.observe(group_i, {\r\n                childList: true\r\n            });\r\n        });\r\n    }\r\n\r\n    #removeObserverTargets(targets: Node[]): void {\r\n        const observer = this.#observer;\r\n        observer.disconnect();\r\n        this.#observerTargets = this.#observerTargets.filter(target_i => !targets.includes(target_i));\r\n        this.#observerTargets.forEach((group_i) => {\r\n            observer.observe(group_i, {\r\n                childList: true\r\n            });\r\n        });\r\n    }\r\n\r\n    #handleAddedNodes(nodes: NodeList): void {\r\n        if (nodes.length > 0) {\r\n            const filter = this.#filter;\r\n            const acceptNode = typeof filter === \"function\" ? filter : filter.acceptNode;\r\n            const addedItems = <N[]>[];\r\n            const addedObserverTargets = <Node[]>[];\r\n            nodes.forEach((node: Node) => {\r\n                const acceptNodeResult = acceptNode(node);\r\n                switch (acceptNodeResult) {\r\n                    case NodeFilter.FILTER_ACCEPT: {\r\n                        addedItems.push(<N>node);\r\n                        break;\r\n                    }\r\n                    case NodeFilter.FILTER_SKIP: {\r\n                        addedObserverTargets.push(node);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            if (addedObserverTargets.length > 0) {\r\n                this.#addObserverTargets(addedObserverTargets);\r\n                addedObserverTargets.forEach((target_i) => {\r\n                    this.#handleAddedNodes(target_i.childNodes);\r\n                });\r\n            }\r\n            if (addedItems.length > 0) {\r\n                addedItems.forEach((item_i) => {\r\n                    const index = this.#items.findIndex(\r\n                        item_i => item_i.compareDocumentPosition(item_i) & Node.DOCUMENT_POSITION_FOLLOWING\r\n                    );\r\n                    this.#items.splice(index > -1 ? index : 0, 0, item_i);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleRemovedNodes(nodes: NodeList): void {\r\n        if (nodes.length > 0) {\r\n            const filter = this.#filter;\r\n            const acceptNode = typeof filter === \"function\" ? filter : filter.acceptNode;\r\n            const removedItems = <N[]>[];\r\n            const removedObserverTargets = <Node[]>[];\r\n            nodes.forEach((node: Node) => {\r\n                const acceptNodeResult = acceptNode(node);\r\n                switch (acceptNodeResult) {\r\n                    case NodeFilter.FILTER_ACCEPT: {\r\n                        removedItems.push(<N>node);\r\n                        break;\r\n                    }\r\n                    case NodeFilter.FILTER_SKIP: {\r\n                        removedObserverTargets.push(node);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            if (removedObserverTargets.length > 0) {\r\n                this.#removeObserverTargets(removedObserverTargets);\r\n                removedObserverTargets.forEach((target_i) => {\r\n                    this.#handleRemovedNodes(target_i.childNodes);\r\n                });\r\n            }\r\n            if (removedItems.length > 0) {\r\n                this.#items = this.#items.filter(item_i => !removedItems.includes(item_i));\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMutationRecords(mutationsList: MutationRecord[]) {\r\n        mutationsList.forEach((mutation: MutationRecord) => {\r\n            const {addedNodes, removedNodes} = mutation;\r\n            this.#handleRemovedNodes(removedNodes);\r\n            this.#handleAddedNodes(addedNodes);\r\n        });\r\n    }\r\n}\r\n\r\nvar NodeCollection: NodeCollectionConstructor = NodeCollectionBase;","import * as arrowRight from \"../../assets/arrow_right_FILL0_wght400_GRAD0_opsz48.svg\";\r\nimport * as arrowDropDown from \"../../assets/arrow_drop_down_FILL0_wght400_GRAD0_opsz48.svg\";\r\nimport * as arrowDropUp from \"../../assets/arrow_drop_up_FILL0_wght400_GRAD0_opsz48.svg\";\r\n\r\nexport { themeStylesheet };\r\n\r\nconst themeStylesheet = new CSSStyleSheet();\r\nthemeStylesheet.replace(/*css*/`\r\n    :root {\r\n        --font-color: black;\r\n        \r\n        --icon-size: 18px;\r\n\r\n        --line-height: 18px;\r\n        --padded-line-height: 22px;\r\n\r\n        --menu-box-shadow: rgba(0, 0, 0, 0.2) 0 1px 3px;\r\n\r\n        --primary-color: white;\r\n        --secondary-color: white;\r\n\r\n        --text-color: white;\r\n        --text-darker-color: white;\r\n        --text-lighter-color: white;\r\n\r\n        --content-background-color: white;\r\n        --item-border-color: grey;\r\n        --section-border-color: lightgrey;\r\n        --padding-background-color: gainsboro;\r\n\r\n        --accent-color: hsl(212, 100%, 50%);\r\n        --hovered-item-color: hsl(203, 92%, 80%, 50%);\r\n        --focused-item-color: hsl(203, 92%, 50%, 50%);\r\n        --focused-item-outline-color: hsl(203, 92%, 50%);\r\n        --selected-item-color: hsl(203, 92%, 75%, 75%);\r\n        --activated-item-color: hsl(203, 92%, 50%, 50%);\r\n        --droptarget-item-color: hsl(203, 92%, 50%, 50%);\r\n\r\n        --arrow-color: var(--font-color);\r\n        --arrow-icon-collapsed: url(${arrowRight});\r\n        --arrow-icon-expanded: url(${arrowDropDown});\r\n\r\n        --sortorder-indicator-color: var(--font-color);\r\n        --sortorder-indicator-ascending: url(${arrowDropUp});\r\n        --sortorder-indicator-descending: url(${arrowDropDown});\r\n    }\r\n`);","import { element, reactiveChildElements, CustomElement, fragment, AttributeProperty, reactiveElement } from \"../elements/Element\";\r\nimport { ModelList, ModelObject, ModelProperty } from \"../models/Model\";\r\nimport { View } from \"./View\";\r\nimport { HTMLEGridCellElement } from \"../elements/containers/grid/GridCell\";\r\nimport { HTMLEGridElement } from \"../elements/containers/grid/Grid\";\r\nimport { HTMLEGridRowElement } from \"../elements/containers/grid/GridRow\";\r\n\r\nexport { GridModel };\r\nexport { GridRowModel };\r\nexport { GridColumnModel };\r\nexport { GridView };\r\n\r\ninterface GridInit {\r\n    rows: GridRowModel[];\r\n    columns: GridColumnModel[];\r\n}\r\n\r\nclass GridModel extends ModelObject {\r\n    readonly rows: ModelList<GridRowModel>;\r\n    readonly columns: ModelList<GridColumnModel>;\r\n\r\n    constructor()\r\n    constructor(init: GridInit)\r\n    constructor(init?: GridInit) {\r\n        super();\r\n        const {rows: initRows = [], columns: initColumns = []} = init ?? {};\r\n        const rows = new ModelList(initRows);\r\n        rows.setParent(this);\r\n        this.rows = rows;\r\n        const columns = new ModelList(initColumns);\r\n        columns.setParent(this);\r\n        this.columns = columns;\r\n    }\r\n\r\n    getColumnByName(name: string): GridColumnModel | null {\r\n        return Array.from(this.columns.values()).find(\r\n            column_i => column_i.name == name\r\n        ) ?? null;\r\n    }\r\n\r\n    sortByColumn(column: GridColumnModel, sortOrder: number) {\r\n        Array.from(this.columns.values()).forEach((column_i) => {\r\n            column_i.sortorder = column_i === column ? sortOrder : undefined;\r\n        });\r\n        const sortTest = (() => {\r\n            const {type} = column;\r\n            switch (type) {\r\n                case String: {\r\n                    return (row_1: GridRowModel, row_2: GridRowModel) => {\r\n                        const cell_1 = String(column.extract(row_1));\r\n                        const cell_2 = String(column.extract(row_2));\r\n                        return sortOrder * cell_1.localeCompare(cell_2);\r\n                    };\r\n                }\r\n                default: {\r\n                    return (row_1: GridRowModel, row_2: GridRowModel) => {\r\n                        const cell_1 = Number(column.extract(row_1));\r\n                        const cell_2 = Number(column.extract(row_2));\r\n                        return Math.sign(sortOrder * (cell_1 - cell_2));\r\n                    };\r\n                }\r\n            }\r\n        })();\r\n        this.rows.sort(sortTest);\r\n    }\r\n}\r\n\r\n\r\ntype GridRowFilter = {\r\n    filter: (row: GridRowModel) => boolean;\r\n}\r\n\r\ninterface GridColumnInit {\r\n    name: string,\r\n    type: NumberConstructor | StringConstructor | DateConstructor,\r\n    label: string,\r\n    extract: (row: GridRowModel) => string,\r\n    filters?: (GridRowFilter & {name: string})[]\r\n}\r\n\r\nclass GridColumnModel extends ModelObject {\r\n    readonly name: string\r\n    readonly type: NumberConstructor | StringConstructor | DateConstructor;\r\n    readonly label: string;\r\n    readonly extract: (row: GridRowModel) => string;\r\n    readonly filters: (GridRowFilter & {name: string})[];\r\n\r\n    @ModelProperty()\r\n    sortorder: number | undefined;\r\n\r\n    constructor(init: GridColumnInit) {\r\n        super();\r\n        const {name, type, label, extract, filters = []} = init;\r\n        this.name = name;\r\n        this.type = type;\r\n        this.label = label;\r\n        this.extract = extract;\r\n        this.filters = filters;\r\n    }\r\n}\r\n\r\nclass GridRowModel extends ModelObject {\r\n    id: number;\r\n\r\n    @ModelProperty()\r\n    name: string;\r\n\r\n    @ModelProperty()\r\n    age: number;\r\n    \r\n    constructor(init: {\r\n        id: number;\r\n        name: string,\r\n        age: number\r\n    }) {\r\n        super();\r\n        const {id, name, age} = init;\r\n        this.id = id;\r\n        this.name = name;\r\n        this.age = age;\r\n    }\r\n}\r\n\r\ninterface GridViewConstructor {\r\n    prototype: GridView;\r\n    new(): GridView;\r\n    new(model: GridModel): GridView;\r\n}\r\n\r\ninterface GridView extends View {\r\n    readonly shadowRoot: ShadowRoot;\r\n    model: GridModel;\r\n    resizable: boolean;\r\n    sortable: boolean;\r\n    setColumnDelegate(delegate: (column: GridColumnModel) => string | Node): void;\r\n    setCellDelegate(delegate: (row: GridRowModel, column: GridColumnModel) => string | Node): void;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-gridview\": GridView,\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-gridview\"\r\n})\r\nclass GridViewBase extends View implements GridView {\r\n\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly model!: GridModel;\r\n\r\n    #columnDelegate: (column: GridColumnModel) => string | Node;\r\n    #cellDelegate: (row: GridRowModel, column: GridColumnModel) => string | Node;\r\n    \r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    resizable!: boolean;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    sortable!: boolean;\r\n\r\n    #displayFilters: (GridRowFilter & {name: string})[];\r\n    #searchFilter: GridRowFilter | null;\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n            \r\n            e-gridrow[hidden] {\r\n                display: none;\r\n            }\r\n            \r\n            e-gridcell[type=\"gridcell\"] {\r\n                max-width: 0;\r\n            \r\n                overflow: clip;\r\n                text-overflow: ellipsis;\r\n                white-space: nowrap;\r\n            }\r\n            \r\n            e-gridcell[type=\"columnheader\"] {\r\n                width: 120px;\r\n            }\r\n            \r\n            .gridcell-label,\r\n            .gridheader-label {\r\n                padding-left: 4px;\r\n            }\r\n            \r\n            .gridcell-content {\r\n                overflow: clip;\r\n            }\r\n            \r\n            .gridheader-content {\r\n                display: flex;\r\n            }\r\n            \r\n            .gridheader-label {\r\n                flex: 1 1 0;\r\n                overflow: clip;\r\n                text-overflow: ellipsis;\r\n                white-space: nowrap;\r\n            }\r\n            \r\n            e-treeitem::part(arrow) {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px 4px 1px 1px;\r\n            }\r\n            \r\n            .gridheader-sort-indicator {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n            }\r\n            \r\n            .gridheader-sort-indicator::before {\r\n                display: inline-block;\r\n                width: 18px;\r\n                height: 18px;\r\n                margin: 1px;\r\n                content: \"\";\r\n                mask-size: 18px 18px;\r\n                -webkit-mask-size: 18px 18px;\r\n                background-color: var(--sortorder-indicator-color, none);\r\n            }\r\n            \r\n            e-gridcell[type=\"columnheader\"]:not([data-sortorder]) .gridheader-sort-indicator::before {\r\n                background-color: unset;\r\n            }\r\n            \r\n            e-gridcell[type=\"columnheader\"][data-sortorder=\"1\"] .gridheader-sort-indicator::before {\r\n                -webkit-mask-image: var(--sortorder-indicator-ascending, none);\r\n                mask-image: var(--sortorder-indicator-ascending, none);\r\n            }\r\n            \r\n            e-gridcell[type=\"columnheader\"][data-sortorder=\"-1\"] .gridheader-sort-indicator::before {\r\n                -webkit-mask-image: var(--sortorder-indicator-descending, none);\r\n                mask-image: var(--sortorder-indicator-descending, none);\r\n            }\r\n            \r\n            e-gridhead e-wsash:not(:hover) {\r\n                flex: 0 0 auto;\r\n                width: 2px;\r\n                margin-right: 1px;\r\n                margin-left: 1px;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor()\r\n    constructor(model: GridModel)\r\n    constructor(model?: GridModel) {\r\n        super();\r\n        this.#displayFilters = [];\r\n        this.#searchFilter = null;\r\n        this.#cellDelegate =\r\n            (row: GridRowModel, column: GridColumnModel) =>\r\n                element(\"label\", {\r\n                    children: column.extract(row)\r\n                });\r\n        this.#columnDelegate =\r\n            (column: GridColumnModel) =>\r\n                element(\"label\", {\r\n                    children: column.label\r\n                });\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.setModel(model ?? new GridModel());\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"resizable\":\r\n            case \"sortable\": {\r\n                this.render();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    get gridElement(): HTMLEGridElement {\r\n        return this.shadowRoot.querySelector(\"e-grid\")!;\r\n    }\r\n\r\n    setColumnDelegate(delegate: (column: GridColumnModel) => string | Node): void {\r\n        this.#columnDelegate = delegate;\r\n    }\r\n\r\n    setCellDelegate(delegate: (row: GridRowModel, column: GridColumnModel) => string | Node): void {\r\n        this.#cellDelegate = delegate;\r\n    }\r\n\r\n    getRowElement(row: GridRowModel): HTMLEGridRowElement | null {\r\n        return this.shadowRoot.querySelector(`e-grid > e-gridbody > e-gridrow[data-index='${row.id}']`);\r\n    }\r\n\r\n    getColumnHeaderElement(column: GridColumnModel): HTMLEGridCellElement | null {\r\n        return this.shadowRoot.querySelector(`e-grid > e-gridhead > e-gridcell[id=${column.name}]`);\r\n    }\r\n    \r\n    getColumnCellsElements(column: GridColumnModel): HTMLEGridCellElement[] {\r\n        return Array.from(this.shadowRoot.querySelectorAll(`e-grid > e-gridbody > e-gridrow > e-gridcell[headers~=${column.name}]`));\r\n    }\r\n\r\n    renderShadow(): Node {\r\n        const {model} = this;\r\n        return fragment(\r\n            element(\"link\", {\r\n                attributes: {\r\n                    rel: \"stylesheet\",\r\n                    href: \"/css/main.css\"\r\n                }\r\n            }),\r\n            element(\"div\", {\r\n                children: element(\"input\", {\r\n                    attributes: {\r\n                        type: \"search\"\r\n                    },\r\n                    listeners: {\r\n                        input: <EventListener>this.#handleSearchInputEvent.bind(this)\r\n                    }\r\n                })\r\n            }),\r\n            element(\"e-grid\", {\r\n                attributes: {\r\n                    tabindex: 0,\r\n                    selectby: \"row\",\r\n                    multisectable: true\r\n                },\r\n                children: [\r\n                    element(\"e-gridhead\", {\r\n                        children: reactiveChildElements(\r\n                            model.columns, column => this.#renderGridColumnHeaderCell(column)\r\n                        ),\r\n                        listeners: {\r\n                            contextmenu: <EventListener>this.#handleHeadContextMenuEvent.bind(this),\r\n                            click: <EventListener>this.#handleHeadClickEvent.bind(this)\r\n                        }\r\n                    }),\r\n                    element(\"e-gridbody\", {\r\n                        children: reactiveChildElements(\r\n                            model.rows, row => this.#renderGridBodyRow(row)\r\n                        )\r\n                    })\r\n                ]\r\n            })\r\n        );\r\n    }\r\n\r\n    #filter(row: GridRowModel): boolean {\r\n        const displayFilters = this.#displayFilters;\r\n        const searchFilter = this.#searchFilter;\r\n        return (displayFilters.length > 0 ? displayFilters.some(filter_i => filter_i.filter(row)) : true) &&\r\n        (searchFilter ? searchFilter.filter(row) : true);\r\n    }\r\n\r\n    setSearchFilter(filter: GridRowFilter | null): void {\r\n        const {model, gridElement} = this;\r\n        const {rows} = model;\r\n        this.#searchFilter = filter;\r\n        Array.from(rows.values()).forEach((row_i) => {\r\n            const rowElement = this.getRowElement(row_i);\r\n            if (rowElement) {\r\n                rowElement.hidden = !this.#filter(row_i);\r\n            }\r\n        });\r\n        gridElement.clearSelection();\r\n    }\r\n\r\n    addDisplayFilter(filter: (GridRowFilter & {name: string;})): void {\r\n        const {model, gridElement} = this;\r\n        const {rows} = model;\r\n        const displayFilters = this.#displayFilters;\r\n        if (!displayFilters.includes(filter)) {\r\n            displayFilters.push(filter);\r\n            Array.from(rows.values()).forEach((row_i) => {\r\n                const rowElement = this.getRowElement(row_i);\r\n                if (rowElement) {\r\n                    rowElement.hidden = !this.#filter(row_i);\r\n                }\r\n            });\r\n        }\r\n        gridElement.clearSelection();\r\n    }\r\n\r\n    removeDisplayFilter(filter: (GridRowFilter & {name: string;})): void {\r\n        const {model, gridElement} = this;\r\n        const {rows} = model;\r\n        const displayFilters = this.#displayFilters;\r\n        const filterIndex = displayFilters.indexOf(filter);\r\n        if (filterIndex > -1) {\r\n            displayFilters.splice(filterIndex, 1);\r\n            Array.from(rows.values()).forEach((row_i) => {\r\n                const rowElement = this.getRowElement(row_i);\r\n                if (rowElement) {\r\n                    rowElement.hidden = !this.#filter(row_i);\r\n                }\r\n            });\r\n        }\r\n        gridElement.clearSelection();\r\n    }\r\n\r\n    removeAllDisplayFilters(): void {\r\n        const {model, gridElement} = this;\r\n        const {rows} = model;\r\n        const displayFilters = this.#displayFilters;\r\n        displayFilters.splice(0, displayFilters.length);\r\n        Array.from(rows.values()).forEach((row_i) => {\r\n            const rowElement = this.getRowElement(row_i);\r\n            if (rowElement) {\r\n                rowElement.hidden = !this.#filter(row_i);\r\n            }\r\n        });\r\n        gridElement.clearSelection();\r\n    }\r\n\r\n    #renderGridColumnHeaderCell(column: GridColumnModel): Element {\r\n        const gridColumnElement = reactiveElement(\r\n            column,\r\n            element(\"e-gridcell\", {\r\n                attributes: {\r\n                    type: \"columnheader\",\r\n                    id: column.name\r\n                },\r\n                children: [\r\n                    element(\"span\", {\r\n                        attributes: {\r\n                            class: \"gridheader-content\"\r\n                        },\r\n                        children: (<Node[]>[\r\n                            element(\"span\", {\r\n                                attributes: {\r\n                                    class: \"gridheader-label\"\r\n                                },\r\n                                children: this.#columnDelegate(column)\r\n                            }),\r\n                            element(\"span\", {\r\n                                attributes: {\r\n                                    class: \"gridheader-sort-indicator\"\r\n                                }\r\n                            })\r\n                        ]).concat(\r\n                            this.resizable ? [\r\n                                element(\"e-wsash\", {\r\n                                    attributes: {\r\n                                        controls: column.name\r\n                                    }\r\n                                })\r\n                            ] : []\r\n                        )\r\n                    })\r\n                ]\r\n            }),\r\n            [\"sortorder\"],\r\n            (cell, property, oldValue, newValue) => {\r\n                switch (property) {\r\n                    case \"sortorder\": {\r\n                        const {dataset} = cell;\r\n                        if (typeof newValue !== \"undefined\") {\r\n                            dataset.sortorder = newValue.toString();\r\n                        }\r\n                        else {\r\n                            delete dataset.sortorder;\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        );\r\n        return gridColumnElement;\r\n    }\r\n\r\n    #renderGridBodyRow(row: GridRowModel): Element {\r\n        const {model} = this;\r\n        const gridRowElement = element(\"e-gridrow\", {\r\n            dataset: {\r\n                index: row.id\r\n            },\r\n            children: reactiveChildElements(\r\n                model.columns, column => this.#renderGridDataCell(row, column)\r\n            )\r\n        });\r\n        return gridRowElement;\r\n    }\r\n\r\n    #renderGridDataCell(row: GridRowModel, column: GridColumnModel): Element {\r\n        const gridCellElement = element(\"e-gridcell\", {\r\n            attributes: {\r\n                type: \"gridcell\",\r\n                headers: column.name\r\n            },\r\n            children: element(\"span\", {\r\n                attributes: {\r\n                    class: \"gridcell-content\"\r\n                },\r\n                children: (<Node[]>[\r\n                    element(\"span\", {\r\n                        attributes: {\r\n                            class: \"gridcell-label\"\r\n                        },\r\n                        children: this.#cellDelegate(row, column)\r\n                    })\r\n                ])\r\n            })\r\n        });\r\n        return gridCellElement;\r\n    }\r\n\r\n    #handleHeadContextMenuEvent(event: MouseEvent): void {\r\n        const {clientX, clientY, currentTarget, target} = event;\r\n        const {gridElement} = this;\r\n        const targetHead = <HTMLElement>currentTarget;\r\n        const targetHeader = <HTMLEGridCellElement>(<HTMLElement>target).closest(\"e-gridcell\");\r\n        const {model} = this;\r\n        if (targetHeader) {\r\n            const column = model.getColumnByName(targetHeader.id)!;\r\n            const {sortorder, filters} = column;\r\n            const contextMenu = element(\"e-menu\",  {\r\n                attributes: {\r\n                    contextual: true\r\n                },\r\n                children: [\r\n                    element(\"e-menuitem\",  {\r\n                        attributes: {\r\n                            label: \"Resize Auto\"\r\n                        },\r\n                        children: \"Resize auto\",\r\n                        listeners: {\r\n                            click: () => {\r\n                                const columnHeaderElement = this.getColumnHeaderElement(column);\r\n                                if (columnHeaderElement) {\r\n                                    const {style} = columnHeaderElement;\r\n                                    const labels = this.getColumnCellsElements(column).map(\r\n                                        cell_i => cell_i.querySelector(\".gridcell-label\")!\r\n                                    );\r\n                                    const maxWidth = labels.reduce(\r\n                                        (maxWidth, label) => Math.max(maxWidth, label.getBoundingClientRect().width), 0\r\n                                    );\r\n                                    style.setProperty(\"width\", `${maxWidth}px`);\r\n                                }\r\n                                gridElement.focus();\r\n                            }\r\n                        }\r\n                    }),\r\n                    element(\"e-menuitem\",  {\r\n                        attributes: {\r\n                            label: \"Resize To Default\"\r\n                        },\r\n                        children: \"Resize to Default\",\r\n                        listeners: {\r\n                            click: () => {\r\n                                const columnHeaderElement = this.getColumnHeaderElement(column);\r\n                                if (columnHeaderElement) {\r\n                                    const {style} = columnHeaderElement;\r\n                                    style.removeProperty(\"width\");\r\n                                }\r\n                                gridElement.focus();\r\n                            }\r\n                        }\r\n                    }),\r\n                    element(\"e-menuitem\",  {\r\n                        attributes: {\r\n                            type: \"submenu\",\r\n                            label: \"Sort\",\r\n                        },\r\n                        children: [\r\n                            \"Sort\",\r\n                            element(\"e-menu\",  {\r\n                                attributes: {\r\n                                    slot: \"menu\"\r\n                                },\r\n                                children: [\r\n                                    element(\"e-menuitem\",  {\r\n                                        attributes: {\r\n                                            type: \"radio\",\r\n                                            name: \"sort\",\r\n                                            value: \"1\",\r\n                                            label: \"Ascending\",\r\n                                            checked: sortorder === 1\r\n                                        },\r\n                                        children: \"Ascending\"\r\n                                    }),\r\n                                    element(\"e-menuitem\",  {\r\n                                        attributes: {\r\n                                            type: \"radio\",\r\n                                            name: \"sort\",\r\n                                            value: \"-1\",\r\n                                            label: \"Descending\",\r\n                                            checked: sortorder === -1\r\n                                        },\r\n                                        children: \"Descending\"\r\n                                    })\r\n                                ],\r\n                                listeners: {\r\n                                    click: (event) => {\r\n                                        const {target} = event;\r\n                                        const targetItem = (<HTMLElement>target).closest(\"e-menuitem\");\r\n                                        if (targetItem) {\r\n                                            model.sortByColumn(column, Number(targetItem.value));\r\n                                        }\r\n                                        gridElement.focus();\r\n                                    }\r\n                                }\r\n                            })\r\n                        ]\r\n                    }),\r\n                    element(\"e-menuitem\",  {\r\n                        attributes: {\r\n                            type: \"submenu\",\r\n                            label: \"Filter\"\r\n                        },\r\n                        children: [\r\n                            \"Filter\",\r\n                            element(\"e-menu\",  {\r\n                                attributes: {\r\n                                    slot: \"menu\"\r\n                                },\r\n                                children: filters.map(filter => {\r\n                                    const {name} = filter;\r\n                                    return element(\"e-menuitem\", {\r\n                                        attributes: {\r\n                                            type: \"checkbox\",\r\n                                            checked: this.#displayFilters.includes(filter),\r\n                                            label: name\r\n                                        },\r\n                                        children: name\r\n                                    })\r\n                                }).concat(\r\n                                    element(\"e-menuitem\", {\r\n                                        attributes: {\r\n                                            type: \"button\",\r\n                                            label: \"Remove filters\"\r\n                                        },\r\n                                        children: \"Remove filters\"\r\n                                    })\r\n                                ),\r\n                                listeners: {\r\n                                    click: (event) => {\r\n                                        const {target} = event;\r\n                                        const targetItem = (<HTMLElement>target).closest(\"e-menuitem\");\r\n                                        if (targetItem) {\r\n                                            const {checked, label} = targetItem;\r\n                                            const filter = filters.find(filter => filter.name === label);\r\n                                            if (filter) {\r\n                                                if (checked) {\r\n                                                    this.addDisplayFilter(filter);\r\n                                                }\r\n                                                else {\r\n                                                    this.removeDisplayFilter(filter);\r\n                                                }\r\n                                            }\r\n                                            else {\r\n                                                this.removeAllDisplayFilters();\r\n                                            }\r\n                                        }\r\n                                        gridElement.focus();\r\n                                    }\r\n                                }\r\n                            })\r\n                        ]\r\n                    })\r\n                ]\r\n            });\r\n            targetHead.append(contextMenu);\r\n            contextMenu.positionContextual(clientX, clientY);\r\n            contextMenu.focus({preventScroll: true});\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    #handleSearchInputEvent(event: InputEvent) {\r\n        const {target} = event;\r\n        if (target instanceof HTMLInputElement) {\r\n            const {value} = target;\r\n            if (value !== \"\") {\r\n                this.setSearchFilter({\r\n                    filter: (row) => row.name.toLowerCase().includes(value.toLowerCase())\r\n                });\r\n            }\r\n            else {\r\n                this.setSearchFilter(null);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleHeadClickEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetIsHeaderContent = (<HTMLElement>target).matches(\"e-gridcell[type=columnheader] :scope:not(e-wsash)\");\r\n        if (targetIsHeaderContent) {\r\n            const targetHeader = <HTMLEGridCellElement>(<HTMLElement>target).closest(\"e-gridcell\");\r\n            const {model} = this;\r\n            const {columns} = model;\r\n            if (targetHeader) {\r\n                const targetColumn = Array.from(columns.values()).find(column_i => column_i.name == targetHeader.id);\r\n                if (targetColumn) {\r\n                    const {sortorder = -1} = targetColumn;\r\n                    model.sortByColumn(targetColumn, -sortorder);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar GridView: GridViewConstructor = GridViewBase;","import { HTMLEMenuItemElement } from \"../elements/containers/menus/MenuItem\";\r\nimport { CustomElement, element, reactiveChildElements, reactiveElement } from \"../elements/Element\";\r\nimport { ModelList, ModelObject, ModelProperty } from \"../models/Model\";\r\nimport { View } from \"./View\";\r\n\r\nexport { MenuModel };\r\nexport { MenuItemModel };\r\nexport { MenuView };\r\n\r\ninterface MenuInit {\r\n    name?: string;\r\n    items: MenuItemModel[];\r\n}\r\n\r\nclass MenuModel extends ModelObject {\r\n    readonly items: ModelList<MenuItemModel>;\r\n    \r\n    @ModelProperty()\r\n    name?: string;\r\n    \r\n    constructor(init: MenuInit) {\r\n        super();\r\n        this.name = init?.name;\r\n        this.items = new ModelList(init?.items ?? []);\r\n    }\r\n}\r\n\r\ninterface MenuItemInit {\r\n    label: string;\r\n    name?: string;\r\n    type?: \"button\" | \"radio\" | \"checkbox\" | \"menu\" | \"submenu\";\r\n    menu?: MenuModel;\r\n}\r\n\r\nclass MenuItemModel extends ModelObject {\r\n    @ModelProperty()\r\n    name?: string;\r\n\r\n    @ModelProperty()\r\n    label: string;\r\n\r\n    @ModelProperty()\r\n    type?: \"button\" | \"radio\" | \"checkbox\" | \"menu\" | \"submenu\";\r\n\r\n    @ModelProperty()\r\n    menu?: MenuModel;\r\n    \r\n    constructor(init: MenuItemInit) {\r\n        super();\r\n        const {name, label, type, menu} = init;\r\n        this.name = name;\r\n        this.label = label;\r\n        this.type = type;\r\n        this.menu = menu;\r\n    }\r\n}\r\n\r\ninterface MenuViewConstructor {\r\n    prototype: MenuView;\r\n    new(): MenuView;\r\n    new(model: MenuModel): MenuView;\r\n}\r\n\r\ninterface MenuView extends View {\r\n    readonly model: MenuModel;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"v-menu\": MenuView,\r\n    }\r\n}\r\n\r\n@CustomElement({\r\n    name: \"v-menu\"\r\n})\r\nclass MenuViewBase extends View {\r\n    readonly model!: MenuModel;\r\n\r\n    constructor()\r\n    constructor(model: MenuModel)\r\n    constructor(model?: MenuModel) {\r\n        super();\r\n        this.setModel(model ?? new MenuModel({\r\n            items: []\r\n        }));\r\n    }\r\n\r\n    renderLight() {\r\n        const {model} = this;\r\n        return this.#renderMenu(model);\r\n    }\r\n\r\n    #renderMenu(menu: MenuModel) {\r\n        return element(\"e-menu\", {\r\n            children: reactiveChildElements(\r\n                menu.items,\r\n                item_i => this.#renderMenuItem(item_i)\r\n            )\r\n        });\r\n    }\r\n\r\n    #renderMenuItem(item: MenuItemModel): HTMLEMenuItemElement {\r\n        const {label, type, menu} = item;\r\n        return reactiveElement(\r\n            item,\r\n            element(\"e-menuitem\", {\r\n                attributes: {\r\n                    type: type\r\n                },\r\n                children: [\r\n                    <string | Node>label\r\n                ].concat(\r\n                    (menu !== undefined) ? [\r\n                        this.#renderMenu(menu)\r\n                    ] : []\r\n                )\r\n            }),\r\n            [\"label\", \"name\"],\r\n            (menuitem, property, oldValue, newValue) => {\r\n                switch (property) {\r\n                    case \"label\": {\r\n                        menuitem.label = newValue;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nvar MenuView: MenuViewConstructor = MenuViewBase;","import { HTMLEMenuElement } from \"../elements/containers/menus/Menu\";\r\nimport { HTMLEToolBarElement } from \"../elements/containers/toolbars/ToolBar\";\r\nimport { HTMLETreeElement } from \"../elements/containers/trees/Tree\";\r\nimport { HTMLETreeItemElement } from \"../elements/containers/trees/TreeItem\";\r\nimport { AttributeProperty, CustomElement, element, fragment, reactiveChildElements, reactiveElement } from \"../elements/Element\";\r\nimport { ModelEvent, ModelList, ModelObject, ModelProperty } from \"../models/Model\";\r\nimport { View } from \"./View\";\r\n\r\nexport { TreeItemModelList };\r\nexport { TreeModel };\r\nexport { TreeItemModel };\r\nexport { TreeView };\r\n\r\ninterface TreeModelInit {\r\n    items: TreeItemModel[];\r\n    sortFunction?: (item_a: TreeItemModel, item_b: TreeItemModel) => number;\r\n}\r\n\r\nclass TreeModel extends ModelObject {\r\n    readonly items: ModelList<TreeItemModel>;\r\n    readonly childItems: ModelList<TreeItemModel>;\r\n    sortFunction: ((item_a: TreeItemModel, item_b: TreeItemModel) => number) | null;\r\n\r\n    constructor()\r\n    constructor(init: TreeModelInit)\r\n    constructor(init?: TreeModelInit) {\r\n        super();\r\n        const {items = [], sortFunction} = init ?? {};\r\n        items.forEach((item_i, i) => item_i.index = i);\r\n        const childItems = new ModelList(items);\r\n        childItems.setParent(this);\r\n        this.childItems = childItems;\r\n        this.items = new ModelList(this.subtreeItems());\r\n        this.sortFunction = sortFunction ??\r\n            function(item_a: TreeItemModel, item_b: TreeItemModel) {\r\n                return item_a.name.localeCompare(item_b.name);\r\n            };\r\n        this.addEventListener(\"modelchange\", this.#handleModelChangeEvent.bind(this));\r\n    }\r\n    \r\n    #handleModelChangeEvent(event: ModelEvent): void {\r\n        const {target} = event;\r\n        const {items, sortFunction, subtreeItems} = this;\r\n        if (target instanceof ModelList) {\r\n            const records = target.getRecords();\r\n            records.forEach((record_i) => {\r\n                const {insertedItems, removedItems} = record_i;\r\n                const flattenedInsertedItems = (<TreeItemModel[]>Array.from(insertedItems.values())).flatMap(\r\n                    insertedItem_i => Array.of(insertedItem_i, ...subtreeItems.call(insertedItem_i))\r\n                );\r\n                const flattenedRemovedItems = (<TreeItemModel[]>Array.from(removedItems.values())).flatMap(\r\n                    removedItem_i => Array.of(removedItem_i, ...subtreeItems.call(removedItem_i))\r\n                );\r\n                items.beginChanges();\r\n                items.append(...flattenedInsertedItems);\r\n                flattenedRemovedItems.forEach((removedItem_i) => items.remove(removedItem_i));\r\n                if (sortFunction) items.sort(sortFunction);\r\n                items.endChanges();\r\n            });\r\n            Array.from((<ModelList<TreeItemModel>>target).values()).forEach((item_i, i) => {\r\n                item_i.index = i;\r\n            });\r\n        }\r\n    }\r\n\r\n    subtreeItems(): TreeItemModel[] {\r\n        const {childItems} = this;\r\n        return Array.from(childItems.values()).flatMap(\r\n            treeItem_i => Array.of(treeItem_i, ...treeItem_i.subtreeItems())\r\n        );\r\n    }\r\n\r\n    getItemByUri(this: TreeModel | TreeItemModel, uri: string): TreeItemModel | null {\r\n        const {childItems} = this;\r\n        const {length: itemsCount} = childItems;\r\n        const {length: uriLength} = uri;\r\n        for (let i = 0; i < itemsCount; i++) {\r\n            const item_i = childItems.get(i)!;\r\n            const {uri: itemUri} = item_i;\r\n            const {length: itemUriLength} = itemUri;\r\n            if (uri.startsWith(itemUri)) {\r\n                if (itemUriLength === uriLength) {\r\n                    return <TreeItemModel>item_i;\r\n                }\r\n                return TreeModel.prototype.getItemByUri.call(item_i, uri);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nclass TreeItemModelList {\r\n    readonly items: TreeItemModel[];\r\n\r\n    constructor(items: TreeItemModel[]) {\r\n        this.items = items;\r\n    }\r\n\r\n    get count(): number {\r\n        return this.items.length;\r\n    }\r\n\r\n    remove(): void {\r\n        const {items} = this;\r\n        const removedItemsGroups = items.reduce((map, item_i) => {\r\n            const {parentNode} = item_i;\r\n            if (parentNode instanceof TreeItemModel || parentNode instanceof TreeModel) {\r\n                const {childItems} = parentNode;\r\n                const group = map.get(childItems);\r\n                if (group) group.push(item_i);\r\n                else map.set(childItems, [item_i]);\r\n            }\r\n            return map;\r\n        }, new Map<ModelList, TreeItemModel[]>());\r\n        Array.from(removedItemsGroups.entries()).forEach(\r\n            ([list_i, children_i]) => {\r\n                list_i.beginChanges();\r\n                children_i.forEach((child_i) => {\r\n                    list_i.remove(child_i);\r\n                });\r\n                list_i.endChanges();\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nclass TreeItemModel extends ModelObject {\r\n    readonly childItems: ModelList<TreeItemModel>;\r\n\r\n    @ModelProperty()\r\n    name: string;\r\n    \r\n    @ModelProperty()\r\n    type: \"leaf\" | \"parent\";\r\n\r\n    @ModelProperty()\r\n    index: number;\r\n\r\n    get level(): number {\r\n        const {parentNode} = this;\r\n        if (parentNode instanceof TreeItemModel) {\r\n            return parentNode.level + 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    get uri(): string {\r\n        const {parentNode, name} = this;\r\n        if (parentNode instanceof TreeItemModel) {\r\n            return `${parentNode.uri}${name}/`;\r\n        }\r\n        return `${name}/`;\r\n    }\r\n\r\n    get parentItem(): TreeItemModel | null {\r\n        const {parentNode} = this;\r\n        if (parentNode instanceof TreeItemModel) {\r\n            return parentNode;\r\n        }\r\n        return null;\r\n    }\r\n    \r\n    constructor(init: {name: string, type: \"leaf\" | \"parent\", items?: TreeItemModel[]}) {\r\n        super();\r\n        const {name, type, items = []} = init;\r\n        items.forEach((item_i, i) => item_i.index = i);\r\n        const childItems = new ModelList(items);\r\n        childItems.setParent(this);\r\n        this.name = name;\r\n        this.childItems = childItems;\r\n        this.type = type;\r\n        this.index = -1;\r\n    }\r\n\r\n    subtreeItems(): TreeItemModel[] {\r\n        const {childItems} = this;\r\n        return Array.from(childItems.values()).flatMap(\r\n            treeItem_i => Array.of(treeItem_i, ...treeItem_i.subtreeItems())\r\n        );\r\n    }\r\n\r\n    remove(): void {\r\n        const {parentNode} = this;\r\n        if (parentNode instanceof TreeItemModel || parentNode instanceof TreeModel) {\r\n            const {childItems} = parentNode;\r\n            if (childItems) {\r\n                childItems.remove(this);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\ninterface TreeViewConstructor {\r\n    prototype: TreeView;\r\n    new(): TreeView;\r\n    new(model: TreeModel): TreeView;\r\n}\r\n\r\ninterface TreeView extends View {\r\n    readonly shadowRoot: ShadowRoot;\r\n    readonly model: TreeModel;\r\n    setModel(model: TreeModel): void;\r\n    renderShadow(): Node;\r\n    draggable: boolean;\r\n    selectedItems(): TreeItemModel[];\r\n    activeItem(): TreeItemModel | null;\r\n    get treeElement(): HTMLETreeElement | null ;\r\n    treeItemElement(item: TreeItemModel): HTMLETreeItemElement | null;\r\n    treeItem(element: HTMLETreeItemElement): TreeItemModel | null;\r\n    itemContentDelegate(this: TreeView, item: TreeItemModel): string | Node;\r\n    itemToolbarDelegate(this: TreeView, item: TreeItemModel): HTMLEToolBarElement | null;\r\n    itemMenuDelegate(this: TreeView): HTMLEMenuElement | null;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"e-treeview\": TreeView,\r\n    }\r\n}\r\n\r\nvar style: string;\r\n\r\n@CustomElement({\r\n    name: \"e-treeview\"\r\n})\r\nclass TreeViewBase extends View implements TreeView {\r\n    readonly shadowRoot!: ShadowRoot;\r\n    readonly model!: TreeModel;\r\n\r\n    #dragImages: WeakMap<TreeItemModel, WeakRef<Element>>;\r\n\r\n    @AttributeProperty({type: Boolean, observed: true})\r\n    draggable!: boolean;\r\n\r\n    static {\r\n        style = /*css*/`\r\n            :host {\r\n                display: block;\r\n            }\r\n            \r\n            .offscreen {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 0;\r\n                transform: translateY(-100%);\r\n                display: block;\r\n                pointer-events: none;\r\n            }\r\n            \r\n            .dragimage {\r\n                white-space: nowrap;\r\n                margin: 1px;\r\n                display: inline-block;\r\n                outline: 1px solid var(--focused-item-outline-color);\r\n                outline-offset: -1px;\r\n                border-radius: 3px; \r\n                padding: 2px 4px;\r\n            }\r\n        `;\r\n    }\r\n    \r\n    constructor()\r\n    constructor(model: TreeModel)\r\n    constructor(model?: TreeModel) {\r\n        super();\r\n        this.#dragImages = new WeakMap();\r\n        const shadowRoot = this.attachShadow({mode: \"open\"});\r\n        const adoptedStylesheet = new CSSStyleSheet();\r\n        adoptedStylesheet.replace(style);\r\n        shadowRoot.adoptedStyleSheets = [adoptedStylesheet];\r\n        this.setModel(model ?? new TreeModel());\r\n    }\r\n\r\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\r\n        switch (name) {\r\n            case \"draggable\": {\r\n                const {treeElement} = this;\r\n                if (treeElement) {\r\n                    Array.from(treeElement.items).forEach(\r\n                        item_i => item_i.draggable = newValue !== null\r\n                    );\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    get treeElement(): HTMLETreeElement | null {\r\n        return this.shadowRoot.querySelector<HTMLETreeElement>(\"e-tree\")!;\r\n    }\r\n\r\n    treeItemElement(item: TreeItemModel): HTMLETreeItemElement | null  {\r\n        return this.shadowRoot.querySelector<HTMLETreeItemElement>(`e-treeitem[uri=${item.uri}]`)!;\r\n    }\r\n\r\n    #getTreeItemElementUri(item: HTMLETreeItemElement): string {\r\n        let uri = \"\";\r\n        let closestItem = <HTMLETreeItemElement | null>item;\r\n        while (closestItem !== null) {\r\n            const {dataset, parentElement} = closestItem;\r\n            const {name} = dataset;\r\n            uri = `${name}/` + uri;\r\n            closestItem = parentElement?.closest(\"e-treeitem\") ?? null;\r\n        }\r\n        return uri;\r\n    }\r\n\r\n    treeItem(element: HTMLETreeItemElement): TreeItemModel | null  {\r\n        return this.model.getItemByUri(this.#getTreeItemElementUri(element));\r\n    }\r\n\r\n    override renderShadow(): Node {\r\n        const {model} = this;\r\n        const treeElement = element(\"e-tree\", {\r\n            attributes: {\r\n                tabindex: 0,\r\n            },\r\n            children: reactiveChildElements(\r\n                model.childItems, item => this.#renderTreeItem(item)\r\n            ),\r\n            listeners: {\r\n                dragstart: <EventListener>this.#handleDragStartEvent.bind(this),\r\n                drop: <EventListener>this.#handleDropEvent.bind(this),\r\n                contextmenu: <EventListener>this.#handleContextMenuEvent.bind(this),\r\n                focus: <EventListener>this.#handleFocusEvent.bind(this),\r\n                focusin: <EventListener>this.#handleFocusInEvent.bind(this),\r\n                focusout: <EventListener>this.#handleFocusOutEvent.bind(this),\r\n            }\r\n        });\r\n        return fragment(\r\n            /*element(\"link\", {\r\n                attributes: {\r\n                    rel: \"stylesheet\",\r\n                    href: \"/css/main.css\"\r\n                }\r\n            }),*/\r\n            treeElement,\r\n            element(\"slot\"),\r\n            element(\"div\", {\r\n                attributes: {\r\n                    class: \"offscreen\",\r\n                    hidden: true\r\n                },\r\n                children: reactiveChildElements(model.items,\r\n                    item => this.#renderTreeItemDragImage(item)\r\n                )\r\n            })\r\n        );\r\n    }\r\n\r\n    itemContentDelegate(item: TreeItemModel): string | Node {\r\n        return reactiveElement(\r\n            item,\r\n            element(\"span\"),\r\n            [\"name\"],\r\n            (label, property, oldValue, newValue) => {\r\n                label.textContent = newValue;\r\n            }\r\n        );\r\n    }\r\n\r\n    itemToolbarDelegate(item: TreeItemModel): HTMLEToolBarElement | null {\r\n        return null;\r\n    }\r\n    \r\n    itemMenuDelegate(this: TreeView): HTMLEMenuElement | null {\r\n        return null;\r\n    }\r\n\r\n    selectedItems(): TreeItemModel[] {\r\n        const {treeElement} = this;\r\n        if (treeElement) {\r\n            const selectedElements = treeElement.selectedItems();\r\n            return selectedElements.map(\r\n                item_i => <TreeItemModel>this.treeItem(item_i)\r\n            );\r\n        }\r\n        return [];\r\n    }\r\n\r\n    activeItem(): TreeItemModel | null {\r\n        const {treeElement} = this;\r\n        if (treeElement) {\r\n            const {activeItem} = treeElement;\r\n            return activeItem ?\r\n                this.treeItem(activeItem) :\r\n                null;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #getDragImage(model: TreeItemModel): Element | null {\r\n        return this.#dragImages.get(model)?.deref() ?? null;\r\n    }\r\n\r\n    #renderTreeItem(item: TreeItemModel): HTMLETreeItemElement {\r\n        const {draggable} = this;\r\n        const {index, level, name} = item;\r\n        const toolbar = this.itemToolbarDelegate(item);\r\n        const content = this.itemContentDelegate(item);\r\n        const treeItemElement = reactiveElement(\r\n            item,\r\n            element(\"e-treeitem\", {\r\n                attributes: {\r\n                    draggable: String(draggable),\r\n                    posinset: index,\r\n                    level: level\r\n                },\r\n                dataset: {\r\n                    name: name\r\n                },\r\n                children: [\r\n                    ...(content ? [content] : []),\r\n                    ...(toolbar ? [toolbar] : [])\r\n                ]\r\n            }),\r\n            [\"index\", \"name\", \"type\"],\r\n            (treeitem, propertyName, oldValue, newValue) => {\r\n                switch (propertyName) {\r\n                    case \"index\": {\r\n                        treeitem.posinset = newValue;\r\n                        break;\r\n                    }\r\n                    case \"name\": {\r\n                        const {dataset} = treeitem;\r\n                        dataset.name = newValue;\r\n                        break;\r\n                    }\r\n                    case \"type\": {\r\n                        treeitem.type = newValue;\r\n                        switch (newValue) {\r\n                            case \"parent\": {\r\n                                treeitem.append(\r\n                                    element(\"e-treeitemgroup\", {\r\n                                        attributes: {\r\n                                            slot: \"group\"\r\n                                        },\r\n                                        children: reactiveChildElements(item.childItems,\r\n                                            item => this.#renderTreeItem(item)\r\n                                        )\r\n                                    })\r\n                                );\r\n                                break;\r\n                            }\r\n                            case \"leaf\": {\r\n                                const {group} = treeitem;\r\n                                if (group) {\r\n                                    group.remove();\r\n                                }\r\n                                break;\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        );\r\n        return treeItemElement;\r\n    }\r\n\r\n    #renderTreeItemDragImage(item: TreeItemModel): Element {\r\n        const dragImageElement = reactiveElement(\r\n            item,\r\n            element(\"span\", {\r\n                attributes: {\r\n                    class: \"dragimage\"\r\n                }\r\n            }),\r\n            [\"name\"],\r\n            (span, property, oldValue, newValue) => {\r\n                span.textContent = newValue;\r\n            }\r\n        );\r\n        this.#dragImages.set(item, new WeakRef(dragImageElement));\r\n        return dragImageElement;\r\n    }\r\n\r\n    #handleDragStartEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetTree = <HTMLETreeElement>currentTarget;\r\n        const targetItem = <HTMLETreeItemElement>(<Element>target).closest(\"e-treeitem\");\r\n        const {model} = this;\r\n        if (targetItem) {\r\n            const {dataTransfer} = event;\r\n            const selectedElements = targetTree.selectedItems();\r\n            const {length: selectedCount} = selectedElements;\r\n            if (selectedCount > 0) {\r\n                const selectedUris = \r\n                    selectedElements\r\n                    .map(element_i => this.#getTreeItemElementUri(element_i))\r\n                    .filter(\r\n                        (uri_i, _, uris) => !uris.some(\r\n                            uri_j => uri_i.startsWith(`${uri_j}/`)\r\n                        )\r\n                    );\r\n                const selectedUrisString = selectedUris.join(\"\\n\");\r\n                const lastUri = selectedUris[selectedUris.length - 1];\r\n                const lastItem = model.getItemByUri(lastUri);\r\n                if (lastItem && dataTransfer) {\r\n                    dataTransfer.dropEffect = \"move\";\r\n                    dataTransfer.setData(\"text/plain\", selectedUrisString);\r\n                    const dragImage = this.#getDragImage(lastItem);\r\n                    if (dragImage) {\r\n                        dataTransfer.setDragImage(dragImage, -16, 0);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetTree = <HTMLETreeElement>currentTarget;\r\n        const targetItem = <HTMLETreeItemElement>(<Element>target).closest(\"e-treeitem\");\r\n        const {model} = this;\r\n        const {sortFunction} = model;\r\n        if (targetItem) {\r\n            const {dataTransfer} = event;\r\n            if (dataTransfer) {\r\n                const targetUri = this.#getTreeItemElementUri(targetItem);\r\n                const targetItemModel = model.getItemByUri(targetUri)!;\r\n                const transferedUris = dataTransfer.getData(\"text/plain\").split(\"\\n\");\r\n                const targetIsWithin = transferedUris.some(uri_i => targetUri.startsWith(`${uri_i}/`) || uri_i === targetUri);\r\n                if (!targetIsWithin) {\r\n                    const transferedItems = <TreeItemModel[]>(\r\n                        transferedUris.map(\r\n                            uri_i => model.getItemByUri(uri_i)\r\n                        ).filter(\r\n                            item_i => item_i !== null\r\n                        )\r\n                    );\r\n                    const {type: targetType, parentItem: targetParentItem} = targetItemModel;\r\n                    const {childItems: targetList} =\r\n                        targetType === \"parent\" ? targetItemModel :\r\n                        targetParentItem ? targetParentItem : model;\r\n                    const targetItems = Array.from(targetList.values());\r\n                    targetItems.forEach((item_i) => {\r\n                        const sameLabelIndex = transferedItems.findIndex(item_j => item_j.name === item_i.name);\r\n                        if (sameLabelIndex > -1) {\r\n                            const doReplace = confirm(`Replace ${item_i.name}?`);\r\n                            if (doReplace) {\r\n                                targetList.remove(item_i);\r\n                            }\r\n                            else {\r\n                                transferedItems.copyWithin(sameLabelIndex, sameLabelIndex + 1);\r\n                                transferedItems.length--;\r\n                            }\r\n                        }\r\n                    });\r\n                    const transferedItemsModelList = new TreeItemModelList(transferedItems);\r\n                    transferedItemsModelList.remove();\r\n                    if (sortFunction) {\r\n                        targetList.beginChanges();\r\n                        targetList.append(...transferedItems);\r\n                        targetList.sort(sortFunction);\r\n                        targetList.endChanges();\r\n                    }\r\n                    else {\r\n                        targetList.insert(targetItem.posinset, ...transferedItems);\r\n                    }\r\n                    const newElements = targetTree.querySelectorAll<HTMLETreeItemElement>(`e-treeitem:is(${\r\n                        transferedItems.map(item_i => `[data-uri=\"${item_i.uri}\"]`).join(\",\")\r\n                    })`);\r\n                    targetTree.beginSelection();\r\n                    newElements.forEach(element_i => element_i.selected = true);\r\n                    targetTree.endSelection();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleContextMenuEvent(event: MouseEvent): void {\r\n        const {clientX, clientY, currentTarget, target} = event;\r\n        const targetTree = <HTMLETreeElement>currentTarget;\r\n        const targetItem = <HTMLETreeItemElement>(<Element>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            const contextMenu = this.itemMenuDelegate();\r\n            if (contextMenu !== null) {\r\n                contextMenu.contextual = true;\r\n                contextMenu.addEventListener(\"close\", () => {\r\n                    targetItem.focus({preventScroll: true});\r\n                });\r\n                targetTree.append(contextMenu);\r\n                contextMenu.positionContextual(clientX, clientY);\r\n                contextMenu.focus({preventScroll: true});\r\n            }\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLETreeElement>currentTarget;\r\n        if (relatedTarget !== null  && !this.contains(<Node | null>relatedTarget)) {\r\n            const relatedPosition = (<Node>relatedTarget).compareDocumentPosition(this);\r\n            if (!(relatedPosition & Node.DOCUMENT_POSITION_DISCONNECTED) && (relatedPosition & Node.DOCUMENT_POSITION_PRECEDING)) {\r\n                const {activeItem} = targetTree;\r\n                if (activeItem) {\r\n                    const itemToolbar = activeItem.querySelector(\"e-toolbar\");\r\n                    if (itemToolbar) {\r\n                        event.preventDefault();\r\n                        itemToolbar.focus();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLETreeItemElement>(<Element>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            const itemToolbar = targetItem.querySelector(\"e-toolbar\");\r\n            if (itemToolbar) {\r\n                itemToolbar.tabIndex = itemToolbar.contains(<Node | null>target) ? -1 : 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {target} = event;\r\n        const targetItem = <HTMLETreeItemElement>(<Element>target).closest(\"e-treeitem\");\r\n        if (targetItem) {\r\n            const itemToolbar = targetItem.querySelector(\"e-toolbar\");\r\n            if (itemToolbar) {\r\n                itemToolbar.tabIndex = itemToolbar.contains(<Node | null>target) ? 0 : -1;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar TreeView: TreeViewConstructor = TreeViewBase;","import { ModelObject } from \"../models/Model\";\r\n\r\nexport { View };\r\n\r\ninterface View extends HTMLElement {\r\n    readonly model: ModelObject | null;\r\n    setModel(model: ModelObject): void;\r\n    renderShadow(): Node | undefined;\r\n    renderLight(): Node | undefined;\r\n    render(): void;\r\n}\r\n\r\ninterface ViewConstructor {\r\n    prototype: View;\r\n    new(): View;\r\n}\r\n\r\nclass ViewBase extends HTMLElement implements View {\r\n    #model: ModelObject | null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#model = null;\r\n    }\r\n\r\n    get model(): ModelObject | null {\r\n        return this.#model;\r\n    }\r\n    \r\n    setModel(model: ModelObject): void {\r\n        if (model !== this.#model) {\r\n            this.#model = model;\r\n        }\r\n    }\r\n\r\n    renderLight(): Node | undefined {\r\n        return;\r\n    }\r\n\r\n    renderShadow(): Node | undefined {\r\n        return;\r\n    }\r\n\r\n    render(): void {\r\n        const {shadowRoot} = this;\r\n        if (shadowRoot !== null) {\r\n            const shadow = this.renderShadow();\r\n            if (shadow) {\r\n                shadowRoot.replaceChildren(shadow);\r\n            }\r\n        }\r\n        const light = this.renderLight();\r\n        if (light) {\r\n            this.replaceChildren(light);\r\n        }\r\n    }\r\n}\r\n\r\nvar View: ViewConstructor = ViewBase;","import { element } from \"../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"./Widget\";\r\n\r\nexport { heightSashWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"heightsash\": HeightSashWidgetFactory\r\n    }\r\n}\r\n\r\ninterface HeightSashWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        controls?: string;\r\n        growDir?: \"top\" | \"bottom\";\r\n    }): HTMLElement;\r\n}\r\n\r\nvar heightSashWidget = new (\r\nWidget({\r\n    name: \"heightsash\"\r\n})(class HeightSashWidgetFactory extends WidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    #targets: WeakMap<HTMLElement, HTMLElement | null>;\r\n    #onCaptureFlags: WeakMap<HTMLElement, boolean>;\r\n    #queuedPointerCallbacks: WeakMap<HTMLElement, FrameRequestCallback | null>;\r\n    #pointerMovements: WeakMap<HTMLElement, number>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"heightsash\"\r\n            }\r\n        });\r\n        this.#targets = new WeakMap();\r\n        this.#onCaptureFlags = new WeakMap();\r\n        this.#queuedPointerCallbacks = new WeakMap();\r\n        this.#pointerMovements = new WeakMap();\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        controls?: string;\r\n        growDir?: \"top\" | \"bottom\";\r\n    }) {\r\n        const targets = this.#targets;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const sash = <HTMLElement>this.#template.cloneNode(true);\r\n        sash.addEventListener(\"pointerdown\", this.#handlePointerDownEvent.bind(this));\r\n        sash.addEventListener(\"pointermove\", this.#handlePointerMoveEvent.bind(this));\r\n        sash.addEventListener(\"pointerup\", this.#handlePointerUpEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, controls, growDir} = properties;\r\n            if (id !== undefined) {\r\n                sash.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                sash.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                sash.tabIndex = tabIndex;\r\n            }\r\n            if (controls !== undefined) {\r\n                this.setControls(sash, controls);\r\n            }\r\n            if (growDir !== undefined) {\r\n                this.setGrowDir(sash, growDir);\r\n            }\r\n        }\r\n        targets.set(sash, null);\r\n        queuedPointerCallbacks.set(sash, null);\r\n        pointerMovements.set(sash, 0);\r\n        onCaptureFlags.set(sash, false);\r\n        return sash;\r\n    }\r\n\r\n    getGrowDir(sash: HTMLElement): \"top\" | \"bottom\" {\r\n        return <\"top\" | \"bottom\">sash.getAttribute(\"data-growdir\") ?? \"top\";\r\n    }\r\n\r\n    setGrowDir(sash: HTMLElement, value: \"top\" | \"bottom\"): void {\r\n        sash.setAttribute(\"data-growdir\", value);\r\n    }\r\n\r\n    getControls(sash: HTMLElement): string | null {\r\n        return sash.getAttribute(\"data-controls\");\r\n    }\r\n\r\n    setControls(sash: HTMLElement, value: string): void {\r\n        sash.setAttribute(\"data-controls\", value);\r\n    }\r\n\r\n    setHeight(sash: HTMLElement, height: number): void {\r\n        const targets = this.#targets;\r\n        const target = targets.get(sash)!;\r\n        if (target !== null) {\r\n            target.style.setProperty(\"height\", `${height}px`);\r\n        }\r\n    }\r\n\r\n    #handlePointerUpEvent(event: PointerEvent): void {\r\n        const {pointerId, currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        sashTarget.releasePointerCapture(pointerId);\r\n        onCaptureFlags.set(sashTarget, false);\r\n    }\r\n\r\n    #handlePointerDownEvent(event: PointerEvent): void {\r\n        const {pointerId, currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const controls = this.getControls(sashTarget);\r\n        if (controls) {\r\n            const targets = this.#targets;\r\n            const onCaptureFlags = this.#onCaptureFlags;\r\n            const rootNode = <ShadowRoot | Document>sashTarget.getRootNode();\r\n            targets.set(sashTarget, rootNode.getElementById(controls));\r\n            onCaptureFlags.set(sashTarget, true);\r\n            sashTarget.setPointerCapture(pointerId);\r\n        }\r\n    }\r\n\r\n    #handlePointerMoveEvent(event: PointerEvent): void {\r\n        const {currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const onCaptureFlag = onCaptureFlags.get(sashTarget);\r\n        if (onCaptureFlag) {\r\n            let callback = queuedPointerCallbacks.get(sashTarget);\r\n            if (callback == null) {\r\n                callback = this.#pointerMoveCallback.bind(this, sashTarget);\r\n                queuedPointerCallbacks.set(sashTarget, callback);\r\n                requestAnimationFrame(callback);\r\n            }\r\n            const pointerMovement = pointerMovements.get(sashTarget)! + event.movementX;\r\n            pointerMovements.set(sashTarget, pointerMovement);\r\n        }\r\n    }\r\n\r\n    #pointerMoveCallback(sash: HTMLElement): void {\r\n        const targets = this.#targets;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const target = targets.get(sash)!;\r\n        if (target !== null) {\r\n            const targetComputedStyle = window.getComputedStyle(target);\r\n            const growdir = this.getGrowDir(sash);\r\n            const movementX = pointerMovements.get(sash)!;\r\n            const height = parseFloat(targetComputedStyle.getPropertyValue(\"height\"));\r\n            const newHeight = height + (growdir == \"top\" ? -1 : 1) * movementX;\r\n            this.setHeight(sash, newHeight);\r\n            sash.dispatchEvent(new Event(\"resize\"));\r\n        }\r\n        pointerMovements.set(sash, 0);\r\n        queuedPointerCallbacks.set(sash, null);\r\n    }\r\n}));","import { element } from \"../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"./Widget\";\r\n\r\nexport { separatorWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"separator\": SeparatorWidgetFactory\r\n    }\r\n}\r\n\r\ninterface SeparatorWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar separatorWidget = new (\r\nWidget({\r\n    name: \"separator\"\r\n})(class SeparatorWidgetFactory extends WidgetFactory {\r\n    #template: HTMLElement;\r\n    \r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"separator\",\r\n                role: \"separator\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n}));","import { ReactiveChildElements } from \"../../elements/Element\";\r\nimport { camelToTrain } from \"../../elements/Snippets\";\r\n\r\nexport { WidgetFactoryConstructor };\r\n\r\nexport { widget };\r\nexport { Widget };\r\nexport { WidgetFactory };\r\nexport { widgets };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {}\r\n}\r\n\r\ninterface WidgetFactoryConstructor {\r\n    prototype: WidgetFactory;\r\n    new(): WidgetFactory;\r\n}\r\n\r\ninterface WidgetFactory {\r\n    create(properties?: object): HTMLElement;\r\n    slot(root: HTMLElement, name: string | null): HTMLElement | null;\r\n}\r\n\r\nvar slotsMap: WeakMap<HTMLElement, {\r\n    widget: WidgetFactory,\r\n    element: WeakRef<HTMLElement>;\r\n    slot: string | null;\r\n}[]> = new WeakMap();\r\nvar slotsObserver = new MutationObserver(\r\n    (mutationsList: MutationRecord[]) => {\r\n        mutationsList.forEach((mutation: MutationRecord) => {\r\n            const {target, type} = mutation;\r\n            if (target instanceof HTMLElement) {\r\n                switch (type) {\r\n                    case \"childList\": {\r\n                        const slotReferences = slotsMap.get(target);\r\n                        if (slotReferences) {\r\n                            slotReferences.forEach(slotRef_i => {\r\n                                const {widget, element, slot} = slotRef_i;\r\n                                const slottedCallback = (widget as any)[\"slottedCallback\"];\r\n                                if (typeof slottedCallback == \"function\") {\r\n                                    slottedCallback(element.deref(), target, slot);\r\n                                }\r\n                            });\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n);\r\n\r\nvar widgetsMap: WeakMap<HTMLElement, WidgetFactory> = new WeakMap();\r\nvar attributesObserver = new MutationObserver(\r\n    (mutationsList: MutationRecord[]) => {\r\n        mutationsList.forEach((mutation: MutationRecord) => {\r\n            const {target, type} = mutation;\r\n            if (target instanceof HTMLElement) {\r\n                switch (type) {\r\n                    case \"attributes\": {\r\n                        const {attributeName, oldValue} = mutation;\r\n                        const widget = widgetsMap.get(target);\r\n                        if (widget) {\r\n                            const attributeChangedCallback = (widget as any)[\"attributeChangedCallback\"];\r\n                            if (typeof attributeChangedCallback == \"function\") {\r\n                                attributeChangedCallback(target, attributeName, oldValue, target.getAttribute(attributeName!));\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n);\r\n\r\nclass WidgetFactoryBase implements WidgetFactory {\r\n\r\n    constructor() {\r\n        const widget = <WidgetFactory>this;\r\n        this.create = new Proxy(\r\n            this.create, {\r\n                apply: (target, thisArg, argumentsList: Parameters<WidgetFactory[\"create\"]>) => {\r\n                    const element = <HTMLElement>Reflect.apply(target, thisArg, argumentsList);\r\n                    const observedSlots = <(string | null)[]>(widget as any)[\"observedSlots\"];\r\n                    if (Array.isArray(observedSlots)) {\r\n                        const slots = observedSlots\r\n                            .map(slotName_i => {\r\n                                return {\r\n                                    slotName: slotName_i,\r\n                                    slotElement: widget.slot(element, slotName_i)\r\n                                };\r\n                            });\r\n                        slots.forEach(slot_i => {\r\n                            const {slotElement, slotName} = slot_i;\r\n                            if (slotElement) {\r\n                                slotsObserver.observe(slotElement, {\r\n                                    childList: true\r\n                                });\r\n                                const slotReferences = slotsMap.get(slotElement);\r\n                                const slotReference = {widget, element: new WeakRef(element), slot: slotName};\r\n                                if (Array.isArray(slotReferences)) {\r\n                                    slotReferences.push(slotReference);\r\n                                }\r\n                                else {\r\n                                    slotsMap.set(slotElement, new Array(slotReference));\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    const observedAttributes = (widget as any)[\"observedAttributes\"];\r\n                    if (Array.isArray(observedAttributes)) {\r\n                        widgetsMap.set(element, widget);\r\n                        attributesObserver.observe(element, {\r\n                            attributes: true,\r\n                            attributeFilter: observedAttributes,\r\n                            attributeOldValue: true\r\n                        });\r\n                    }\r\n                    return element;\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    create(): HTMLElement {\r\n        throw new Error(`create method is not implemented`);\r\n    }\r\n\r\n    slot(): HTMLElement | null {\r\n        return null;\r\n    }\r\n\r\n    get observedSlots(): string[] {\r\n        return [\"\"];\r\n    }\r\n}\r\n\r\nvar WidgetFactory: WidgetFactoryConstructor = WidgetFactoryBase;\r\nvar widgets: Map<string, WidgetFactory> = new Map();\r\n\r\ninterface WidgetInit<K extends keyof WidgetNameMap> {\r\n    properties?: Parameters<WidgetNameMap[K][\"create\"]>[0],\r\n    attributes?: {\r\n        [name: string]: number | string | boolean\r\n    },\r\n    dataset?: {\r\n        [property: string]: string | number | boolean\r\n    },\r\n    slotted?: {\r\n        [slot: string]: Node | string | (Node | string)[] | NodeList | ReactiveChildElements\r\n    } | (Node | string | (Node | string)[] | NodeList | ReactiveChildElements),\r\n    listeners?: {\r\n        [EventName in keyof HTMLElementEventMap]?: EventListenerOrEventListenerObject | [EventListenerOrEventListenerObject, boolean | AddEventListenerOptions | undefined]\r\n    }\r\n}\r\n\r\nfunction widget<K extends keyof WidgetNameMap>(\r\n    name: K, init?: WidgetInit<K>): ReturnType<WidgetNameMap[K][\"create\"]>;\r\nfunction widget<K extends keyof WidgetNameMap>(\r\n    name: K, init?: WidgetInit<K>): HTMLElement {\r\n    const widget = widgets.get(name);\r\n    if (widget) {\r\n        if (init !== undefined) {\r\n            const {properties, attributes, dataset, slotted, listeners} = init;\r\n            const element = widget.create(properties);\r\n            if (attributes) {\r\n                Object.entries(attributes).forEach(([attributeName, attributeValue]) => {\r\n                    if (attributeValue !== undefined) {\r\n                        if (typeof attributeValue === \"boolean\") {\r\n                            element.toggleAttribute(camelToTrain(attributeName), attributeValue);\r\n                        }\r\n                        else {\r\n                            element.setAttribute(camelToTrain(attributeName), String(attributeValue));\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            if (dataset) {\r\n                const {dataset: elementDataset} = element;\r\n                Object.keys(dataset).forEach((datasetEntry_i) => {\r\n                    elementDataset[datasetEntry_i] = String(dataset[datasetEntry_i]);\r\n                });\r\n            }\r\n            if (slotted) {\r\n                if (typeof slotted === \"function\" || Array.isArray(slotted) || slotted instanceof NodeList || typeof slotted === \"string\" || slotted instanceof Node) {\r\n                    const slot = widget.slot(element, null);\r\n                    if (slot) {\r\n                        if (typeof slotted === \"function\") {\r\n                            slotted(slot);\r\n                        }\r\n                        else if (typeof slotted === \"object\" && \"length\" in slotted) {\r\n                            slot.append(...Array.from(slotted));\r\n                        }\r\n                        else {\r\n                            slot.append(slotted);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    Object.entries(slotted).forEach(([slot_i, slotted]) => {\r\n                        const slot = widget.slot(element, slot_i);\r\n                        if (slot) {\r\n                            if (typeof slotted === \"function\") {\r\n                                slotted(slot);\r\n                            }\r\n                            else if (typeof slotted === \"object\" && \"length\" in slotted) {\r\n                                slot.append(...Array.from(slotted));\r\n                            }\r\n                            else {\r\n                                slot.append(slotted);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            if (listeners) {\r\n                Object.entries(listeners).forEach(([name_i, listener_i]) => {\r\n                    if (Array.isArray(listener_i)) {\r\n                        element.addEventListener(name_i, listener_i[0], listener_i[1]);\r\n                    }\r\n                    else {\r\n                        element.addEventListener(name_i, listener_i);\r\n                    }\r\n                });\r\n            }\r\n            return element;\r\n        }\r\n        else {\r\n            return widget.create();\r\n        }\r\n    }\r\n    throw new Error(`Unknown widget ${name}. The corresponding module might not be imported.`);\r\n}\r\n\r\ninterface WidgetDecorator {\r\n    (init: {\r\n        name: string;\r\n    }): <W extends WidgetFactoryConstructor>(widget: W) => W;\r\n}\r\n\r\nconst Widget: WidgetDecorator = function(init: {\r\n    name: string;\r\n}) {\r\n    return <W extends WidgetFactoryConstructor>(\r\n        widget: W\r\n    ) => {\r\n        const {name} = init;\r\n        widgets.set(\r\n            name,\r\n            new widget()\r\n        );\r\n        return widget;\r\n    }\r\n}","import { element } from \"../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"./Widget\";\r\n\r\nexport { widthSashWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"widthsash\": WidthSashWidgetFactory\r\n    }\r\n}\r\n\r\ninterface WidthSashWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        controls?: string;\r\n        growDir?: \"left\" | \"right\";\r\n    }): HTMLElement;\r\n}\r\n\r\nvar widthSashWidget = new (\r\nWidget({\r\n    name: \"widthsash\"\r\n})(class WidthSashWidgetFactory extends WidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    #targets: WeakMap<HTMLElement, HTMLElement | null>;\r\n    #onCaptureFlags: WeakMap<HTMLElement, boolean>;\r\n    #queuedPointerCallbacks: WeakMap<HTMLElement, FrameRequestCallback | null>;\r\n    #pointerMovements: WeakMap<HTMLElement, number>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"widthsash\"\r\n            }\r\n        });\r\n        this.#targets = new WeakMap();\r\n        this.#onCaptureFlags = new WeakMap();\r\n        this.#queuedPointerCallbacks = new WeakMap();\r\n        this.#pointerMovements = new WeakMap();\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        controls?: string;\r\n        growDir?: \"left\" | \"right\";\r\n    }) {\r\n        const targets = this.#targets;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const sash = <HTMLElement>this.#template.cloneNode(true);\r\n        sash.addEventListener(\"pointerdown\", this.#handlePointerDownEvent.bind(this));\r\n        sash.addEventListener(\"pointermove\", this.#handlePointerMoveEvent.bind(this));\r\n        sash.addEventListener(\"pointerup\", this.#handlePointerUpEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, controls, growDir} = properties;\r\n            if (id !== undefined) {\r\n                sash.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                sash.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                sash.tabIndex = tabIndex;\r\n            }\r\n            if (controls !== undefined) {\r\n                this.setControls(sash, controls);\r\n            }\r\n            if (growDir !== undefined) {\r\n                this.setGrowDir(sash, growDir);\r\n            }\r\n        }\r\n        targets.set(sash, null);\r\n        queuedPointerCallbacks.set(sash, null);\r\n        pointerMovements.set(sash, 0);\r\n        onCaptureFlags.set(sash, false);\r\n        return sash;\r\n    }\r\n\r\n    getGrowDir(sash: HTMLElement): \"right\" | \"left\" {\r\n        return <\"right\" | \"left\">sash.getAttribute(\"data-growdir\") ?? \"right\";\r\n    }\r\n\r\n    setGrowDir(sash: HTMLElement, value: \"right\" | \"left\"): void {\r\n        sash.setAttribute(\"data-growdir\", value);\r\n    }\r\n\r\n    getControls(sash: HTMLElement): string | null {\r\n        return sash.getAttribute(\"data-controls\");\r\n    }\r\n\r\n    setControls(sash: HTMLElement, value: string): void {\r\n        sash.setAttribute(\"data-controls\", value);\r\n    }\r\n\r\n    setWidth(sash: HTMLElement, width: number): void {\r\n        const targets = this.#targets;\r\n        const target = targets.get(sash)!;\r\n        if (target !== null) {\r\n            target.style.setProperty(\"width\", `${width}px`);\r\n        }\r\n    }\r\n\r\n    #handlePointerUpEvent(event: PointerEvent): void {\r\n        const {pointerId, currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        sashTarget.releasePointerCapture(pointerId);\r\n        onCaptureFlags.set(sashTarget, false);\r\n    }\r\n\r\n    #handlePointerDownEvent(event: PointerEvent): void {\r\n        const {pointerId, currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const controls = this.getControls(sashTarget);\r\n        if (controls) {\r\n            const targets = this.#targets;\r\n            const onCaptureFlags = this.#onCaptureFlags;\r\n            const rootNode = <ShadowRoot | Document>sashTarget.getRootNode();\r\n            targets.set(sashTarget, rootNode.getElementById(controls));\r\n            onCaptureFlags.set(sashTarget, true);\r\n            sashTarget.setPointerCapture(pointerId);\r\n        }\r\n    }\r\n\r\n    #handlePointerMoveEvent(event: PointerEvent): void {\r\n        const {currentTarget} = event;\r\n        const sashTarget = <HTMLElement>currentTarget;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const onCaptureFlags = this.#onCaptureFlags;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const pointerMoveCallback = this.#pointerMoveCallback;\r\n        const onCaptureFlag = onCaptureFlags.get(sashTarget);\r\n        if (onCaptureFlag) {\r\n            let callback = queuedPointerCallbacks.get(sashTarget);\r\n            if (callback == null) {\r\n                callback = pointerMoveCallback.bind(this, sashTarget);\r\n                queuedPointerCallbacks.set(sashTarget, callback);\r\n                requestAnimationFrame(callback);\r\n            }\r\n            const pointerMovement = pointerMovements.get(sashTarget)! + event.movementX;\r\n            pointerMovements.set(sashTarget, pointerMovement);\r\n        }\r\n    }\r\n\r\n    #pointerMoveCallback(sash: HTMLElement): void {\r\n        const targets = this.#targets;\r\n        const pointerMovements = this.#pointerMovements;\r\n        const queuedPointerCallbacks = this.#queuedPointerCallbacks;\r\n        const target = targets.get(sash)!;\r\n        if (target !== null) {\r\n            const targetComputedStyle = window.getComputedStyle(target);\r\n            const growdir = this.getGrowDir(sash);\r\n            const movementX = pointerMovements.get(sash)!;\r\n            const width = parseFloat(targetComputedStyle.getPropertyValue(\"width\"));\r\n            const newWidth = width + (growdir == \"right\" ? 1 : -1) * movementX;\r\n            this.setWidth(sash, newWidth);\r\n            sash.dispatchEvent(new Event(\"resize\"));\r\n        }\r\n        pointerMovements.set(sash, 0);\r\n        queuedPointerCallbacks.set(sash, null);\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { optionWidget } from \"./OptionWidget\";\r\n\r\nexport { comboBoxWidget };\r\n\r\ninterface ComboBoxWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        name?: string;\r\n        disabled?: boolean;\r\n        multiselectable?: boolean;\r\n    }): HTMLElement;\r\n    options(combobox: HTMLElement): HTMLElement[];\r\n    getName(combobox: HTMLElement): string;\r\n    setName(combobox: HTMLElement, value: string): void;\r\n    getExpanded(combobox: HTMLElement): boolean;\r\n    setExpanded(combobox: HTMLElement, value: boolean): void;\r\n    setDisabled(combobox: HTMLElement, value: boolean): void;\r\n    getDisabled(combobox: HTMLElement): boolean;\r\n    expand(combobox: HTMLElement): void;\r\n    collapse(combobox: HTMLElement): void;\r\n    toggle(combobox: HTMLElement, force?: boolean): void;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"combobox\": ComboBoxWidgetFactory\r\n    }\r\n}\r\n\r\nvar comboBoxWidget = new(\r\nWidget({\r\n    name: \"combobox\"\r\n})(\r\nclass ComboBoxWidgetFactoryBase extends WidgetFactory implements ComboBoxWidgetFactory {\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n    #optionsObserver: MutationObserver;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        this.#optionsObserver = new MutationObserver(\r\n            this.#optionsMutationCallback.bind(this)\r\n        );\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"combobox\",\r\n                role: \"combobox\",\r\n                tabindex: 0,\r\n            },\r\n            children: [\r\n                element(\"div\", {\r\n                    attributes: {\r\n                        class: \"content\"\r\n                    },\r\n                    children: [\r\n                        element(\"span\", {\r\n                            attributes: {\r\n                                class: \"value\"\r\n                            }\r\n                        })\r\n                    ]\r\n                }),\r\n                element(\"div\", {\r\n                    attributes: {\r\n                        class: \"box\"\r\n                    }\r\n                })\r\n            ]\r\n        });\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        name?: string;\r\n        disabled?: boolean;\r\n        multiselectable?: boolean;\r\n    }): HTMLElement {\r\n        const combobox = <HTMLElement>this.#template.cloneNode(true);\r\n        this.#optionsObserver.observe(combobox, {\r\n            childList: true,\r\n            subtree: true\r\n        });\r\n        combobox.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        combobox.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        combobox.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        combobox.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        this.setExpanded(combobox, false);\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, name, disabled, multiselectable} = properties;\r\n            if (id !== undefined) {\r\n                combobox.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                combobox.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                combobox.tabIndex = tabIndex;\r\n            }\r\n            if (name !== undefined) {\r\n                this.setName(combobox, name);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(combobox, disabled);\r\n            }\r\n            if (multiselectable !== undefined) {\r\n                this.setMultiSelectable(combobox, multiselectable);\r\n            }\r\n        }\r\n        return combobox;\r\n    }\r\n\r\n    slot(combobox: HTMLElement) {\r\n        return this.#box(combobox);\r\n    }\r\n\r\n    slottedCallback(combobox: HTMLElement, slot: HTMLElement, name: string | null) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement) {\r\n                //gridRowWidget.setPosInSet(child_i, i);\r\n            }\r\n        });\r\n    }\r\n\r\n    #box(combobox: HTMLElement): HTMLElement {\r\n        return combobox.querySelector<HTMLElement>(\":scope > .box\")!;\r\n    }\r\n    \r\n    options(combobox: HTMLElement): HTMLElement[] {\r\n        return Array.from(combobox.querySelectorAll<HTMLElement>(\r\n            \":scope > :is(.box, .box > .optiongroup) > .option\"\r\n        ));\r\n    }\r\n\r\n    selectedOption(combobox: HTMLElement): HTMLElement | null {\r\n        return combobox.querySelector<HTMLElement>(\r\n            \":scope > :is(.box, .box > .optiongroup) > .option[aria-selected=true]\"\r\n        );\r\n    }\r\n\r\n    #getActiveOption(combobox: HTMLElement): HTMLElement | null {\r\n        return combobox.querySelector<HTMLElement>(\r\n            \":scope > :is(.box, .box > .optiongroup) > .option:focus-within\"\r\n        );\r\n    }\r\n\r\n    #value(combobox: HTMLElement): HTMLElement {\r\n        return combobox.querySelector<HTMLElement>(\":scope > .content > .value\")!;\r\n    }\r\n    \r\n    getName(combobox: HTMLElement): string {\r\n        return combobox.getAttribute(\"name\") ?? \"\";\r\n    }\r\n\r\n    setName(combobox: HTMLElement, value: string): void {\r\n        combobox.setAttribute(\"name\", value);\r\n    }\r\n\r\n    getDisabled(combobox: HTMLElement): boolean {\r\n        return combobox.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setDisabled(combobox: HTMLElement, value: boolean): void {\r\n        combobox.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    setExpanded(combobox: HTMLElement, value: boolean): void {\r\n        combobox.setAttribute(\"aria-expanded\", String(value));\r\n    }\r\n\r\n    getExpanded(combobox: HTMLElement): boolean {\r\n        return JSON.parse(combobox.getAttribute(\"aria-expanded\") ?? String(false));\r\n    }\r\n\r\n    setMultiSelectable(combobox: HTMLElement, value: boolean): void {\r\n        combobox.setAttribute(\"aria-multiselectable\", String(value));\r\n    }\r\n\r\n    getMultiSelectable(combobox: HTMLElement): boolean {\r\n        return JSON.parse(combobox.getAttribute(\"aria-multiselectable\") ?? String(false));\r\n    }\r\n\r\n    expand(combobox: HTMLElement): void {\r\n        const expanded = this.getExpanded(combobox);\r\n        if (!expanded) {\r\n            this.setExpanded(combobox, true);\r\n            this.#positionBox(combobox);\r\n            const selectedOption = this.selectedOption(combobox);\r\n            if (selectedOption) {\r\n                selectedOption.focus({preventScroll: true});\r\n            }\r\n        }\r\n    }\r\n\r\n    collapse(combobox: HTMLElement): void {\r\n        const expanded = this.getExpanded(combobox);\r\n        if (expanded) {\r\n            this.setExpanded(combobox, false);\r\n            combobox.focus();\r\n        }\r\n    }\r\n\r\n    toggle(combobox: HTMLElement, force?: boolean): void {\r\n        const expanded = this.getExpanded(combobox);\r\n        const expand = force ?? !expanded;\r\n        expand ? this.expand(combobox) : this.collapse(combobox);\r\n    }\r\n\r\n    #optionsMutationCallback(mutationsList: MutationRecord[]) {\r\n        mutationsList.forEach((mutation: MutationRecord) => {\r\n            const {target, type} = mutation;\r\n            const targetCombobox = (<HTMLElement>target).closest<HTMLElement>(\".combobox\")!;\r\n            if (targetCombobox instanceof HTMLElement) {\r\n                switch (type) {\r\n                    case \"childList\": {\r\n                        const {addedNodes} = mutation;\r\n                        const selector = \".option[aria-selected=true]\";\r\n                        for (let node of addedNodes) {\r\n                            if (node instanceof HTMLElement) {\r\n                                const selectedOption = node.matches(selector) ? node :\r\n                                    node.querySelector<HTMLElement>(selector);\r\n                                if (selectedOption) {\r\n                                    this.#setSelectedOption(targetCombobox, selectedOption);\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"option\") && !optionWidget.getDisabled(node) && !node.hidden) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"optiongroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #firstOption(combobox: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = this.#box(combobox);\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastOption(combobox: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = this.#box(combobox);\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousOption(option: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = option;\r\n        return <HTMLElement | null>walker.previousNode();\r\n    }\r\n\r\n    #nextOption(option: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = option;\r\n        return <HTMLElement | null>walker.nextNode();\r\n    }\r\n\r\n    #selectOption(combobox: HTMLElement, option: HTMLElement) {\r\n        const selectedOption = this.selectedOption(combobox);\r\n        if (selectedOption) {\r\n            optionWidget.setSelected(selectedOption, false);\r\n        }\r\n        if (option !== selectedOption) {\r\n            optionWidget.setSelected(option, true);\r\n            this.#setSelectedOption(combobox, option);\r\n            combobox.dispatchEvent(new Event(\"change\", {bubbles: true}));\r\n        }\r\n    }\r\n    \r\n    #setSelectedOption(combobox: HTMLElement, option: HTMLElement) {\r\n        this.#value(combobox).textContent = optionWidget.getLabel(option);\r\n    }\r\n\r\n    #positionBox(combobox: HTMLElement): void {\r\n        const box = combobox.querySelector<HTMLElement>(\":scope > .box\")!;\r\n        const {style: optionsStyle} = box;  \r\n        const {bottom, left} = combobox.getBoundingClientRect();\r\n        const {scrollX, scrollY} = window;\r\n        optionsStyle.setProperty(\"top\", `${bottom + scrollY}px`);\r\n        optionsStyle.setProperty(\"left\", `${left + scrollX}px`);\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetCombobox = <HTMLElement>currentTarget;\r\n        this.toggle(targetCombobox);\r\n        const expanded = this.getExpanded(targetCombobox);\r\n        if (expanded) {\r\n            const selectedOption = this.selectedOption(targetCombobox);\r\n            (selectedOption ?? this.options(targetCombobox)[0])?.focus({preventScroll: true});\r\n        }\r\n        else {\r\n            const targetOption = (<HTMLElement>target).closest<HTMLElement>(\".option\");\r\n            if (targetOption) {\r\n                this.#selectOption(targetCombobox, targetOption);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetCombobox = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetCombobox.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.collapse(targetCombobox);\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {currentTarget, key} = event;\r\n        const targetCombobox = <HTMLElement>currentTarget;\r\n        const expanded = this.getExpanded(targetCombobox);\r\n        const activeOption = this.#getActiveOption(targetCombobox);\r\n        const selectedOption = this.selectedOption(targetCombobox);\r\n        switch (key) {\r\n            case \"ArrowUp\": {\r\n                if (expanded) {\r\n                    const previousOption = activeOption ?\r\n                        this.#previousOption(activeOption) :\r\n                        this.#firstOption(targetCombobox);\r\n                    if (previousOption) {\r\n                        previousOption.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const previousOption = selectedOption ?\r\n                        this.#previousOption(selectedOption) :\r\n                        this.#firstOption(targetCombobox);\r\n                    if (previousOption) {\r\n                        this.#selectOption(targetCombobox, previousOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (expanded) {\r\n                    const nextOption = activeOption ?\r\n                        this.#nextOption(activeOption) :\r\n                        this.#lastOption(targetCombobox);\r\n                    if (nextOption) {\r\n                        nextOption.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const nextOption = selectedOption ?\r\n                        this.#nextOption(selectedOption) :\r\n                        this.#lastOption(targetCombobox);\r\n                    if (nextOption) {\r\n                        this.#selectOption(targetCombobox, nextOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstOption = this.#firstOption(targetCombobox);\r\n                if (firstOption) {\r\n                    if (expanded) {\r\n                        firstOption.focus({preventScroll: true});\r\n                    }\r\n                    else {\r\n                        this.#selectOption(targetCombobox, firstOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastOption = this.#lastOption(targetCombobox);\r\n                if (lastOption) {\r\n                    if (expanded) {\r\n                        lastOption.focus({preventScroll: true});\r\n                    }\r\n                    else {\r\n                        this.#selectOption(targetCombobox, lastOption);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                if (expanded) {\r\n                    this.collapse(targetCombobox);\r\n                    if (activeOption) {\r\n                        this.#selectOption(targetCombobox, activeOption);\r\n                    }\r\n                }\r\n                else {\r\n                    this.expand(targetCombobox);\r\n                    selectedOption?.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (expanded) {\r\n                    this.collapse(targetCombobox);\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            default: {\r\n                const {length: keyLength} = key;\r\n                if (keyLength == 1) {\r\n                    const keyCode = key.charCodeAt(0);\r\n                    const options = this.options(targetCombobox);\r\n                    const activeIndex = activeOption ? options.indexOf(activeOption) : -1;\r\n                    const matchingOption = options.find(\r\n                        (option_i, i) => optionWidget.getLabel(option_i).toLowerCase().charCodeAt(0) == keyCode && i > activeIndex\r\n                    ) ?? options.find(\r\n                        (option_i) => optionWidget.getLabel(option_i).toLowerCase().charCodeAt(0) == keyCode\r\n                    );\r\n                    if (matchingOption) {\r\n                        matchingOption.focus({preventScroll: true});\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target} = event;\r\n        const targetItem = (<Element>target).closest<HTMLElement>(\".option\");\r\n        if (targetItem) {\r\n            targetItem.focus({preventScroll: true});\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { optionGroupWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"optiongroup\": OptionGroupWidgetFactory\r\n    }\r\n}\r\n\r\ninterface OptionGroupWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar optionGroupWidget = new (\r\nWidget({\r\n    name: \"optiongroup\"\r\n})(class OptionGroupWidgetFactoryBase extends WidgetFactory implements OptionGroupWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"ul\", {\r\n            attributes: {\r\n                class: \"optiongroup\",\r\n                role: \"group\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(group: HTMLElement) {\r\n        return group;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { optionWidget };\r\n\r\ninterface OptionWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        label?: string;\r\n        name?: string;\r\n        value?: string;\r\n        selected?: boolean;\r\n        disabled?: boolean;\r\n    }): HTMLElement;\r\n    getLabel(option: HTMLElement): string;\r\n    setLabel(option: HTMLElement, value: string): void;\r\n    getValue(option: HTMLElement): string;\r\n    setValue(option: HTMLElement, value: string): void;\r\n    getName(option: HTMLElement): string;\r\n    setName(option: HTMLElement, value: string): void;\r\n    getSelected(option: HTMLElement): boolean;\r\n    setSelected(option: HTMLElement, value: boolean): void;\r\n    setDisabled(option: HTMLElement, value: boolean): void;\r\n    getDisabled(option: HTMLElement): boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"option\": OptionWidgetFactory\r\n    }\r\n}\r\n\r\nvar optionWidget = new(\r\nWidget({\r\n    name: \"option\"\r\n})(\r\nclass OptionWidgetFactoryBase extends WidgetFactory implements OptionWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"span\", {\r\n            attributes: {\r\n                class: \"option\",\r\n                role: \"option\",\r\n                tabindex: -1\r\n            },\r\n            children: [\r\n                element(\"span\", {\r\n                    attributes: {\r\n                        class: \"label\"\r\n                    }\r\n                })\r\n            ]\r\n        });\r\n    }\r\n\r\n    create(properties?: {\r\n        selected?: boolean;\r\n        label?: string;\r\n        name?: string;\r\n        value?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement {\r\n        const option = <HTMLElement>this.#template.cloneNode(true);\r\n        if (properties !== undefined) {\r\n            const {label, name, value, disabled} = properties;\r\n            let {selected} = properties;\r\n            selected = selected ?? false;\r\n            if (selected !== undefined) {\r\n                this.setSelected(option, selected);\r\n            }\r\n            if (label !== undefined) {\r\n                this.setLabel(option, label);\r\n            }\r\n            if (name !== undefined) {\r\n                this.setName(option, name);\r\n            }\r\n            if (value !== undefined) {\r\n                this.setValue(option, value);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(option, disabled);\r\n            }\r\n        }\r\n        return option;\r\n    }\r\n\r\n    get observedAttributes() {\r\n        return [\"aria-selected\"];\r\n    }\r\n\r\n    attributeChangedCallback(option: HTMLElement, name: string, oldValue: string, newValue: string) {\r\n        switch (name) {\r\n            case \"aria-selected\": {\r\n                if (JSON.parse(newValue) === true) {\r\n                    option.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #label(option: HTMLElement): HTMLElement {\r\n        return option.querySelector<HTMLElement>(\":scope > .label\")!;\r\n    }\r\n\r\n    getLabel(option: HTMLElement): string {\r\n        return this.#label(option).textContent ?? \"\";\r\n    }\r\n\r\n    setLabel(option: HTMLElement, value: string): void {\r\n        this.#label(option).textContent = value;\r\n    }\r\n\r\n    getValue(option: HTMLElement): string {\r\n        return option.getAttribute(\"value\") ?? \"\";\r\n    }\r\n\r\n    setValue(option: HTMLElement, value: string): void {\r\n        option.setAttribute(\"value\", value);\r\n    }\r\n    \r\n    getName(option: HTMLElement): string {\r\n        return option.getAttribute(\"name\") ?? \"\";\r\n    }\r\n\r\n    setName(option: HTMLElement, value: string): void {\r\n        option.setAttribute(\"name\", value);\r\n    }\r\n\r\n    getSelected(option: HTMLElement): boolean {\r\n        return JSON.parse(option.getAttribute(\"aria-selected\") ?? String(false));\r\n    }\r\n\r\n    setSelected(option: HTMLElement, value: boolean): void {\r\n        option.setAttribute(\"aria-selected\", String(value));\r\n    }\r\n\r\n    getDisabled(option: HTMLElement): boolean {\r\n        return option.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setDisabled(option: HTMLElement, value: boolean): void {\r\n        option.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { gridRowWidget } from \"./GridRowWidget\";\r\n\r\nexport { gridBodyWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"gridbody\": GridBodyWidgetFactory\r\n    }\r\n}\r\n\r\ninterface GridBodyWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar gridBodyWidget = new (\r\nWidget({\r\n    name: \"gridbody\"\r\n})(class GridBodyWidgetFactoryBase extends WidgetFactory implements GridBodyWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"tbody\", {\r\n            attributes: {\r\n                class: \"gridbody\",\r\n                role: \"rowgroup\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(body: HTMLElement) {\r\n        return body;\r\n    }\r\n\r\n    slottedCallback(body: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement && child_i.classList.contains(\"gridrow\")) {\r\n                gridRowWidget.setPosInSet(child_i, i);\r\n            }\r\n        });\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { gridCellWidget };\r\n\r\ninterface GridCellWidgetFactory extends WidgetFactory {\r\n    create(init: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        disabled?: boolean;\r\n        headers?: string;\r\n    }): HTMLElement;\r\n    getHeaders(item: HTMLElement): string;\r\n    setHeaders(item: HTMLElement, value: string): void;\r\n    setPosInSet(item: HTMLElement, value: number): void;\r\n    getPosInSet(item: HTMLElement): number;\r\n    setActive(item: HTMLElement, value: boolean): void;\r\n    getActive(item: HTMLElement): boolean;\r\n    setDropTarget(item: HTMLElement, value: boolean): void;\r\n    getDropTarget(item: HTMLElement): boolean;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n    setSelected(item: HTMLElement, value: boolean): void;\r\n    getSelected(item: HTMLElement): boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"gridcell\": GridCellWidgetFactory,\r\n    }\r\n}\r\n\r\nvar gridCellWidget = new (\r\nWidget({\r\n    name: \"gridcell\"\r\n})(class GridCellWidgetFactoryBase extends WidgetFactory implements GridCellWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"td\", {\r\n            attributes: {\r\n                class: \"gridcell\",\r\n                role: \"gridcell\",\r\n                tabindex: -1\r\n            }\r\n        });\r\n    }\r\n\r\n    create(init?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        disabled?: boolean;\r\n        headers?: string;\r\n    }): HTMLElement {\r\n        const cell = <HTMLElement>this.#template.cloneNode(true);\r\n        if (init !== undefined) {\r\n            const {id, classList, tabIndex, disabled, headers} = init;\r\n            if (id !== undefined) {\r\n                cell.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                cell.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                cell.tabIndex = tabIndex;\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(cell, disabled);\r\n            }\r\n            if (headers !== undefined) {\r\n                this.setHeaders(cell, headers);\r\n            }\r\n            this.setSelected(cell, false);\r\n        }\r\n        return cell;\r\n    }\r\n\r\n    slot(cell: HTMLElement): HTMLElement | null {\r\n        return cell;\r\n    }\r\n\r\n    getHeaders(item: HTMLElement): string {\r\n        return item.getAttribute(\"headers\") ?? \"\";\r\n    }\r\n\r\n    setHeaders(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"headers\", value);\r\n    }\r\n\r\n    getLabel(item: HTMLElement): string {\r\n        return this.#label(item).textContent ?? \"\";\r\n    }\r\n\r\n    setLabel(item: HTMLElement, value: string): void {\r\n        this.#label(item).textContent = value;\r\n    }\r\n\r\n    setPosInSet(item: HTMLElement, value: number): void {\r\n        item.setAttribute(\"aria-posinset\", String(value));\r\n    }\r\n\r\n    getPosInSet(item: HTMLElement): number {\r\n        const posInSet = item.getAttribute(\"aria-posinset\");\r\n        return posInSet ? parseInt(posInSet) : -1;\r\n    }\r\n\r\n    setActive(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"active\");\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"active\");\r\n    }\r\n\r\n    setDropTarget(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    getDropTarget(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"droptarget\");\r\n    }\r\n\r\n    setDisabled(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    getDisabled(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setSelected(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-selected\", String(value));\r\n        item.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n    }\r\n\r\n    getSelected(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-selected\") ?? String(false));\r\n    }\r\n\r\n    #label(item: HTMLElement): HTMLElement {\r\n        return item.querySelector<HTMLElement>(\":scope > .content > .label\")!;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { gridHeadWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"gridhead\": GridHeadWidgetFactory\r\n    }\r\n}\r\n\r\ninterface GridHeadWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar gridHeadWidget = new (\r\nWidget({\r\n    name: \"gridhead\"\r\n})(class GridHeadWidgetFactoryBase extends WidgetFactory implements GridHeadWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"thead\", {\r\n            attributes: {\r\n                class: \"gridhead\",\r\n                role: \"rowgroup\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(head: HTMLElement) {\r\n        return head;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { gridHeaderWidget };\r\n\r\ninterface GridHeaderWidgetFactory extends WidgetFactory {\r\n    create(init: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n    }): HTMLElement;\r\n    setActive(item: HTMLElement, value: boolean): void;\r\n    getActive(item: HTMLElement): boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"gridheader\": GridHeaderWidgetFactory,\r\n    }\r\n}\r\n\r\nvar gridHeaderWidget = new (\r\nWidget({\r\n    name: \"gridheader\"\r\n})(class GridHeaderWidgetFactoryBase extends WidgetFactory implements GridHeaderWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"th\", {\r\n            attributes: {\r\n                class: \"gridheader\",\r\n                scope: \"column\",\r\n                role: \"columnheader\",\r\n                tabindex: -1\r\n            }\r\n        });\r\n    }\r\n\r\n    create(init?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n    }): HTMLElement {\r\n        const header = <HTMLElement>this.#template.cloneNode(true);\r\n        if (init !== undefined) {\r\n            const {id, classList, tabIndex} = init;\r\n            if (id !== undefined) {\r\n                header.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                header.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                header.tabIndex = tabIndex;\r\n            }\r\n        }\r\n        return header;\r\n    }\r\n\r\n    slot(header: HTMLElement): HTMLElement | null {\r\n        return header;\r\n    }\r\n\r\n    setActive(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"active\");\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"active\");\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { gridCellWidget } from \"./GridCellWidget\";\r\n\r\nexport { gridRowWidget };\r\n\r\ninterface GridRowWidgetFactory extends WidgetFactory {\r\n    create(init?: {\r\n        disabled?: boolean\r\n    }): HTMLElement;\r\n    cells(row: HTMLElement): HTMLElement[];\r\n    setPosInSet(row: HTMLElement, value: number): void;\r\n    getPosInSet(row: HTMLElement): number;\r\n    setActive(row: HTMLElement, value: boolean): void;\r\n    getActive(row: HTMLElement): boolean;\r\n    setDropTarget(row: HTMLElement, value: boolean): void;\r\n    getDropTarget(row: HTMLElement): boolean;\r\n    setSelected(row: HTMLElement, value: boolean): void;\r\n    getSelected(row: HTMLElement): boolean;\r\n    setDisabled(row: HTMLElement, value: boolean): void;\r\n    getDisabled(row: HTMLElement): boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"gridrow\": GridRowWidgetFactory,\r\n    }\r\n}\r\n\r\nvar gridRowWidget = new (\r\nWidget({\r\n    name: \"gridrow\"\r\n})(class GridRowWidgetFactoryBase extends WidgetFactory implements GridRowWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"tr\", {\r\n            attributes: {\r\n                class: \"gridrow\",\r\n                role: \"row\",\r\n                tabindex: -1\r\n            }\r\n        });\r\n    }\r\n\r\n    create(init?: {\r\n        disabled?: boolean;\r\n    }): HTMLElement {\r\n        const row = <HTMLElement>this.#template.cloneNode(true);\r\n        if (init !== undefined) {\r\n            const {disabled} = init;\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(row, disabled);\r\n            }\r\n            this.setSelected(row, false);\r\n        }\r\n        return row;\r\n    }\r\n\r\n    slot(row: HTMLElement): HTMLElement | null {\r\n        return row;\r\n    }\r\n\r\n    cells(row: HTMLElement): HTMLElement[] {\r\n        return Array.from(row.querySelectorAll<HTMLElement>(\r\n            \":scope > .gridcell\"\r\n        ));\r\n    }\r\n    \r\n    setPosInSet(row: HTMLElement, value: number): void {\r\n        row.setAttribute(\"aria-posinset\", String(value));\r\n    }\r\n\r\n    getPosInSet(row: HTMLElement): number {\r\n        const posInSet = row.getAttribute(\"aria-posinset\");\r\n        return posInSet ? parseInt(posInSet) : -1;\r\n    }\r\n\r\n    setActive(row: HTMLElement, value: boolean): void {\r\n        const {classList} = row;\r\n        if (value) {\r\n            classList.add(\"active\");\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(row: HTMLElement): boolean {\r\n        const {classList} = row;\r\n        return classList.contains(\"active\");\r\n    }\r\n\r\n    setDropTarget(row: HTMLElement, value: boolean): void {\r\n        const {classList} = row;\r\n        if (value) {\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    getDropTarget(row: HTMLElement): boolean {\r\n        const {classList} = row;\r\n        return classList.contains(\"droptarget\");\r\n    }\r\n\r\n    setDisabled(row: HTMLElement, value: boolean): void {\r\n        row.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    getDisabled(row: HTMLElement): boolean {\r\n        return row.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setSelected(row: HTMLElement, value: boolean): void {\r\n        row.setAttribute(\"aria-selected\", String(value));\r\n        row.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n    }\r\n\r\n    getSelected(row: HTMLElement): boolean {\r\n        return JSON.parse(row.getAttribute(\"aria-selected\") ?? String(false));\r\n    }\r\n\r\n    slottedCallback(item: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((item_i, i) => {\r\n            if (item_i instanceof HTMLElement) {\r\n                gridCellWidget.setPosInSet(item_i, i);\r\n            }\r\n        });\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { gridCellWidget } from \"./GridCellWidget\";\r\nimport { gridRowWidget } from \"./GridRowWidget\";\r\n\r\nexport { gridWidget };\r\n\r\ntype GridSelectBy = \"cell\" | \"row\";\r\n\r\ninterface GridRowWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n        selectby?: GridSelectBy\r\n    }): HTMLElement;\r\n    setSelectBy(item: HTMLElement, value: GridSelectBy): void;\r\n    getSelectBy(item: HTMLElement): GridSelectBy;\r\n    headers(grid: HTMLElement): HTMLElement[];\r\n    cells(grid: HTMLElement): HTMLElement[];\r\n    rows(grid: HTMLElement): HTMLElement[];\r\n    beginSelection(grid: HTMLElement): void;\r\n    endSelection(grid: HTMLElement): void;\r\n    selectedCells(grid: HTMLElement): HTMLElement[];\r\n    selectedRows(grid: HTMLElement): HTMLElement[];\r\n    clearSelection(grid: HTMLElement): void;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"grid\": GridRowWidgetFactory,\r\n    }\r\n}\r\n\r\nvar gridWidget = new (\r\nWidget({\r\n    name: \"grid\"\r\n})(class GridWidgetFactoryBase extends WidgetFactory implements GridRowWidgetFactory {\r\n\r\n    #getActiveRow(grid: HTMLElement): HTMLElement | null {\r\n        return grid.querySelector<HTMLElement>(\".gridrow.active\");\r\n    }\r\n\r\n    #getActiveCell(grid: HTMLElement): HTMLElement | null {\r\n        return grid.querySelector<HTMLElement>(\".gridcell.active\");\r\n    }\r\n\r\n    headers(grid: HTMLElement): HTMLElement[] {\r\n        return Array.from(grid.querySelectorAll<HTMLElement>(\r\n            \":scope > .gridhead > .gridheader\"\r\n        ));\r\n    }\r\n\r\n    rows(grid: HTMLElement): HTMLElement[] {\r\n        return Array.from(grid.querySelectorAll<HTMLElement>(\r\n            \":scope > .gridbody > .gridrow\"\r\n        ));\r\n    }\r\n\r\n    cells(grid: HTMLElement): HTMLElement[] {\r\n        return Array.from(grid.querySelectorAll<HTMLElement>(\r\n            \":scope > .gridbody > .gridrow > .gridcell\"\r\n        ));\r\n    }\r\n\r\n    #template: HTMLElement;\r\n    #rowsWalker: TreeWalker;\r\n    #cellsWalker: TreeWalker;\r\n    #onSelection: WeakMap<HTMLElement, boolean>;\r\n    #hasSelectionChanged: WeakMap<HTMLElement, boolean>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"table\", {\r\n            attributes: {\r\n                class: \"grid\",\r\n                role: \"grid\",\r\n                tabindex: 0\r\n            }\r\n        });\r\n        this.#onSelection = new WeakMap();\r\n        this.#hasSelectionChanged = new WeakMap();\r\n        this.#cellsWalker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#cellsWalkerNodeFilter.bind(this)\r\n        );\r\n        this.#rowsWalker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#rowsWalkerNodeFilter.bind(this)\r\n        );\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n        selectby?: GridSelectBy;\r\n    }) {\r\n        const grid = <HTMLElement>this.#template.cloneNode(true);\r\n        //grid.addEventListener(\"contextmenu\", this.#handleContextMenuEvent.bind(this));\r\n        grid.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        grid.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        grid.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        grid.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        grid.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        grid.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, selectby, multisectable} = properties;\r\n            if (id !== undefined) {\r\n                grid.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                grid.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                grid.tabIndex = tabIndex;\r\n            }\r\n            if (selectby !== undefined) {\r\n                this.setSelectBy(grid, selectby);\r\n            }\r\n            if (multisectable !== undefined) {\r\n                this.setMultiSelectable(grid, multisectable);\r\n            }\r\n        }\r\n        return grid;\r\n    }\r\n\r\n    slot(grid: HTMLElement): HTMLElement | null {\r\n        return grid;\r\n    }\r\n\r\n    setMultiSelectable(grid: HTMLElement, value: boolean): void {\r\n        grid.setAttribute(\"aria-multiselectable\", String(value));\r\n    }\r\n\r\n    getMultiSelectable(grid: HTMLElement): boolean {\r\n        return JSON.parse(grid.getAttribute(\"aria-multiselectable\") ?? String(false));\r\n    }\r\n\r\n    setSelectBy(grid: HTMLElement, value: GridSelectBy): void {\r\n        grid.setAttribute(\"data-selectby\", value);\r\n    }\r\n\r\n    getSelectBy(grid: HTMLElement): GridSelectBy {\r\n        return <GridSelectBy>grid.getAttribute(\"data-selectby\") ?? \"cell\";\r\n    }\r\n\r\n    beginSelection(grid: HTMLElement): void {\r\n        this.#onSelection.set(grid, true);\r\n    }\r\n\r\n    endSelection(grid: HTMLElement): void {\r\n        this.#onSelection.set(grid, false);\r\n        if (this.#hasSelectionChanged.get(grid)) {\r\n            grid.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged.set(grid, false);\r\n        }\r\n    }\r\n\r\n    clearSelection(grid: HTMLElement): void {\r\n        this.#clearCellsSelection(grid);\r\n        this.#clearRowsSelection(grid);\r\n    }\r\n\r\n    selectedCells(grid: HTMLElement): HTMLElement[] {\r\n        return Array.from(grid.querySelectorAll(\":scope > .gridbody > .gridrow > .gridcell[aria-selected=true]\"));\r\n    }\r\n\r\n    selectedRows(grid: HTMLElement): HTMLElement[] {\r\n        return Array.from(grid.querySelectorAll(\":scope > .gridbody > .gridrow[aria-selected=true]\"));\r\n    }\r\n\r\n    #cellsWalkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"gridcell\") && !gridCellWidget.getDisabled(node) && !node.hidden) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"gridrow\") || classList.contains(\"gridbody\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #rowsWalkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"gridrow\") && !gridRowWidget.getDisabled(node) && !node.hidden) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"gridbody\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getCellsRange(from: HTMLElement, to: HTMLElement): HTMLElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextCell = this.#nextCell(from);\r\n            while (nextCell && nextCell !== to) {\r\n                range.push(nextCell);\r\n                nextCell = this.#nextCell(nextCell);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousCell = this.#previousCell(from);\r\n            while (previousCell && previousCell !== to) {\r\n                range.push(previousCell);\r\n                previousCell = this.#previousRow(previousCell);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #getRowsRange(from: HTMLElement, to: HTMLElement): HTMLElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextRow = this.#nextRow(from);\r\n            while (nextRow && nextRow !== to) {\r\n                range.push(nextRow);\r\n                nextRow = this.#nextRow(nextRow);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousRow = this.#previousRow(from);\r\n            while (previousRow && previousRow !== to) {\r\n                range.push(previousRow);\r\n                previousRow = this.#previousRow(previousRow);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setCellsSelection(grid: HTMLElement, ...cells: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        const selectedCells = this.selectedCells(grid);\r\n        selectedCells.forEach((selectedCell_i) => {\r\n            if (!cells.includes(selectedCell_i)) {\r\n                gridCellWidget.setSelected(selectedCell_i, false);\r\n            }\r\n        });\r\n        cells.forEach((cell_i) => {\r\n            const selected = gridCellWidget.getSelected(cell_i);\r\n            if (!selected) {\r\n                gridCellWidget.setSelected(cell_i, true);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #setRowsSelection(grid: HTMLElement, ...rows: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        const selectedRows = this.selectedRows(grid);\r\n        selectedRows.forEach((selectedRow_i) => {\r\n            if (!rows.includes(selectedRow_i)) {\r\n                gridRowWidget.setSelected(selectedRow_i, false);\r\n            }\r\n        });\r\n        rows.forEach((row_i) => {\r\n            const selected = gridRowWidget.getSelected(row_i);\r\n            if (!selected) {\r\n                gridRowWidget.setSelected(row_i, true);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #addCellsToSelection(grid: HTMLElement, ...cells: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        cells.forEach((cell_i) => {\r\n            const selected = gridCellWidget.getSelected(cell_i);\r\n            if (!selected) {\r\n                gridCellWidget.setSelected(cell_i, true);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #addRowsToSelection(grid: HTMLElement, ...rows: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        rows.forEach((row_i) => {\r\n            const selected = gridRowWidget.getSelected(row_i);\r\n            if (!selected) {\r\n                gridRowWidget.setSelected(row_i, true);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #removeCellsFromSelection(grid: HTMLElement, ...cells: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        const selectedCells = this.selectedCells(grid);\r\n        cells.forEach((cell_i) => {\r\n            if (selectedCells.includes(cell_i)) {\r\n                gridCellWidget.setSelected(cell_i, false);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #removeRowsFromSelection(grid: HTMLElement, ...rows: HTMLElement[]): void {\r\n        this.beginSelection(grid);\r\n        const selectedRows = this.selectedRows(grid);\r\n        rows.forEach((row_i) => {\r\n            if (selectedRows.includes(row_i)) {\r\n                gridRowWidget.setSelected(row_i, false);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #clearCellsSelection(grid: HTMLElement): void {\r\n        this.beginSelection(grid);\r\n        const selectedCells = this.selectedCells(grid);\r\n        selectedCells.forEach((cell_i) => {\r\n            const selected = gridCellWidget.getSelected(cell_i);\r\n            if (selected) {\r\n                gridCellWidget.setSelected(cell_i, false);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #clearRowsSelection(grid: HTMLElement): void {\r\n        this.beginSelection(grid);\r\n        const selectedRows = this.selectedRows(grid);\r\n        selectedRows.forEach((row_i) => {\r\n            const selected = gridRowWidget.getSelected(row_i);\r\n            if (selected) {\r\n                gridRowWidget.setSelected(row_i, false);\r\n            }\r\n        });\r\n        this.endSelection(grid);\r\n    }\r\n\r\n    #setActiveCell(grid: HTMLElement, cell: HTMLElement | null): void {\r\n        const activeCell = this.#getActiveCell(grid);\r\n        if (activeCell !== null && activeCell !== cell) {\r\n            gridCellWidget.setActive(activeCell, false);\r\n            activeCell.tabIndex = -1;\r\n        }\r\n        if (cell !== null) {\r\n            gridCellWidget.setActive(cell, true);\r\n            cell.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #setActiveRow(grid: HTMLElement, row: HTMLElement | null): void {\r\n        const activeRow = this.#getActiveRow(grid);\r\n        if (activeRow !== null && activeRow !== row) {\r\n            gridRowWidget.setActive(activeRow, false);\r\n            activeRow.tabIndex = -1;\r\n        }\r\n        if (row !== null) {\r\n            gridCellWidget.setActive(row, true);\r\n            row.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #firstCell(row: HTMLElement): HTMLElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = row;\r\n        return <HTMLElement | null>cellsWalker.firstChild();\r\n    }\r\n\r\n    #lastCell(row: HTMLElement): HTMLElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = row;\r\n        return <HTMLElement | null>cellsWalker.lastChild();\r\n    }\r\n\r\n    #previousCell(cell: HTMLElement): HTMLElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = cell;\r\n        return <HTMLElement | null>cellsWalker.previousNode();\r\n    }\r\n\r\n    #nextCell(cell: HTMLElement): HTMLElement | null {\r\n        const cellsWalker = this.#cellsWalker;\r\n        cellsWalker.currentNode = cell;\r\n        return <HTMLElement | null>cellsWalker.nextNode();\r\n    }\r\n\r\n    #closestRow(cell: HTMLElement): HTMLElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = cell;\r\n        return <HTMLElement | null>rowsWalker.parentNode();\r\n    }\r\n\r\n    #firstRow(grid: HTMLElement): HTMLElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = grid;\r\n        return <HTMLElement | null>rowsWalker.firstChild();\r\n    }\r\n\r\n    #lastRow(grid: HTMLElement): HTMLElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = grid;\r\n        return <HTMLElement | null>rowsWalker.lastChild();\r\n    }\r\n\r\n    #previousRow(row: HTMLElement): HTMLElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = row;\r\n        return <HTMLElement | null>rowsWalker.previousNode();\r\n    }\r\n\r\n    #nextRow(row: HTMLElement): HTMLElement | null {\r\n        const rowsWalker = this.#rowsWalker;\r\n        rowsWalker.currentNode = row;\r\n        return <HTMLElement | null>rowsWalker.nextNode();\r\n    }\r\n\r\n    #topCell(cell: HTMLElement): HTMLElement | null {\r\n        const closestRow = this.#closestRow(cell);\r\n        if (closestRow) {\r\n            const closestRowCells = gridRowWidget.cells(closestRow);\r\n            const cellIndex = Array.from(closestRowCells.values()).indexOf(cell);\r\n            const previousRow = this.#previousRow(closestRow);\r\n            if (previousRow) {\r\n                const previousRowCells = gridRowWidget.cells(previousRow);\r\n                return previousRowCells[Math.min(cellIndex, previousRowCells.length)];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #bottomCell(cell: HTMLElement): HTMLElement | null {\r\n        const closestRow = this.#closestRow(cell);\r\n        if (closestRow) {\r\n            const closestRowCells = gridRowWidget.cells(closestRow);\r\n            const cellIndex = Array.from(closestRowCells.values()).indexOf(cell);\r\n            const nextRow = this.#nextRow(closestRow);\r\n            if (nextRow) {\r\n                const nextRowCells = gridRowWidget.cells(nextRow);\r\n                return nextRowCells[Math.min(cellIndex, nextRowCells.length)];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /*#handleContextMenuEvent(event: MouseEvent) {\r\n        const {currentTarget, target} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const selectby = this.getSelectBy(targetGrid);\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const targetCell = (<HTMLElement>target).closest<HTMLElement>(\".gridcell\");\r\n                if (targetCell) {\r\n                    const selectedCells = this.selectedCells(targetGrid);\r\n                    if (!selectedCells.includes(targetCell)) {\r\n                        this.#setCellsSelection(targetCell);\r\n                    }\r\n                    targetCell.focus({preventScroll: true});\r\n                    event.preventDefault();\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const targetRow = (<HTMLElement>target).closest<HTMLElement>(\".gridrow\");\r\n                if (targetRow) {\r\n                    const selectedRows = this.selectedRows(targetGrid);\r\n                    if (!selectedRows.includes(targetRow)) {\r\n                        this.#setRowsSelection(targetRow);\r\n                    }\r\n                    targetRow.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        event.preventDefault();\r\n    }*/\r\n\r\n    /*#handleDragEndEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetTree, null);\r\n    }\r\n\r\n    #handleDragEnterEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".treeitem\");\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        if (targetItem) {\r\n            const type = treeitemWidget.getType(targetItem);\r\n            if (type == \"parent\") {\r\n                treeitemWidget.toggle(targetItem, true);\r\n            }\r\n            this.#setDropTargetItem(targetTree, targetItem);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragOverEvent(event: DragEvent): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragLeaveEvent(event: DragEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        if (relatedTarget) {\r\n            const relatedTargetRoot = (<Node>relatedTarget).getRootNode();\r\n            const relatedTargetHost =\r\n                relatedTargetRoot instanceof ShadowRoot ?\r\n                relatedTargetRoot.host :\r\n                relatedTarget;\r\n            if (!targetTree.contains(<Node>relatedTargetHost)) {\r\n                this.#setDropTargetItem(targetTree, null);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetTree, null);\r\n    }*/\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const selectby = this.getSelectBy(targetGrid);\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const activeCell = this.#getActiveCell(targetGrid);\r\n                if (activeCell && relatedTarget !== activeCell) {\r\n                    activeCell.focus();\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const activeRow = this.#getActiveRow(targetGrid);\r\n                if (activeRow && relatedTarget !== activeRow) {\r\n                    activeRow.focus();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const selectby = this.getSelectBy(targetGrid);\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const targetCell = (<HTMLElement>target).closest<HTMLElement>(\".gridcell\");\r\n                if (targetCell) {\r\n                    this.#setActiveCell(targetGrid, targetCell);\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const targetRow = (<HTMLElement>target).closest<HTMLElement>(\".gridrow\");\r\n                if (targetRow) {\r\n                    this.#setActiveRow(targetGrid, targetRow);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetGrid.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            targetGrid.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent) {\r\n        const {currentTarget, key} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const activeCell = this.#getActiveCell(targetGrid);\r\n        const activeRow = this.#getActiveRow(targetGrid);\r\n        const selectby = this.getSelectBy(targetGrid);\r\n        const multiselectable = this.getMultiSelectable(targetGrid);\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey && multiselectable) {\r\n                    switch (selectby) {\r\n                        case \"cell\": {\r\n                            const firstRow = this.#firstRow(targetGrid);\r\n                            const firstCell = firstRow ? this.#firstCell(firstRow) : null;\r\n                            const lastRow = this.#lastRow(targetGrid);\r\n                            const lastCell = lastRow ? this.#lastCell(lastRow) : null;\r\n                            if (firstCell && lastCell) {\r\n                                const range = this.#getCellsRange(firstCell, lastCell);\r\n                                if (range) {\r\n                                    this.#setCellsSelection(targetGrid, ...range);\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                        case \"row\": {\r\n                            const firstRow = this.#firstRow(targetGrid);\r\n                            const lastRow = this.#lastRow(targetGrid);\r\n                            if (firstRow && lastRow) {\r\n                                const range = this.#getRowsRange(firstRow, lastRow);\r\n                                if (range) {\r\n                                    this.#setRowsSelection(targetGrid, ...range);\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (selectby == \"cell\") {\r\n                    if (activeCell) {\r\n                        const previousCell = this.#previousCell(activeCell);\r\n                        if (previousCell) {\r\n                            previousCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey && multiselectable) {\r\n                                const selected = gridCellWidget.getSelected(previousCell);\r\n                                selected ?\r\n                                    this.#removeCellsFromSelection(targetGrid, previousCell) :\r\n                                    this.#addCellsToSelection(targetGrid, previousCell);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (selectby == \"cell\") {\r\n                    if (activeCell) {\r\n                        const nextCell = this.#nextCell(activeCell);\r\n                        if (nextCell) {\r\n                            nextCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey && multiselectable) {\r\n                                const selected = gridCellWidget.getSelected(nextCell);\r\n                                selected ?\r\n                                    this.#removeCellsFromSelection(targetGrid, nextCell) :\r\n                                    this.#addCellsToSelection(targetGrid, nextCell);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        const firstRow = activeRow ?? this.#firstRow(targetGrid);\r\n                        const topCell = activeCell ?\r\n                            this.#topCell(activeCell) :\r\n                            firstRow ?\r\n                            this.#firstCell(firstRow) :\r\n                            null;\r\n                        if (topCell) {\r\n                            topCell.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey && multiselectable) {\r\n                                const selected = gridCellWidget.getSelected(topCell);\r\n                                selected ?\r\n                                    this.#removeCellsFromSelection(targetGrid, topCell) :\r\n                                    this.#addCellsToSelection(targetGrid, topCell);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const previousRow = activeRow ?\r\n                            this.#previousRow(activeRow) :\r\n                            this.#firstRow(targetGrid);\r\n                        if (previousRow) {\r\n                            previousRow.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey && multiselectable) {\r\n                                const selected = gridRowWidget.getSelected(previousRow);\r\n                                selected ?\r\n                                    this.#removeRowsFromSelection(targetGrid, previousRow) :\r\n                                    this.#addRowsToSelection(targetGrid, previousRow);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        const lastRow = activeRow ?? this.#lastRow(targetGrid);\r\n                        const bottomCell = activeCell ?\r\n                            this.#bottomCell(activeCell) :\r\n                            lastRow ?\r\n                            this.#lastCell(lastRow) :\r\n                            null;\r\n                            if (bottomCell) {\r\n                                bottomCell.focus({preventScroll: true});\r\n                                const {shiftKey} = event;\r\n                                if (shiftKey && multiselectable) {\r\n                                    const selected = gridCellWidget.getSelected(bottomCell);\r\n                                    selected ?\r\n                                        this.#removeCellsFromSelection(targetGrid, bottomCell) :\r\n                                        this.#addCellsToSelection(targetGrid, bottomCell);\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    case \"row\": {\r\n                        const nextRow = activeRow ?\r\n                            this.#nextRow(activeRow) :\r\n                            this.#lastRow(targetGrid);\r\n                        if (nextRow) {\r\n                            nextRow.focus({preventScroll: true});\r\n                            const {shiftKey} = event;\r\n                            if (shiftKey && multiselectable) {\r\n                                const selected = gridRowWidget.getSelected(nextRow);\r\n                                selected ?\r\n                                    this.#removeRowsFromSelection(targetGrid, nextRow) :\r\n                                    this.#addRowsToSelection(targetGrid, nextRow);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeRow) {\r\n                            const firstCell = this.#firstCell(activeRow);\r\n                            if (firstCell) {\r\n                                firstCell.focus({preventScroll: true});\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const firstRow = this.#firstRow(targetGrid);\r\n                        if (firstRow) {\r\n                            firstRow.focus({preventScroll: true});\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeRow) {\r\n                            const lastCell = this.#lastCell(activeRow);\r\n                            if (lastCell) {\r\n                                lastCell.focus({preventScroll: true});\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        const lastRow = this.#lastRow(targetGrid);\r\n                        if (lastRow) {\r\n                            lastRow.focus({preventScroll: true});\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        if (activeCell) {\r\n                            this.#setCellsSelection(targetGrid, activeCell);\r\n                            activeCell.click();\r\n                        }\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        if (activeRow) {\r\n                            this.#setRowsSelection(targetGrid, activeRow);\r\n                            activeRow.click();\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                switch (selectby) {\r\n                    case \"cell\": {\r\n                        this.#clearCellsSelection(targetGrid);\r\n                        this.#setActiveCell(targetGrid, null);\r\n                        break;\r\n                    }\r\n                    case \"row\": {\r\n                        this.#clearRowsSelection(targetGrid);\r\n                        this.#setActiveRow(targetGrid, null);\r\n                        break;\r\n                    }\r\n                }\r\n                targetGrid.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {currentTarget, target, ctrlKey, shiftKey} = event;\r\n        const targetGrid = <HTMLElement>currentTarget;\r\n        const selectby = this.getSelectBy(targetGrid);\r\n        const multiselectable = this.getMultiSelectable(targetGrid);\r\n        switch (selectby) {\r\n            case \"cell\": {\r\n                const targetCell = (<HTMLElement>target).closest<HTMLElement>(\".gridcell\");\r\n                if (targetCell) {\r\n                    if (multiselectable) {\r\n                        if (!shiftKey && !ctrlKey) {\r\n                            this.#setCellsSelection(targetGrid, targetCell);\r\n                        }\r\n                        else if (ctrlKey) {\r\n                            const selected = gridCellWidget.getSelected(targetCell);\r\n                            !selected ?\r\n                                this.#addCellsToSelection(targetGrid, targetCell) :\r\n                                this.#removeCellsFromSelection(targetGrid, targetCell);\r\n                            event.stopPropagation();\r\n                        }\r\n                        else if (shiftKey) {\r\n                            const activeCell = this.#getActiveCell(targetGrid);\r\n                            if (activeCell) {\r\n                                const range = this.#getCellsRange(\r\n                                    activeCell,\r\n                                    targetCell\r\n                                );\r\n                                if (range) {\r\n                                    this.#setCellsSelection(targetGrid, ...range);\r\n                                }\r\n                            }\r\n                            event.stopPropagation();\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.#setCellsSelection(targetGrid, targetCell);\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"row\": {\r\n                const targetRow = (<HTMLElement>target).closest<HTMLElement>(\".gridrow\");\r\n                if (targetRow) {\r\n                    if (multiselectable) {\r\n                        if (!shiftKey && !ctrlKey) {\r\n                            this.#setRowsSelection(targetGrid, targetRow);\r\n                        }\r\n                        else if (ctrlKey) {\r\n                            const selected = gridRowWidget.getSelected(targetRow);\r\n                            !selected ?\r\n                                this.#addRowsToSelection(targetGrid, targetRow) :\r\n                                this.#removeRowsFromSelection(targetGrid, targetRow);\r\n                            event.stopPropagation();\r\n                        }\r\n                        else if (shiftKey) {\r\n                            const activeRow = this.#getActiveRow(targetGrid);\r\n                            if (activeRow) {\r\n                                const range = this.#getRowsRange(\r\n                                    activeRow,\r\n                                    targetRow\r\n                                );\r\n                                if (range) {\r\n                                    this.#setRowsSelection(targetGrid, ...range);\r\n                                }\r\n                            }\r\n                            event.stopPropagation();\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.#setRowsSelection(targetGrid, targetRow);\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(event: Event): void {\r\n        const {currentTarget} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        if (targetList) {\r\n            if (this.#onSelection.get(targetList)) {\r\n                this.#hasSelectionChanged.set(targetList, true);\r\n            }\r\n            else {\r\n                targetList.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { listItemWidget } from \"./ListItemWidget\";\r\n\r\nexport { listItemGroupWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"listitemgroup\": ListItemGroupWidgetFactory\r\n    }\r\n}\r\n\r\ninterface ListItemGroupWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar listItemGroupWidget = new (\r\nWidget({\r\n    name: \"listitemgroup\"\r\n})(class ListItemGroupWidgetFactoryBase extends WidgetFactory implements ListItemGroupWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"ul\", {\r\n            attributes: {\r\n                class: \"listitemgroup\",\r\n                role: \"group\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(group: HTMLElement) {\r\n        return group;\r\n    }\r\n\r\n    slottedCallback(group: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement && child_i.classList.contains(\"listitem\")) {\r\n                listItemWidget.setPosInSet(child_i, i);\r\n            }\r\n        });\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { listItemWidget };\r\n\r\ninterface ListItemWidgetFactory extends WidgetFactory {\r\n    create(init?: {\r\n        label?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement;\r\n    setPosInSet(item: HTMLElement, value: number): void;\r\n    getPosInSet(item: HTMLElement): number;\r\n    getLabel(item: HTMLElement): string;\r\n    setLabel(item: HTMLElement, value: string): void;\r\n    setActive(item: HTMLElement, value: boolean): void;\r\n    getActive(item: HTMLElement): boolean;\r\n    setDropTarget(item: HTMLElement, value: boolean): void;\r\n    getDropTarget(item: HTMLElement): boolean;\r\n    setSelected(item: HTMLElement, value: boolean): void;\r\n    getSelected(item: HTMLElement): boolean;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"listitem\": ListItemWidgetFactory,\r\n    }\r\n}\r\n\r\nvar listItemWidget = new (\r\nWidget({\r\n    name: \"listitem\"\r\n})(class ListItemWidgetFactoryBase extends WidgetFactory implements ListItemWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"li\", {\r\n            attributes: {\r\n                class: \"listitem\",\r\n                role: \"listitem\",\r\n                tabindex: -1\r\n            },\r\n            children: [\r\n                element(\"span\", {\r\n                    attributes: {\r\n                        class: \"label\"\r\n                    }\r\n                })\r\n            ]\r\n        });\r\n    }\r\n\r\n    create(init?: {\r\n        label?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement {\r\n        const item = <HTMLElement>this.#template.cloneNode(true);\r\n        if (init !== undefined) {\r\n            const {label, disabled} = init;\r\n            if (label !== undefined) {\r\n                this.setLabel(item, label);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(item, disabled);\r\n            }\r\n            this.setSelected(item, false);\r\n        }\r\n        return item;\r\n    }\r\n\r\n    slot(root: HTMLElement): HTMLElement | null {\r\n        return root;\r\n    }\r\n\r\n    group(item: HTMLElement): HTMLElement | null {\r\n        return item.querySelector<HTMLElement>(\":scope > .listitemgroup\");\r\n    }\r\n\r\n    getLabel(item: HTMLElement): string {\r\n        return this.#label(item).textContent ?? \"\";\r\n    }\r\n\r\n    setLabel(item: HTMLElement, value: string): void {\r\n        this.#label(item).textContent = value;\r\n    }\r\n\r\n    setPosInSet(item: HTMLElement, value: number): void {\r\n        item.setAttribute(\"aria-posinset\", String(value));\r\n    }\r\n\r\n    getPosInSet(item: HTMLElement): number {\r\n        const posInSet = item.getAttribute(\"aria-posinset\");\r\n        return posInSet ? parseInt(posInSet) : -1;\r\n    }\r\n\r\n    setActive(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"active\");\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"active\");\r\n    }\r\n\r\n    setDropTarget(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    getDropTarget(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"droptarget\");\r\n    }\r\n\r\n    setDisabled(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    getDisabled(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setSelected(row: HTMLElement, value: boolean): void {\r\n        row.setAttribute(\"aria-selected\", String(value));\r\n        row.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n    }\r\n\r\n    getSelected(row: HTMLElement): boolean {\r\n        return JSON.parse(row.getAttribute(\"aria-selected\") ?? String(false));\r\n    }\r\n\r\n    #label(item: HTMLElement): Node {\r\n        return item.querySelector<HTMLElement>(\":scope > .label\")!;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { listItemWidget } from \"./ListItemWidget\";\r\n\r\nexport  { listWidget };\r\n\r\ninterface ListWidgetFactory extends WidgetFactory {\r\n    create(properties: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n    }): HTMLElement;\r\n    items(list: HTMLElement): HTMLElement[];\r\n    beginSelection(list: HTMLElement): void;\r\n    endSelection(list: HTMLElement): void;\r\n    selectedItems(list: HTMLElement): HTMLElement[];\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"list\": ListWidgetFactory,\r\n    }\r\n}\r\n\r\nvar listWidget = new (\r\nWidget({\r\n    name: \"list\"\r\n})(class ListWidgetFactoryBase extends WidgetFactory implements ListWidgetFactory {\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n    #onSelection: WeakMap<HTMLElement, boolean>;\r\n    #hasSelectionChanged: WeakMap<HTMLElement, boolean>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"ul\", {\r\n            attributes: {\r\n                class: \"list\",\r\n                role: \"list\",\r\n                tabindex: 0\r\n            }\r\n        });\r\n        this.#onSelection = new WeakMap();\r\n        this.#hasSelectionChanged = new WeakMap();\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#nodeFilter.bind(this)\r\n        );\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n    }): HTMLElement {\r\n        const list = <HTMLElement>this.#template.cloneNode(true);\r\n        list.addEventListener(\"dragend\", this.#handleDragEndEvent.bind(this));\r\n        list.addEventListener(\"dragenter\", this.#handleDragEnterEvent.bind(this));\r\n        list.addEventListener(\"dragleave\", this.#handleDragLeaveEvent.bind(this));\r\n        list.addEventListener(\"dragover\", this.#handleDragOverEvent.bind(this));\r\n        list.addEventListener(\"dragstart\", this.#handleDragStartEvent.bind(this));\r\n        list.addEventListener(\"drop\", this.#handleDropEvent.bind(this));\r\n        list.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        list.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        list.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        list.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        list.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        list.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, multisectable} = properties;\r\n            if (id !== undefined) {\r\n                list.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                list.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                list.tabIndex = tabIndex;\r\n            }\r\n            if (multisectable !== undefined) {\r\n                this.setMultiSelectable(list, multisectable);\r\n            }\r\n        }\r\n        this.#onSelection.set(list, false);\r\n        this.#hasSelectionChanged.set(list, false);\r\n        return list;\r\n    }\r\n\r\n    slot(list: HTMLElement) {\r\n        return list;\r\n    }\r\n\r\n    slottedCallback(list: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement && child_i.classList.contains(\"listitem\")) {\r\n                listItemWidget.setPosInSet(child_i, i);\r\n            }\r\n        });\r\n    }\r\n\r\n    setMultiSelectable(tree: HTMLElement, value: boolean): void {\r\n        tree.setAttribute(\"aria-multiselectable\", String(value));\r\n    }\r\n\r\n    getMultiSelectable(tree: HTMLElement): boolean {\r\n        return JSON.parse(tree.getAttribute(\"aria-multiselectable\") ?? String(false));\r\n    }\r\n\r\n    #getActiveItem(tree: HTMLElement): HTMLElement | null {\r\n        return tree.querySelector<HTMLElement>(\".listitem.active\");\r\n    }\r\n\r\n    #getDropTargetItem(tree: HTMLElement): HTMLElement | null {\r\n        return tree.querySelector<HTMLElement>(\".listitem.droptarget\");\r\n    }\r\n\r\n    items(list: HTMLElement): HTMLElement[] {\r\n        return Array.from(list.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .listitemgroup) > .listitem\"\r\n        ));\r\n    }\r\n\r\n    selectedItems(list: HTMLElement): HTMLElement[] {\r\n        const selectedItems = [];\r\n        const walker = this.#walker;\r\n        walker.currentNode = list;\r\n        let item = this.#firstItem(list);\r\n        while (item !== null) {\r\n            const selected = listItemWidget.getSelected(item);\r\n            if (selected) {\r\n                selectedItems.push(item);\r\n            }\r\n            item = this.#nextItem(item);\r\n        }\r\n        return selectedItems;\r\n    }\r\n\r\n    beginSelection(list: HTMLElement): void {\r\n        this.#onSelection.set(list, true);\r\n    }\r\n\r\n    endSelection(list: HTMLElement): void {\r\n        this.#onSelection.set(list, false);\r\n        if (this.#hasSelectionChanged.get(list)) {\r\n            list.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged.set(list, false);\r\n        }\r\n    }\r\n\r\n    #nodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"listitem\") && !listItemWidget.getDisabled(node) && !node.hidden) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"listitemgroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getItemsRange(from: HTMLElement, to: HTMLElement): HTMLElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextItem = this.#nextItem(from);\r\n            while (nextItem && nextItem !== to) {\r\n                range.push(nextItem);\r\n                nextItem = this.#nextItem(nextItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousItem = this.#previousItem(from);\r\n            while (previousItem && previousItem !== to) {\r\n                range.push(previousItem);\r\n                previousItem = this.#previousItem(previousItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setSelection(list: HTMLElement, ...items: HTMLElement[]): void {\r\n        const selectedItems = this.selectedItems(list);\r\n        this.beginSelection(list);\r\n        selectedItems.forEach((item_i) => {\r\n            if (!items.includes(item_i)) {\r\n                listItemWidget.setSelected(item_i, false);\r\n            }\r\n        });\r\n        items.forEach((item_i) => {\r\n            const selected = listItemWidget.getSelected(item_i);\r\n            if (list.contains(item_i) && !selected) {\r\n                listItemWidget.setSelected(item_i, true);\r\n            }\r\n        });\r\n        this.endSelection(list);\r\n    }\r\n\r\n    #addToSelection(list: HTMLElement, ...items: HTMLElement[]): void {\r\n        this.beginSelection(list);\r\n        items.forEach((item_i) => {\r\n            if (!listItemWidget.getSelected(item_i)) {\r\n                listItemWidget.setSelected(item_i, true);\r\n            }\r\n        });\r\n        this.endSelection(list);\r\n    }\r\n\r\n    #removeFromSelection(list: HTMLElement, ...items: HTMLElement[]): void {\r\n        const selectedItems = this.selectedItems(list);\r\n        this.beginSelection(list);\r\n        items.forEach((item_i) => {\r\n            if (selectedItems.includes(item_i)) {\r\n                listItemWidget.setSelected(item_i, false);\r\n            }\r\n        });\r\n        this.endSelection(list);\r\n    }\r\n\r\n    #clearSelection(list: HTMLElement): void {\r\n        const selectedItems = this.selectedItems(list);\r\n        this.beginSelection(list);\r\n        selectedItems.forEach((item_i) => {\r\n            listItemWidget.setSelected(item_i, false);\r\n        });\r\n        this.endSelection(list);\r\n    }\r\n\r\n    #setActiveItem(list: HTMLElement, item: HTMLElement | null): void {\r\n        const activeItem = this.#getActiveItem(list);\r\n        if (activeItem !== null && activeItem !== item) {\r\n            listItemWidget.setActive(activeItem, false);\r\n            activeItem.tabIndex = -1;\r\n        }\r\n        if (item !== null) {\r\n            listItemWidget.setActive(item, true);\r\n            item.tabIndex = 0;\r\n        }\r\n    }\r\n    \r\n    #setDropTargetItem(list: HTMLElement, item: HTMLElement | null): void {\r\n        const {classList} = list;\r\n        const dropTargetItem = this.#getDropTargetItem(list);\r\n        if (dropTargetItem !== null && dropTargetItem !== item) {\r\n            listItemWidget.setDropTarget(dropTargetItem, false);\r\n        }\r\n        if (item !== null) {\r\n            listItemWidget.setDropTarget(item, false);\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    #firstItem(list: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = list;\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(list: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = list;\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousItem = <HTMLElement | null>walker.previousNode();\r\n        return previousItem;\r\n    }\r\n\r\n    #nextItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const nextItem = <HTMLElement | null>walker.nextNode();\r\n        return nextItem;\r\n    }\r\n\r\n    #handleDragEndEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetList, null);\r\n    }\r\n\r\n    #handleDragEnterEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".listitem\");\r\n        const targetList = <HTMLElement>currentTarget;\r\n        if (targetItem) {\r\n            this.#setDropTargetItem(targetList, targetItem);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragOverEvent(event: DragEvent): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragLeaveEvent(event: DragEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        if (relatedTarget) {\r\n            const relatedTargetRoot = (<Node>relatedTarget).getRootNode();\r\n            const relatedTargetHost =\r\n                relatedTargetRoot instanceof ShadowRoot ?\r\n                relatedTargetRoot.host :\r\n                relatedTarget;\r\n            if (!targetList.contains(<Node>relatedTargetHost)) {\r\n                this.#setDropTargetItem(targetList, null);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDragStartEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".listitem\");\r\n        if (targetItem) {\r\n            const selectedItems = this.selectedItems(targetTree);\r\n            if (!selectedItems.includes(targetItem)) {\r\n                this.#setSelection(targetTree, targetItem);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetTree, null);\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const activeItem = this.#getActiveItem(targetTree);\r\n        if (activeItem && relatedTarget !== activeItem) {\r\n            activeItem.focus();\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".listitem\");\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetTree, targetItem);\r\n            targetTree.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent) {\r\n        const {currentTarget, key} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        const activeItem = this.#getActiveItem(targetList);\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey) {\r\n                    if (activeItem) {\r\n                        const walker = this.#walker;\r\n                        walker.currentNode = activeItem;\r\n                        const firstItem = <HTMLElement>(\r\n                            walker.currentNode = walker.parentNode() ?? targetList, walker.firstChild()\r\n                        );\r\n                        const lastItem = <HTMLElement>(\r\n                            walker.currentNode = walker.parentNode() ?? targetList, walker.lastChild()\r\n                        );\r\n                        if (firstItem && lastItem) {\r\n                            const range = this.#getItemsRange(firstItem, lastItem);\r\n                            if (range) {\r\n                                this.#setSelection(targetList, ...range);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            const selected = listItemWidget.getSelected(previousItem);\r\n                            selected ?\r\n                                this.#removeFromSelection(targetList, previousItem) :\r\n                                this.#addToSelection(targetList, previousItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.#firstItem(targetList);\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            const selected = listItemWidget.getSelected(nextItem);\r\n                            selected ?\r\n                                this.#removeFromSelection(targetList, nextItem) :\r\n                                this.#addToSelection(targetList, nextItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem(targetList);\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.#firstItem(targetList);\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem(targetList);\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                if (activeItem) {\r\n                    this.#setSelection(targetList, activeItem);\r\n                    activeItem.click();\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                this.#clearSelection(targetList);\r\n                this.#setActiveItem(targetList, null);\r\n                targetList.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {currentTarget, target, ctrlKey, shiftKey, button} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".listitem\");\r\n        if (targetItem) {\r\n            const selected = listItemWidget.getSelected(targetItem);\r\n            switch (button) {\r\n                case 0: {\r\n                    if (!shiftKey && !ctrlKey) {\r\n                        this.#setSelection(targetList, targetItem);\r\n                    }\r\n                    else if (ctrlKey) {\r\n                        if (selected) {\r\n                            targetItem.blur();\r\n                            this.#removeFromSelection(targetList, targetItem);\r\n                        }\r\n                        else {\r\n                            this.#addToSelection(targetList, targetItem);\r\n                        }\r\n                        event.stopPropagation();\r\n                    }\r\n                    else if (shiftKey) {\r\n                        const activeItem = this.#getActiveItem(targetList);\r\n                        if (activeItem) {\r\n                            const range = this.#getItemsRange(\r\n                                activeItem,\r\n                                targetItem\r\n                            );\r\n                            if (range) {\r\n                                this.#setSelection(targetList, ...range);\r\n                            }\r\n                        }\r\n                        event.stopPropagation();\r\n                    }\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    if (!selected) {\r\n                        this.#setSelection(targetList, targetItem);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetList.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            targetList.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(event: Event): void {\r\n        const {currentTarget} = event;\r\n        const targetList = <HTMLElement>currentTarget;\r\n        if (targetList) {\r\n            if (this.#onSelection.get(targetList)) {\r\n                this.#hasSelectionChanged.set(targetList, true);\r\n            }\r\n            else {\r\n                targetList.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { menuItemWidget } from \"./MenuItemWidget\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { menuBarWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"menubar\": MenuBarWidgetFactory\r\n    }\r\n}\r\n\r\ninterface MenuBarWidgetFactory extends WidgetFactory {\r\n    setExpanded(menubar: HTMLElement, value: boolean): void;\r\n    getExpanded(menubar: HTMLElement): boolean;\r\n}\r\n\r\nvar menuBarWidget = new (\r\nWidget({\r\n    name: \"menubar\"\r\n})(class MenubarWidgetFactoryBase extends WidgetFactory {\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"menubar\",\r\n                role: \"menubar\",\r\n                tabindex: 0\r\n            }\r\n        });\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        )\r\n    }\r\n\r\n    create() {\r\n        const menubar = <HTMLElement>this.#template.cloneNode(true);\r\n        menubar.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        menubar.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        menubar.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        menubar.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        menubar.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        return menubar;\r\n    }\r\n\r\n    slot(menubar: HTMLElement) {\r\n        return menubar;\r\n    }\r\n\r\n    setExpanded(menubar: HTMLElement, value: boolean): void {\r\n        menubar.toggleAttribute(\"aria-expanded\", value);\r\n    }\r\n\r\n    getExpanded(menubar: HTMLElement): boolean {\r\n        return menubar.hasAttribute(\"aria-expanded\");\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node) {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"menuitem\") && !menuItemWidget.getDisabled(node)) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"menuitemgroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getActiveItem(menubar: HTMLElement): HTMLElement | null {\r\n        return menubar.querySelector<HTMLElement>(\r\n            \":is(:scope, :scope > .menuitemgroup) > .menuitem:focus-within\"\r\n        );\r\n    }\r\n\r\n    #firstItem(menubar: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = menubar;\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(menubar: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = menubar;\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n\r\n    #previousItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLElement | null>walker.previousSibling();\r\n    }\r\n\r\n    #nextItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #firstChildItem(item: HTMLElement): HTMLElement | null {\r\n        const menu = menuItemWidget.getMenu(item);\r\n        if (menu) {\r\n            const walker = this.#walker;\r\n            walker.currentNode = menu;\r\n            return <HTMLElement | null>walker.firstChild();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #isClosestMenu(menubar: HTMLElement, target: HTMLElement): boolean {\r\n        return target.closest(\":is(.menubar, .menu)\") == menubar;\r\n    }\r\n\r\n    #nearestItem(menubar: HTMLElement, target: HTMLElement): HTMLElement | null {\r\n        return Array.from(menubar.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .menuitemgroup) > .menuitem\"\r\n        )).find(item_i => item_i.contains(target)) ?? null;\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const menubar = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".menuitem\");\r\n        if (targetItem) {\r\n            const expanded = this.getExpanded(menubar);\r\n            const isClosestMenu = this.#isClosestMenu(menubar, targetItem);\r\n            if (isClosestMenu) {\r\n                const isExpanded = !expanded;\r\n                this.setExpanded(menubar, isExpanded);\r\n                if (isExpanded) {\r\n                    if (targetItem !== null && !menuItemWidget.getExpanded(targetItem)) {\r\n                        menuItemWidget.expand(targetItem);\r\n                    }\r\n                    const menu = menuItemWidget.getMenu(targetItem);\r\n                    menu?.focus({preventScroll: true});\r\n                }\r\n                else {\r\n                    menubar.focus({preventScroll: true})\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const menubar = <HTMLElement>currentTarget;\r\n        if (target instanceof HTMLElement && this.getExpanded(menubar)) {\r\n            const nearestItem = this.#nearestItem(menubar, target);\r\n            if (nearestItem) {\r\n                menuItemWidget.expand(nearestItem);\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {target, currentTarget, relatedTarget} = event;\r\n        const menubar = <HTMLElement>currentTarget;\r\n        if (target instanceof HTMLElement && !target.contains(<Element>relatedTarget)) {\r\n            const nearestItem = this.#nearestItem(menubar, target);\r\n            if (nearestItem) {\r\n                menuItemWidget.collapse(nearestItem);\r\n            }\r\n        }\r\n        const lostFocusWithin = !menubar.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.setExpanded(menubar, false);\r\n        }\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const menubar = <HTMLElement>currentTarget;\r\n        if (target instanceof HTMLElement && target.classList.contains(\"menuitem\")) {\r\n            const activeItem = this.#getActiveItem(menubar);\r\n            const expanded = this.getExpanded(menubar);\r\n            const isClosestMenu = this.#isClosestMenu(menubar, target);\r\n            if (isClosestMenu && target !== activeItem && expanded) {\r\n                const menu = menuItemWidget.getMenu(target);\r\n                if (menu) {\r\n                    menu.focus({preventScroll: true});\r\n                }\r\n                else {\r\n                    target.focus({preventScroll: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {key, currentTarget} = event;\r\n        const menubar = <HTMLElement>currentTarget;\r\n        let activeItem = this.#getActiveItem(menubar);\r\n        const expanded = this.getExpanded(menubar);\r\n        switch (key) {\r\n            case \"ArrowLeft\": {\r\n                const previousItem = activeItem ?\r\n                    this.#previousItem(activeItem) ?? this.#lastItem(menubar) :\r\n                    this.#firstItem(menubar);\r\n                previousItem?.focus({preventScroll: true});\r\n                activeItem = this.#getActiveItem(menubar);\r\n                if (expanded && activeItem) {\r\n                    const firstChildItem = this.#firstChildItem(activeItem);\r\n                    firstChildItem?.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                const nextItem = activeItem ?\r\n                    this.#nextItem(activeItem) ?? this.#firstItem(menubar) : \r\n                    this.#lastItem(menubar);\r\n                nextItem?.focus({preventScroll: true});\r\n                activeItem = this.#getActiveItem(menubar);\r\n                if (expanded && activeItem) {\r\n                    const firstChildItem = this.#firstChildItem(activeItem);\r\n                    firstChildItem?.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n            case \"Enter\":\r\n            case \" \": {\r\n                if (activeItem) {\r\n                    this.setExpanded(menubar, !expanded);\r\n                    const firstChildItem = this.#firstChildItem(activeItem);\r\n                    firstChildItem?.focus({preventScroll: true});\r\n                    event.preventDefault();\r\n                }\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (expanded) {\r\n                    this.setExpanded(menubar, false);\r\n                    if (activeItem) {\r\n                        menuItemWidget.collapse(activeItem);\r\n                        activeItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    menubar.focus({preventScroll: true});\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { menuItemGroupWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"menuitemgroup\": MenuItemGroupWidgetFactory\r\n    }\r\n}\r\n\r\ninterface MenuItemGroupWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar menuItemGroupWidget = new (\r\nWidget({\r\n    name: \"menuitemgroup\"\r\n})(class MenuItemGroupWidgetFactoryBase extends WidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"menuitemgroup\",\r\n                role: \"group\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(group: HTMLElement): HTMLElement | null {\r\n        return group;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { menuItemWidget };\r\n\r\ntype MenuItemType = \"button\" | \"radio\" | \"checkbox\" | \"menu\" | \"submenu\";\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"menuitem\": MenuItemWidgetFactory\r\n    }\r\n}\r\n\r\ninterface MenuItemWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        type?: MenuItemType;\r\n        checked?: boolean;\r\n        label?: string;\r\n        name?: string;\r\n        keyshortcut?: string;\r\n        value?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement;\r\n    slottedCallback(item: HTMLElement, slot: HTMLElement): void;\r\n    getMenu(item: HTMLElement): HTMLElement | null;\r\n    getKeyShortcut(item: HTMLElement): string | null;\r\n    setKeyShortcut(item: HTMLElement, value: string | null): void;\r\n    getLabel(item: HTMLElement): string;\r\n    setLabel(item: HTMLElement, value: string): void;\r\n    getType(item: HTMLElement): MenuItemType | null;\r\n    setType(item: HTMLElement, type: MenuItemType): void;\r\n    getValue(item: HTMLElement): string;\r\n    setValue(item: HTMLElement, value: string): void;\r\n    getName(item: HTMLElement): string;\r\n    setName(item: HTMLElement, value: string): void;\r\n    getChecked(item: HTMLElement): boolean;\r\n    setChecked(item: HTMLElement, value: boolean): void;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n    setExpanded(item: HTMLElement, value: boolean): void;\r\n    getExpanded(item: HTMLElement): boolean;\r\n    toggle(item: HTMLElement, force?: boolean): void;\r\n    expand(item: HTMLElement): void;\r\n    collapse(item: HTMLElement): void;\r\n}\r\n\r\nvar menuItemWidget = new(\r\nWidget({\r\n    name: \"menuitem\"\r\n})(\r\nclass MenuItemWidgetFactoryBase extends WidgetFactory implements MenuItemWidgetFactory {\r\n    #iconPartTemplate: HTMLElement;\r\n    #arrowPartTemplate : HTMLElement;\r\n    #keyshortcutsPartTemplate: HTMLElement;\r\n    #template: HTMLElement;\r\n    #types: MenuItemType[];\r\n    #typesFeatures: {\r\n        [key in MenuItemType]: {\r\n            role: string,\r\n            hasIcon: boolean,\r\n            hasArrow: boolean\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n        this.#iconPartTemplate = element(\"span\", {\r\n            attributes: {\r\n                class: \"icon\"\r\n            }\r\n        });\r\n        this.#arrowPartTemplate = element(\"span\", {\r\n            attributes: {\r\n                class: \"arrow\"\r\n            }\r\n        });\r\n        this.#keyshortcutsPartTemplate = element(\"span\", {\r\n            attributes: {\r\n                class: \"keyshortcuts\"\r\n            }\r\n        });\r\n        this.#template = element(\"button\", {\r\n            attributes: {\r\n                class: \"menuitem\",\r\n                role: \"menuitem\",\r\n                type: \"button\",\r\n                tabindex: -1\r\n            },\r\n            children: [\r\n                this.#iconPartTemplate.cloneNode(true),\r\n                element(\"span\", {\r\n                    attributes: {\r\n                        class: \"label\"\r\n                    }\r\n                })\r\n            ]\r\n        });\r\n        this.#types = [\"checkbox\", \"radio\", \"menu\", \"submenu\", \"button\"];\r\n        this.#typesFeatures = {\r\n            button: {\r\n                role: \"menuitem\",\r\n                hasIcon: true,\r\n                hasArrow: false\r\n            },\r\n            checkbox: {\r\n                role: \"menuitemcheckbox\",\r\n                hasIcon: true,\r\n                hasArrow: false\r\n            },\r\n            radio: {\r\n                role: \"menuitemradio\",\r\n                hasIcon: true,\r\n                hasArrow: false\r\n            },\r\n            menu: {\r\n                role: \"menuitem\",\r\n                hasIcon: false,\r\n                hasArrow: false\r\n            },\r\n            submenu: {\r\n                role: \"menuitem\",\r\n                hasIcon: true,\r\n                hasArrow: true\r\n            }\r\n        }\r\n    }\r\n\r\n    create(init?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        type: MenuItemType;\r\n        checked?: boolean;\r\n        label?: string;\r\n        name?: string;\r\n        keyshortcut?: string;\r\n        value?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement {\r\n        const item = <HTMLElement>this.#template.cloneNode(true);\r\n        item.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        if (init !== undefined) {\r\n            const {id, classList, tabIndex, keyshortcut, checked, type, label, name, value, disabled} = init;\r\n            if (id !== undefined) {\r\n                item.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                item.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                item.tabIndex = tabIndex;\r\n            }\r\n            if (keyshortcut !== undefined) {\r\n                this.setKeyShortcut(item, keyshortcut);\r\n            }\r\n            if (checked !== undefined) {\r\n                this.setChecked(item, checked);\r\n            }\r\n            if (type !== undefined) {\r\n                if (type == \"menu\" || type == \"submenu\") {\r\n                    this.setExpanded(item, false);\r\n                }\r\n                this.setType(item, type);\r\n            }\r\n            if (label !== undefined) {\r\n                this.setLabel(item, label);\r\n            }\r\n            if (name !== undefined) {\r\n                this.setName(item, name);\r\n            }\r\n            if (value !== undefined) {\r\n                this.setValue(item, value);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(item, disabled);\r\n            }\r\n        }\r\n        return item;\r\n    }\r\n\r\n    slot(item: HTMLElement): HTMLElement | null {\r\n        return item;\r\n    }\r\n\r\n    slottedCallback(item: HTMLElement, slot: HTMLElement): void {\r\n        const hasChildMenu = Array.from(slot.childNodes).some(\r\n            childNode_i => childNode_i instanceof HTMLElement && childNode_i.classList.contains(\"menu\")\r\n        );\r\n        item.setAttribute(\"aria-haspopup\", String(hasChildMenu));\r\n    }\r\n\r\n    #label(item: HTMLElement): HTMLElement {\r\n        return item.querySelector<HTMLElement>(\":scope > .label\")!;\r\n    }\r\n\r\n    getMenu(item: HTMLElement): HTMLElement | null {\r\n        return item.querySelector<HTMLElement>(\":scope > .menu\");\r\n    }\r\n\r\n    getKeyShortcut(item: HTMLElement): string | null {\r\n        return item.getAttribute(\"aria-keyshortcuts\");\r\n    }\r\n\r\n    setKeyShortcut(item: HTMLElement, value: string | null): void {\r\n        let keyshortcutsPart = item.querySelector(\":scope > .keyshortcuts\");\r\n        if (value !== null) {\r\n            item.setAttribute(\"aria-keyshortcuts\", value);\r\n            if (!keyshortcutsPart) {\r\n                const labelPart = this.#label(item);\r\n                const keyshortcutsPartTemplate = this.#keyshortcutsPartTemplate;\r\n                keyshortcutsPart = <HTMLElement>keyshortcutsPartTemplate.cloneNode(true);\r\n                labelPart.after(keyshortcutsPart);\r\n            }\r\n            keyshortcutsPart.textContent = value;\r\n        }\r\n        else {\r\n            item.removeAttribute(\"aria-keyshortcuts\");\r\n            if (keyshortcutsPart) {\r\n                keyshortcutsPart.remove();\r\n            }\r\n        }\r\n    }\r\n\r\n    getLabel(item: HTMLElement): string {\r\n        return this.#label(item).textContent ?? \"\";\r\n    }\r\n\r\n    setLabel(item: HTMLElement, value: string): void {\r\n        this.#label(item).textContent = value;\r\n    }\r\n    \r\n    getType(item: HTMLElement): MenuItemType | null {\r\n        const types = this.#types;\r\n        const {classList} = item;\r\n        for (let type_i of types) {\r\n            if (classList.contains(`menuitem-${type_i}`)) {\r\n                return type_i;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    setType(item: HTMLElement, type: MenuItemType): void {\r\n        const typesFeatures = this.#typesFeatures;\r\n        const iconPartTemplate = this.#iconPartTemplate;\r\n        const arrowPartTemplate = this.#arrowPartTemplate;\r\n        const {role, hasIcon, hasArrow} = typesFeatures[type];\r\n        const oldType = this.getType(item);\r\n        const {classList} = item;\r\n        if (oldType) {\r\n            classList.remove(`menuitem-${oldType}`);\r\n        }\r\n        classList.add(`menuitem-${type}`);\r\n        item.setAttribute(\"role\", role);\r\n        const labelPart = this.#label(item);\r\n        const iconPart = item.querySelector(\":scope > .icon\");\r\n        const arrowPart = item.querySelector(\":scope > .arrow\");\r\n        if (hasIcon) {\r\n            if (!iconPart && labelPart) {\r\n                labelPart.before(iconPartTemplate.cloneNode(true));\r\n            }\r\n        }\r\n        else {\r\n            if (iconPart) {\r\n                iconPart.remove();\r\n            }\r\n        }\r\n        if (hasArrow) {\r\n            if (!arrowPart && labelPart) {\r\n                labelPart.after(arrowPartTemplate.cloneNode(true));\r\n            }\r\n        }\r\n        else {\r\n            if (arrowPart) {\r\n                arrowPart.remove();\r\n            }\r\n        }\r\n    }\r\n\r\n    getValue(item: HTMLElement): string {\r\n        return item.getAttribute(\"value\") ?? \"\";\r\n    }\r\n\r\n    setValue(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"value\", value);\r\n    }\r\n    \r\n    getName(item: HTMLElement): string {\r\n        return item.getAttribute(\"name\") ?? \"\";\r\n    }\r\n\r\n    setName(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"name\", value);\r\n    }\r\n\r\n    getChecked(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-checked\") ?? String(false));\r\n    }\r\n\r\n    setChecked(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-checked\", String(value));\r\n    }\r\n\r\n    getDisabled(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setDisabled(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    setExpanded(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-expanded\", String(value));\r\n    }\r\n\r\n    getExpanded(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-expanded\") ?? String(false));\r\n    }\r\n\r\n    toggle(item: HTMLElement, force?: boolean): void {\r\n        const expand = force ?? !this.getExpanded(item);\r\n        this.setExpanded(item, expand);\r\n        if (expand) {\r\n            this.#positionMenu(item);\r\n        }\r\n    }\r\n\r\n    expand(item: HTMLElement): void {\r\n        const expanded = this.getExpanded(item);\r\n        if (!expanded) {\r\n            this.setExpanded(item, true);\r\n            this.#positionMenu(item);\r\n        }\r\n    }\r\n\r\n    collapse(item: HTMLElement): void {\r\n        const expanded = this.getExpanded(item);\r\n        if (expanded) {\r\n            this.setExpanded(item, false);\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".menuitem\");\r\n        if (targetItem == currentTarget) {\r\n            const type = this.getType(targetItem);\r\n            switch (type) {\r\n                case \"checkbox\": {\r\n                    this.setChecked(targetItem, !this.getChecked(targetItem));\r\n                    break;\r\n                }\r\n                case \"radio\": {\r\n                    this.setChecked(targetItem, true);\r\n                    break;\r\n                }\r\n                case \"menu\":\r\n                case \"submenu\": {\r\n                    this.toggle(targetItem);\r\n                    if (this.getExpanded(targetItem)) {\r\n                        this.getMenu(targetItem)?.focus({preventScroll: true});\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #positionMenu(item: HTMLElement): void {\r\n        const menu = this.getMenu(item);\r\n        if (menu !== null) {\r\n            const {style: menuStyle} = menu;\r\n            const {top: itemTop, bottom: itemBottom, left: itemLeft, right: itemRight} = item.getBoundingClientRect();\r\n            const {width: menuWidth, height: menuHeight} = menu.getBoundingClientRect();\r\n            const {scrollY, scrollX} = window;\r\n            const {clientWidth, clientHeight} = document.body;\r\n            const type = this.getType(item);\r\n            if (type == \"menu\") {\r\n                const overflowX = itemRight + menuWidth - clientWidth;\r\n                const overflowY = itemTop + menuHeight - clientHeight;\r\n                menuStyle.setProperty(\"left\", `${\r\n                    overflowX > 0 ?\r\n                    scrollX + itemLeft - menuWidth :\r\n                    scrollX + itemLeft\r\n                }px`);\r\n                menuStyle.setProperty(\"top\", `${\r\n                    overflowY > 0 ?\r\n                    scrollY + itemTop - menuHeight :\r\n                    scrollY + itemBottom\r\n                }px`);\r\n            }\r\n            else {\r\n                const closestMenu = item.closest(\".menu\");\r\n                if (closestMenu !== null) {\r\n                    const {top: closestMenuTop, left: closestMenuLeft} = closestMenu.getBoundingClientRect();\r\n                    const overflowX = itemRight + menuWidth - clientWidth;\r\n                    const overflowY = itemTop + menuHeight - clientHeight;\r\n                    menuStyle.setProperty(\"left\", `${\r\n                        overflowX > 0 ?\r\n                        itemLeft - menuWidth - closestMenuLeft :\r\n                        itemRight - closestMenuLeft\r\n                    }px`);\r\n                    const menuComputedStyle = window.getComputedStyle(menu);\r\n                    const {paddingTop, paddingBottom} = menuComputedStyle;\r\n                    const menuPaddingTop = parseFloat(paddingTop);\r\n                    const menuPaddingBottom = parseFloat(paddingBottom);\r\n                    menuStyle.setProperty(\"top\", `${\r\n                        overflowY > 0 ?\r\n                        itemBottom - menuHeight - closestMenuTop + menuPaddingBottom :\r\n                        itemTop - closestMenuTop - menuPaddingTop\r\n                    }px`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { menuItemWidget } from \"./MenuItemWidget\";\r\n\r\nexport { menuWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"menu\": MenuWidgetFactory\r\n    }\r\n}\r\n\r\ninterface MenuWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        contextual?: boolean;\r\n        position?: {x: number, y: number};\r\n    }): HTMLElement;\r\n    setPosition(menu: HTMLElement, x: number, y: number): void;\r\n    getContextual(menu: HTMLElement): boolean;\r\n    setContextual(menu: HTMLElement, value: boolean): void;\r\n    items(menu: HTMLElement): HTMLElement[];\r\n}\r\n\r\nvar mouseOverExpandDelay = 0_200;\r\nvar mouseOutCollapseDelay = 0_400;\r\n\r\nvar menuWidget = new (\r\nWidget({\r\n    name: \"menu\"\r\n})(class MenuWidgetFactoryBase extends WidgetFactory implements MenuWidgetFactory {\r\n\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n    #toggleTimeouts: WeakMap<HTMLElement, {clear(): void;}>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"menu\",\r\n                role: \"menu\",\r\n                tabindex: -1\r\n            }\r\n        });\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        );\r\n        this.#toggleTimeouts = new WeakMap();\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        contextual?: boolean;\r\n        position?: {x: number, y: number};\r\n    }): HTMLElement {\r\n        const menu = <HTMLElement>this.#template.cloneNode(true);\r\n        menu.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        menu.addEventListener(\"mouseover\", this.#handleMouseOverEvent.bind(this));\r\n        menu.addEventListener(\"mouseout\", this.#handleMouseOutEvent.bind(this));\r\n        menu.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        menu.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, contextual, position} = properties;\r\n            if (id !== undefined) {\r\n                menu.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                menu.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                menu.tabIndex = tabIndex;\r\n            }\r\n            if (contextual !== undefined) {\r\n                this.setContextual(menu, contextual);\r\n            }\r\n            if (position !== undefined) {\r\n                const {x, y} = position;\r\n                this.setPosition(menu, x, y);\r\n            }\r\n        }\r\n        return menu;\r\n    }\r\n\r\n    slot(menu: HTMLElement): HTMLElement | null {\r\n        return menu;\r\n    }\r\n\r\n    setPosition(menu: HTMLElement, x: number, y: number): void {\r\n        const {style} = menu;\r\n        const {width: menuWidth, height: menuHeight} = menu.getBoundingClientRect();\r\n        const {scrollX, scrollY} = window;\r\n        const left = x + scrollX;\r\n        const top = y + scrollY;\r\n        const {clientWidth, clientHeight} = document.body;\r\n        const overflowX = left + menuWidth - clientWidth;\r\n        const overflowY = top + menuHeight - clientHeight;\r\n        style.setProperty(\"left\", `${overflowX > 0 ? left - menuWidth : left}px`);\r\n        style.setProperty(\"top\", `${overflowY > 0 ? top - menuHeight : top}px`);\r\n    }\r\n\r\n    getContextual(menu: HTMLElement): boolean {\r\n        const {classList} = menu;\r\n        return classList.contains(\"menu-contextual\");\r\n    }\r\n\r\n    setContextual(menu: HTMLElement, value: boolean): void {\r\n        const {classList} = menu;\r\n        if (value) {\r\n            classList.add(\"menu-contextual\");\r\n        }\r\n        else {\r\n            classList.remove(\"menu-contextual\");\r\n        }\r\n    }\r\n\r\n    items(menu: HTMLElement): HTMLElement[] {\r\n        return Array.from(menu.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .menuitemgroup) > .menuitem\"\r\n        ));\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"menuitem\") && !menuItemWidget.getDisabled(node)) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"menuitemgroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #collapseSubmenus(menu: HTMLElement): void {\r\n        menu.querySelectorAll<HTMLElement>(\":is(:scope, :scope > .menuitemgroup) > .menuitem[aria-expanded]\")\r\n            .forEach(menuitem_i => menuItemWidget.collapse(menuitem_i));\r\n    }\r\n\r\n    #isClosestMenu(menu: HTMLElement, target: HTMLElement): boolean {\r\n        return target.closest(\".menu\") == menu;\r\n    }\r\n\r\n    #nearestItem(menu: HTMLElement, target: HTMLElement): HTMLElement | null {\r\n        return Array.from(menu.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .menuitemgroup) > .menuitem\"\r\n        )).find(item_i => item_i.contains(target)) ?? null;\r\n    }\r\n\r\n    #firstItem(menu: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = menu;\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(menu: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = menu;\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n\r\n    #previousItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLElement | null>walker.previousSibling();\r\n    }\r\n\r\n    #nextItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #firstChildItem(item: HTMLElement): HTMLElement | null {\r\n        const menu = menuItemWidget.getMenu(item);\r\n        if (menu) {\r\n            const walker = this.#walker;\r\n            walker.currentNode = menu;\r\n            return <HTMLElement | null>walker.firstChild();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #getActiveItem(menu: HTMLElement): HTMLElement | null {\r\n        return menu.querySelector<HTMLElement>(\r\n            \":is(:scope, :scope > .menuitemgroup) > .menuitem:focus-within\"\r\n        );\r\n    }\r\n\r\n    async #setItemTimeout(item: HTMLElement, delay?: number): Promise<void> {\r\n        return new Promise((resolve, reject) => {\r\n            const timeout = setTimeout(() => {\r\n                resolve(undefined);\r\n            }, delay ?? 0);\r\n            this.#toggleTimeouts.set(item, {\r\n                clear: () => {\r\n                    clearTimeout(timeout);\r\n                    reject();\r\n                }\r\n            });\r\n        }).then(() => {\r\n            this.#toggleTimeouts.delete(item);\r\n        });\r\n    }\r\n\r\n    #clearItemTimeout(item: HTMLElement): void {\r\n        const timeout = this.#toggleTimeouts.get(item);\r\n        if (typeof timeout !== \"undefined\") {\r\n            this.#toggleTimeouts.delete(item);\r\n            timeout.clear();\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const targetMenu = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".menuitem\");\r\n        if (targetItem) {\r\n            const contextual = this.getContextual(targetMenu);\r\n            if (contextual) {\r\n                try {\r\n                    targetMenu.remove();\r\n                }\r\n                catch (error) {};\r\n            }\r\n            else {\r\n                const isClosestMenu = this.#isClosestMenu(targetMenu, targetItem);\r\n                if (isClosestMenu) {\r\n                    const type = menuItemWidget.getType(targetItem);\r\n                    const name = menuItemWidget.getName(targetItem);\r\n                    const value = menuItemWidget.getValue(targetItem);\r\n                    if (type == \"radio\") {\r\n                        targetMenu.querySelectorAll<HTMLElement>(\r\n                            `:is(:scope, :scope > .menuitemgroup) > .menuitem-radio[name=${name}]`\r\n                        )\r\n                        .forEach((radio_i) => {\r\n                            menuItemWidget.setChecked(radio_i, menuItemWidget.getValue(radio_i) == value);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n            event.stopPropagation();\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {target, currentTarget, relatedTarget} = event;\r\n        const targetMenu = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetMenu.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            const contextual = this.getContextual(targetMenu);\r\n            if (contextual) {\r\n                try {\r\n                    targetMenu.remove();\r\n                } catch (error) {\r\n                    undefined;\r\n                }\r\n            }\r\n            else {\r\n                const nearestItem = this.#nearestItem(targetMenu, <HTMLElement>target);\r\n                if (nearestItem) {\r\n                    menuItemWidget.collapse(nearestItem);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {currentTarget, key} = event;\r\n        const targetMenu = <HTMLElement>currentTarget;\r\n        const activeItem = this.#getActiveItem(targetMenu);\r\n        switch (key) {\r\n            case \"ArrowUp\": {\r\n                const previousItem = activeItem ?\r\n                    this.#previousItem(activeItem) ?? this.#lastItem(targetMenu) :\r\n                    this.#firstItem(targetMenu);\r\n                previousItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                const nextItem = activeItem ?\r\n                    this.#nextItem(activeItem) ?? this.#firstItem(targetMenu) :\r\n                    this.#firstItem(targetMenu);\r\n                nextItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.#firstItem(targetMenu);\r\n                firstItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem(targetMenu);\r\n                lastItem?.focus({preventScroll: true});\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\":\r\n            case \" \": {\r\n                if (activeItem) {\r\n                    const type = menuItemWidget.getType(activeItem);\r\n                    switch (type) {\r\n                        case \"submenu\": {\r\n                            menuItemWidget.expand(activeItem);\r\n                            const firstChildItem = this.#firstChildItem(activeItem);\r\n                            firstChildItem?.focus({preventScroll: true});\r\n                            event.preventDefault();\r\n                            break;\r\n                        }\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (activeItem) {\r\n                    const isTargetClosestMenu = event.composedPath().find(\r\n                        target_i => target_i instanceof HTMLElement && target_i.classList.contains(\"menu\")\r\n                    ) == targetMenu;\r\n                    if (!isTargetClosestMenu) {\r\n                        menuItemWidget.collapse(activeItem);\r\n                        activeItem.focus({preventScroll: true});\r\n                        event.stopPropagation();\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const isTargetClosestMenu = event.composedPath().find(\r\n                        target_i => target_i instanceof HTMLElement && target_i.classList.contains(\"menu\")\r\n                    ) == targetMenu;\r\n                    if (!isTargetClosestMenu) {\r\n                        menuItemWidget.collapse(activeItem);\r\n                        activeItem.focus({preventScroll: true});\r\n                        event.stopPropagation();\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const type = menuItemWidget.getType(activeItem);\r\n                    switch (type) {\r\n                        case \"submenu\": {\r\n                            const expanded = menuItemWidget.getExpanded(activeItem);\r\n                            if (!expanded) {\r\n                                menuItemWidget.expand(activeItem);\r\n                                const firstChildItem = this.#firstChildItem(activeItem);\r\n                                firstChildItem?.focus({preventScroll: true});\r\n                                event.stopPropagation();\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseOutEvent(event: MouseEvent): void {\r\n        const {target, currentTarget, relatedTarget} = event;\r\n        const targetMenu = <HTMLElement>currentTarget;\r\n        if (target instanceof HTMLElement && target.classList.contains(\"menuitem\")) {\r\n            const nearestItem = this.#nearestItem(targetMenu, target);\r\n            if (nearestItem !== null) {\r\n                if (menuItemWidget.getType(nearestItem) == \"submenu\" &&\r\n                    !menuItemWidget.getExpanded(nearestItem)) {\r\n                    this.#clearItemTimeout(nearestItem);\r\n                }\r\n                const isTargetClosestMenu = event.composedPath().find(\r\n                    target_i => target_i instanceof HTMLElement && target_i.classList.contains(\"menu\")\r\n                ) == targetMenu;\r\n                if (isTargetClosestMenu) {\r\n                    const activeItem = this.#getActiveItem(targetMenu);\r\n                    if (activeItem !== null &&\r\n                        menuItemWidget.getType(activeItem) == \"submenu\" &&\r\n                        menuItemWidget.getExpanded(activeItem)) {\r\n                        this.#clearItemTimeout(activeItem);\r\n                        this.#setItemTimeout(activeItem, mouseOutCollapseDelay)\r\n                            .then(() => {\r\n                                menuItemWidget.collapse(activeItem);\r\n                            })\r\n                            .catch(() => undefined);\r\n                    }\r\n                    const {clientX, clientY} = event;\r\n                    const {left, right, top, bottom} = targetMenu.getBoundingClientRect();\r\n                    const intersectsWithMouse = !(\r\n                        left > clientX || right < clientX || top > clientY || bottom < clientY\r\n                    );\r\n                    const containsRelatedTarget = targetMenu.contains(<Node>relatedTarget);\r\n                    if (intersectsWithMouse && containsRelatedTarget) {\r\n                        if (relatedTarget instanceof HTMLElement && relatedTarget.classList.contains(\"menu\") && relatedTarget !== targetMenu) {\r\n                            relatedTarget.focus({preventScroll: true});\r\n                        }\r\n                        else {\r\n                            targetMenu.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                    if (!intersectsWithMouse) {\r\n                        targetMenu.focus({preventScroll: true});\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleMouseOverEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const targetMenu = <HTMLElement>currentTarget;\r\n        if (target instanceof HTMLElement && target.classList.contains(\"menuitem\")) {\r\n            const nearestItem = this.#nearestItem(targetMenu, target); \r\n            if (nearestItem !== null) {\r\n                if (menuItemWidget.getType(nearestItem) == \"submenu\" &&\r\n                    menuItemWidget.getExpanded(nearestItem)) {\r\n                    this.#clearItemTimeout(nearestItem);\r\n                }\r\n                const isTargetClosestMenu = event.composedPath().find(\r\n                    target_i => target_i instanceof HTMLElement && target_i.classList.contains(\"menu\")\r\n                ) == targetMenu;\r\n                if (isTargetClosestMenu) {\r\n                    const activeItem = this.#getActiveItem(targetMenu);\r\n                    if (activeItem !== null) {\r\n                        if (menuItemWidget.getType(activeItem) == \"submenu\" &&\r\n                            menuItemWidget.getExpanded(activeItem) && \r\n                            !activeItem.contains(<HTMLElement>target)) {\r\n                            this.#clearItemTimeout(activeItem);\r\n                            this.#setItemTimeout(activeItem, mouseOutCollapseDelay)\r\n                                .then(() => {\r\n                                    menuItemWidget.collapse(activeItem);\r\n                                })\r\n                                .catch(() => undefined);\r\n                        }\r\n                    }\r\n                    nearestItem.focus({preventScroll: true});\r\n                    if (menuItemWidget.getType(nearestItem) == \"submenu\") {\r\n                        if (!menuItemWidget.getExpanded(nearestItem)) {\r\n                            this.#clearItemTimeout(nearestItem);\r\n                            this.#setItemTimeout(nearestItem, mouseOverExpandDelay)\r\n                                .then(() => {\r\n                                    const activeItem = this.#getActiveItem(targetMenu);\r\n                                    this.#collapseSubmenus(targetMenu);\r\n                                    if (activeItem) {\r\n                                        this.#clearItemTimeout(activeItem);\r\n                                        menuItemWidget.expand(activeItem);\r\n                                        menuItemWidget.getMenu(activeItem)?.focus({preventScroll: true});\r\n                                    }\r\n                                })\r\n                                .catch(() => undefined);\r\n                        }\r\n                        else {\r\n                            menuItemWidget.getMenu(nearestItem)?.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { toolbarItemGroupWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"toolbaritemgroup\": MenuItemGroupWidgetFactory\r\n    }\r\n}\r\n\r\ninterface MenuItemGroupWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar toolbarItemGroupWidget = new (\r\nWidget({\r\n    name: \"toolbaritemgroup\"\r\n})(class MenuItemGroupWidgetFactoryBase extends WidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"toolbaritemgroup\",\r\n                role: \"group\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(group: HTMLElement) {\r\n        return group;\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { toolbarItemWidget };\r\n\r\ntype ToolBarItemType = \"button\" | \"checkbox\" | \"radio\" | \"menubutton\";\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"toolbaritem\": ToolBarItemWidgetFactory\r\n    }\r\n}\r\n\r\ninterface ToolBarItemWidgetFactory extends WidgetFactory {\r\n    create(init?: {\r\n        id?: string;\r\n        type: ToolBarItemType;\r\n        pressed?: boolean;\r\n        label?: string;\r\n        name?: string;\r\n        keyshortcut?: string;\r\n        value?: string;\r\n        disabled?: boolean;\r\n    }): HTMLElement;\r\n    menu(item: HTMLElement): HTMLElement | null;\r\n    getName(item: HTMLElement): string;\r\n    setName(item: HTMLElement, value: string): void;\r\n    getLabel(item: HTMLElement): string;\r\n    setLabel(item: HTMLElement, value: string): void;\r\n    setPressed(item: HTMLElement, value: boolean): void;\r\n    getPressed(item: HTMLElement): boolean;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n    getValue(item: HTMLElement): string;\r\n    setValue(item: HTMLElement, value: string): void;\r\n    getType(item: HTMLElement): ToolBarItemType | null;\r\n    setType(item: HTMLElement, value: ToolBarItemType): void;\r\n}\r\n\r\nvar toolbarItemWidget = new(\r\nWidget({\r\n    name: \"toolbaritem\"\r\n})(\r\nclass ToolBarItemWidgetFactoryBase extends WidgetFactory implements ToolBarItemWidgetFactory {\r\n    #template: HTMLElement;\r\n    #types: ToolBarItemType[];\r\n\r\n    constructor() {\r\n        super();\r\n        this.#types = [\"button\", \"checkbox\", \"radio\", \"menubutton\"];\r\n        this.#template = element(\"button\", {\r\n            attributes: {\r\n                class: \"toolbaritem\",\r\n                role: \"button\",\r\n                type: \"button\",\r\n                tabindex: -1\r\n            },\r\n            children: [\r\n                element(\"span\", {\r\n                    attributes: {\r\n                        class: \"label\"\r\n                    }\r\n                })\r\n            ]\r\n        });\r\n    }\r\n\r\n    create(init?: {\r\n        id?: string;\r\n        type?: ToolBarItemType;\r\n        pressed?: boolean;\r\n        label?: string;\r\n        name?: string;\r\n        keyshortcut?: string;\r\n        value?: string;\r\n        disabled?: boolean;\r\n    }) {\r\n        const item = <HTMLElement>this.#template.cloneNode(true);\r\n        item.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        item.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        if (init !== void 0) {\r\n            const {id, keyshortcut, pressed, type, label, name, value, disabled} = init;\r\n            if (id !== undefined) {\r\n                item.id = id;\r\n            }\r\n            if (keyshortcut !== undefined) {\r\n                this.setKeyShortcut(item, keyshortcut);\r\n            }\r\n            if (pressed !== undefined) {\r\n                this.setPressed(item, pressed);\r\n            }\r\n            if (type !== undefined) {\r\n                this.setType(item, type);\r\n            }\r\n            if (label !== undefined) {\r\n                this.setLabel(item, label);\r\n            }\r\n            if (name !== undefined) {\r\n                this.setName(item, name);\r\n            }\r\n            if (value !== undefined) {\r\n                this.setValue(item, value);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(item, disabled);\r\n            }\r\n        }\r\n        return item;\r\n    }\r\n\r\n    slot(item: HTMLElement): HTMLElement | null {\r\n        return item;\r\n    }\r\n\r\n    slottedCallback(item: HTMLElement, slot: HTMLElement): void {\r\n        const hasChildMenu = Array.from(slot.childNodes).some(\r\n            childNode_i => childNode_i instanceof HTMLElement && childNode_i.classList.contains(\"menu\")\r\n        );\r\n        item.setAttribute(\"aria-haspopup\", String(hasChildMenu));\r\n    }\r\n\r\n    menu(item: HTMLElement): HTMLElement | null {\r\n        return item.querySelector<HTMLElement>(\":scope > .menu\");\r\n    }\r\n\r\n    setExpanded(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-expanded\", value);\r\n    }\r\n\r\n    getExpanded(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-expanded\");\r\n    }\r\n\r\n    getLabel(item: HTMLElement): string {\r\n        return this.#label(item).textContent ?? \"\";\r\n    }\r\n\r\n    setLabel(item: HTMLElement, value: string): void {\r\n        this.#label(item).textContent = value;\r\n    }\r\n\r\n    getKeyShortcut(item: HTMLElement): string | null {\r\n        return item.getAttribute(\"aria-keyshortcuts\");\r\n    }\r\n\r\n    setKeyShortcut(item: HTMLElement, value: string | null): void {\r\n        if (value !== null) {\r\n            item.setAttribute(\"aria-keyshortcuts\", value);\r\n        }\r\n        else {\r\n            item.removeAttribute(\"aria-keyshortcuts\");\r\n        }\r\n    }\r\n\r\n    toggle(item: HTMLElement, force?: boolean): void {\r\n        const expand = force ?? !this.getExpanded(item);\r\n        this.setExpanded(item, expand);\r\n        if (expand) {\r\n            this.#positionMenu(item);\r\n        }\r\n    }\r\n\r\n    expand(item: HTMLElement): void {\r\n        const expanded = this.getExpanded(item);\r\n        if (!expanded) {\r\n            this.setExpanded(item, true);\r\n            this.#positionMenu(item);\r\n        }\r\n    }\r\n\r\n    collapse(item: HTMLElement): void {\r\n        const expanded = this.getExpanded(item);\r\n        if (expanded) {\r\n            this.setExpanded(item, false);\r\n        }\r\n    }\r\n\r\n    getType(item: HTMLElement): ToolBarItemType | null {\r\n        const types = this.#types;\r\n        const {classList} = item;\r\n        for (let type_i of types) {\r\n            if (classList.contains(`toolbaritem-${type_i}`)) {\r\n                return type_i;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    setType(item: HTMLElement, type: ToolBarItemType): void {\r\n        const oldType = this.getType(item);\r\n        if (type !== oldType) {\r\n            const {classList} = item;\r\n            if (oldType) {\r\n                classList.remove(`toolbaritem-${oldType}`);\r\n            }\r\n            classList.add(`toolbaritem-${type}`);\r\n        }\r\n    }\r\n\r\n    getValue(item: HTMLElement): string {\r\n        return item.getAttribute(\"value\") ?? \"\";\r\n    }\r\n\r\n    setValue(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"value\", value);\r\n    }\r\n\r\n    getTitle(item: HTMLElement): string {\r\n        return item.getAttribute(\"title\") ?? \"\";\r\n    }\r\n\r\n    setTitle(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"title\", value);\r\n    }\r\n\r\n    getName(item: HTMLElement): string {\r\n        return item.getAttribute(\"name\") ?? \"\";\r\n    }\r\n\r\n    setName(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"name\", value);\r\n    }\r\n\r\n    getPressed(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-pressed\") ?? String(false));\r\n    }\r\n\r\n    setPressed(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-pressed\", String(value));\r\n    }\r\n\r\n    getDisabled(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setDisabled(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    setActive(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"active\");\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"active\");\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetItem = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetItem.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.collapse(targetItem);\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, currentTarget} = event;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".toolbaritem\");\r\n        if (targetItem == currentTarget) {\r\n            const type = this.getType(targetItem);\r\n            switch (type) {\r\n                case \"checkbox\": {\r\n                    this.setPressed(targetItem, !this.getPressed(targetItem));\r\n                    break;\r\n                }\r\n                case \"radio\": {\r\n                    this.setPressed(targetItem, true);\r\n                    break;\r\n                }\r\n                case \"menubutton\": {\r\n                    const menu = this.menu(targetItem);\r\n                    if (menu && !menu.contains(<Node>target)) {\r\n                        this.toggle(targetItem);\r\n                        const expanded = this.getExpanded(targetItem);\r\n                        if (expanded) {\r\n                            menu?.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #positionMenu(item: HTMLElement): void {\r\n        const type = this.getType(item);\r\n        if (type == \"menubutton\") {\r\n            const menu = this.menu(item);\r\n            if (menu !== null) {\r\n                const {style: menuStyle} = menu;\r\n                const {top: itemTop, bottom: itemBottom, left: itemLeft, right: itemRight} = item.getBoundingClientRect();\r\n                const {width: menuWidth, height: menuHeight} = menu.getBoundingClientRect();\r\n                const {scrollY, scrollX} = window;\r\n                const {clientWidth, clientHeight} = document.body;\r\n                const overflowX = itemRight + menuWidth - clientWidth;\r\n                const overflowY = itemTop + menuHeight - clientHeight;\r\n                menuStyle.setProperty(\"left\", `${\r\n                    overflowX > 0 ?\r\n                    scrollX + itemLeft - menuWidth :\r\n                    scrollX + itemLeft\r\n                }px`);\r\n                menuStyle.setProperty(\"top\", `${\r\n                    overflowY > 0 ?\r\n                    scrollY + itemTop - menuHeight :\r\n                    scrollY + itemBottom\r\n                }px`);\r\n            }\r\n        }\r\n    }\r\n\r\n    #label(item: HTMLElement): HTMLElement {\r\n        return item.querySelector<HTMLElement>(\":scope > .label\")!;\r\n    }\r\n}));\r\n","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { toolbarItemWidget } from \"./ToolBarItemWidget\";\r\n\r\nexport { toolbarWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"toolbar\": ToolBarWidgetFactory\r\n    }\r\n}\r\n\r\ninterface ToolBarWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n    }): HTMLElement;\r\n    setOrientation(toolbar: HTMLElement, value: ToolBarOrientation): void;\r\n    getOrientation(toolbar: HTMLElement): ToolBarOrientation;\r\n}\r\n\r\ntype ToolBarOrientation = \"horizontal\" | \"vertical\";\r\n\r\nvar toolbarWidget = new (\r\nWidget({\r\n    name: \"toolbar\"\r\n})(class ToolBarWidgetFactoryBase extends WidgetFactory {\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"div\", {\r\n            attributes: {\r\n                class: \"toolbar\",\r\n                role: \"toolbar\",\r\n                tabindex: -1\r\n            }\r\n        });\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#walkerNodeFilter.bind(this)\r\n        )\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n    }) {\r\n        const toolbar = <HTMLElement>this.#template.cloneNode(true);\r\n        toolbar.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        toolbar.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        toolbar.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        toolbar.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        toolbar.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex} = properties;\r\n            if (id !== undefined) {\r\n                toolbar.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                toolbar.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                toolbar.tabIndex = tabIndex;\r\n            }\r\n        }\r\n        return toolbar;\r\n    }\r\n\r\n    slot(toolbar: HTMLElement) {\r\n        return toolbar;\r\n    }\r\n\r\n    #getActiveItem(toolbar: HTMLElement): HTMLElement | null {\r\n        return toolbar.querySelector<HTMLElement>(\r\n            \":is(:scope, :scope > .toolbaritemgroup) > .toolbaritem.active\"\r\n        );\r\n    }\r\n\r\n    items(toolbar: HTMLElement): HTMLElement[] {\r\n        return Array.from(toolbar.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .toolbaritemgroup) > .toolbaritem\"\r\n        ));\r\n    }\r\n\r\n    setOrientation(toolbar: HTMLElement, value: ToolBarOrientation): void {\r\n        toolbar.setAttribute(\"aria-orientation\", value);\r\n    }\r\n\r\n    getOrientation(toolbar: HTMLElement): ToolBarOrientation {\r\n        return <ToolBarOrientation>toolbar.getAttribute(\"aria-orientation\") ?? \"horizontal\";\r\n    }\r\n\r\n    #walkerNodeFilter(node: Node) {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"toolbaritem\") && !toolbarItemWidget.getDisabled(node)) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"toolbaritemgroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #firstItem(toolbar: Element): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = toolbar;\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(toolbar: Element): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = toolbar;\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousItem = <HTMLElement | null>walker.previousSibling();\r\n        return previousItem;\r\n    }\r\n\r\n    #nextItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        return <HTMLElement | null>walker.nextSibling();\r\n    }\r\n\r\n    #firstChildItem(item: HTMLElement): HTMLElement | null {\r\n        const menu = toolbarItemWidget.menu(item);\r\n        if (menu) {\r\n            const walker = this.#walker;\r\n            walker.currentNode = menu;\r\n            return <HTMLElement | null>walker.firstChild();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #setActiveItem(tree: HTMLElement, item: HTMLElement | null): void {\r\n        const activeItem = this.#getActiveItem(tree);\r\n        if (activeItem !== null && activeItem !== item) {\r\n            toolbarItemWidget.setActive(activeItem, false);\r\n            activeItem.tabIndex = -1;\r\n        }\r\n        if (item !== null) {\r\n            toolbarItemWidget.setActive(item, true);\r\n            item.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleClickEvent(event: Event): void {\r\n        const {currentTarget, target} = event;\r\n        const toolbar = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".toolbaritem\");\r\n        if (targetItem) {\r\n            const type = toolbarItemWidget.getType(targetItem);\r\n            const name = toolbarItemWidget.getName(targetItem);\r\n            const value = toolbarItemWidget.getType(targetItem);\r\n            if (type == \"radio\") {\r\n                toolbar.querySelectorAll<HTMLElement>(\r\n                    `:is(:scope, :scope > .toolbaritemgroup) > .toolbaritem[type=radio][name=${name}]`\r\n                ).forEach((radio_i) => {\r\n                    toolbarItemWidget.setPressed(radio_i, toolbarItemWidget.getValue(radio_i) == value);\r\n                });\r\n            }\r\n            event.stopPropagation();\r\n        }\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetToolbar = <HTMLElement>currentTarget;\r\n        const focusWithin = targetToolbar.contains(<Node>relatedTarget);\r\n        if (!focusWithin) {\r\n            const activeItem = this.#getActiveItem(targetToolbar);\r\n            if (activeItem) {\r\n                activeItem.focus();\r\n            }\r\n            else {\r\n                const firstItem = this.#firstItem(targetToolbar);\r\n                firstItem?.focus();\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetToolbar = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".toolbaritem\");\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetToolbar, targetItem);\r\n            targetToolbar.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetToolbar = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetToolbar.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            this.#setActiveItem(targetToolbar, null);\r\n            targetToolbar.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {currentTarget, key} = event;\r\n        const targetToolbar = <HTMLElement>currentTarget;\r\n        const activeItem = this.#getActiveItem(targetToolbar);\r\n        switch (key) {\r\n            case \"Enter\":\r\n            case \" \": {\r\n                if (activeItem) {\r\n                    const type = toolbarItemWidget.getType(activeItem);\r\n                    switch (type) {\r\n                        case \"menubutton\": {\r\n                            toolbarItemWidget.expand(activeItem);\r\n                            const firstChildItem = this.#firstChildItem(activeItem);\r\n                            firstChildItem?.focus({preventScroll: true});\r\n                            event.preventDefault();\r\n                            break;\r\n                        }\r\n                    }\r\n                    event.stopPropagation();\r\n                }\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.#firstItem(targetToolbar);\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem(targetToolbar);\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.#firstItem(targetToolbar);\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem(targetToolbar);\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                if (activeItem) {\r\n                    activeItem.focus({preventScroll: true});\r\n                }\r\n                else {\r\n                    targetToolbar.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { treeItemWidget } from \"./TreeItemWidget\";\r\n\r\nexport { treeItemGroupWidget };\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"treeitemgroup\": TreeItemGroupWidgetFactory\r\n    }\r\n}\r\n\r\ninterface TreeItemGroupWidgetFactory extends WidgetFactory {\r\n    create(): HTMLElement;\r\n}\r\n\r\nvar treeItemGroupWidget = new (\r\nWidget({\r\n    name: \"treeitemgroup\"\r\n})(class TreeItemGroupWidgetFactoryBase extends WidgetFactory implements TreeItemGroupWidgetFactory {\r\n    #template: HTMLElement;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"ul\", {\r\n            attributes: {\r\n                class: \"treeitemgroup\",\r\n                role: \"group\"\r\n            }\r\n        });\r\n    }\r\n\r\n    create() {\r\n        return <HTMLElement>this.#template.cloneNode(true);\r\n    }\r\n\r\n    slot(group: HTMLElement) {\r\n        return group;\r\n    }\r\n\r\n    slottedCallback(group: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement && child_i.classList.contains(\"treeitem\")) {\r\n                treeItemWidget.setPosInSet(child_i, i);\r\n                treeItemWidget.setLevel(child_i, (() => {\r\n                    let level = -1;\r\n                    let closestItem: HTMLElement | null = child_i;\r\n                    while (closestItem !== null && closestItem.matches(\".tree :scope\")) {\r\n                        closestItem = closestItem.parentElement?.closest(\".treeitem\") ?? null;\r\n                        level++;\r\n                    }\r\n                    return level;\r\n                })());\r\n            }\r\n        });\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\n\r\nexport { treeItemWidget };\r\n\r\ntype TreeItemType = \"parent\" | \"leaf\";\r\n\r\ninterface TreeItemWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        type?: TreeItemType;\r\n        label?: string;\r\n        title?: string;\r\n        disabled?: boolean;\r\n        draggable?: boolean;\r\n    }): HTMLElement;\r\n    group(item: HTMLElement): HTMLElement | null;\r\n    setPosInSet(item: HTMLElement, value: number): void;\r\n    getPosInSet(item: HTMLElement): number;\r\n    getLabel(item: HTMLElement): string;\r\n    setLabel(item: HTMLElement, value: string): void;\r\n    setActive(item: HTMLElement, value: boolean): void;\r\n    getActive(item: HTMLElement): boolean;\r\n    setDropTarget(item: HTMLElement, value: boolean): void;\r\n    getDropTarget(item: HTMLElement): boolean;\r\n    setSelected(item: HTMLElement, value: boolean): void;\r\n    getSelected(item: HTMLElement): boolean;\r\n    setDisabled(item: HTMLElement, value: boolean): void;\r\n    getDisabled(item: HTMLElement): boolean;\r\n    setExpanded(item: HTMLElement, value: boolean): void;\r\n    getExpanded(item: HTMLElement): boolean;\r\n    setDraggable(row: HTMLElement, value: boolean): void;\r\n    getDraggable(item: HTMLElement): boolean;\r\n    getType(item: HTMLElement): TreeItemType | null;\r\n    setType(item: HTMLElement, value: TreeItemType): void;\r\n    toggle(item: HTMLElement, force?: boolean): void;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"treeitem\": TreeItemWidgetFactory,\r\n    }\r\n}\r\n\r\nvar treeItemWidget = new (\r\nWidget({\r\n    name: \"treeitem\"\r\n})(class TreeItemWidgetFactoryBase extends WidgetFactory implements TreeItemWidgetFactory {\r\n    #template: HTMLElement;\r\n    #types: TreeItemType[];\r\n\r\n    constructor() {\r\n        super();\r\n        this.#types = [\"parent\", \"leaf\"];\r\n        this.#template = element(\"li\", {\r\n            attributes: {\r\n                class: \"treeitem\",\r\n                role: \"treeitem\",\r\n                tabindex: -1\r\n            },\r\n            children: [\r\n                element(\"span\", {\r\n                    attributes: {\r\n                        class: \"content\"\r\n                    },\r\n                    children: [\r\n                        element(\"span\", {\r\n                            attributes: {\r\n                                class: \"arrow\"\r\n                            }\r\n                        })\r\n                    ]\r\n                })\r\n            ]\r\n        });\r\n    }\r\n\r\n    group(item: HTMLElement): HTMLElement | null {\r\n        return item.querySelector<HTMLElement>(\":scope > .treeitemgroup\");\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        label?: string;\r\n        title?: string;\r\n        type?: TreeItemType;\r\n        disabled?: boolean;\r\n        draggable?: boolean;\r\n    }): HTMLElement {\r\n        const item = <HTMLElement>this.#template.cloneNode(true);\r\n        item.addEventListener(\"click\", this.#handleClickEvent.bind(this));\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, label, title, type = \"leaf\", disabled, draggable} = properties;\r\n            if (id !== undefined) {\r\n                item.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                item.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                item.tabIndex = tabIndex;\r\n            }\r\n            if (label !== undefined) {\r\n                this.setLabel(item, label);\r\n            }\r\n            if (title !== undefined) {\r\n                this.setTitle(item, title);\r\n            }\r\n            this.setType(item, type);\r\n            if (type === \"parent\") {\r\n                this.setExpanded(item, false);\r\n            }\r\n            if (disabled !== undefined) {\r\n                this.setDisabled(item, disabled);\r\n            }\r\n            if (draggable !== undefined) {\r\n                this.setDraggable(item, draggable);\r\n            }\r\n            this.setSelected(item, false);\r\n        }\r\n        return item;\r\n    }\r\n\r\n    get observedSlots() {\r\n        return [\"content\", \"group\"];\r\n    }\r\n\r\n    slot(item: HTMLElement, name: string | null) {\r\n        switch (name) {\r\n            case \"content\":\r\n                return this.#content(item);\r\n            case \"group\":\r\n                return item;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #content(item: HTMLElement): HTMLElement {\r\n        const content = item.querySelector<HTMLElement>(\":scope > .content\")!;\r\n        if (!content) throw new Error(\"Missing .content slot.\");\r\n        return content;\r\n    }\r\n\r\n    getLabel(item: HTMLElement): string {\r\n        return item.getAttribute(\"aria-label\") ?? \"\";\r\n    }\r\n\r\n    setLabel(item: HTMLElement, value: string): void {\r\n        item.setAttribute(\"aria-label\", value);\r\n    }\r\n\r\n    getTitle(item: HTMLElement): string {\r\n        return item.title;\r\n    }\r\n\r\n    setTitle(item: HTMLElement, value: string): void {\r\n        item.title = value;\r\n    }\r\n\r\n    setPosInSet(item: HTMLElement, value: number): void {\r\n        item.setAttribute(\"aria-posinset\", String(value));\r\n    }\r\n\r\n    getPosInSet(item: HTMLElement): number {\r\n        const posInSet = item.getAttribute(\"aria-posinset\");\r\n        return posInSet ? Number(posInSet) : -1;\r\n    }\r\n\r\n    getType(item: HTMLElement): TreeItemType {\r\n        const types = this.#types;\r\n        const {classList} = item;\r\n        for (let type_i of types) {\r\n            if (classList.contains(`treeitem-${type_i}`)) {\r\n                return type_i;\r\n            }\r\n        }\r\n        throw new Error(\"Missing type.\");\r\n    }\r\n\r\n    setType(item: HTMLElement, type: TreeItemType): void {\r\n        const {classList} = item;\r\n        try {\r\n            const oldType = this.getType(item);\r\n            classList.remove(`treeitem-${oldType}`);\r\n        }\r\n        catch (e) {};\r\n        classList.add(`treeitem-${type}`);\r\n    }\r\n\r\n    setExpanded(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-expanded\", String(value));\r\n    }\r\n\r\n    getExpanded(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-expanded\") ?? String(false));\r\n    }\r\n\r\n    setActive(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            if (!classList.contains(\"active\")) {\r\n                classList.add(\"active\");\r\n            }\r\n        }\r\n        else {\r\n            classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    getActive(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"active\");\r\n    }\r\n\r\n    setDropTarget(item: HTMLElement, value: boolean): void {\r\n        const {classList} = item;\r\n        if (value) {\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    getDropTarget(item: HTMLElement): boolean {\r\n        const {classList} = item;\r\n        return classList.contains(\"droptarget\");\r\n    }\r\n\r\n    setDisabled(item: HTMLElement, value: boolean): void {\r\n        item.toggleAttribute(\"aria-disabled\", value);\r\n    }\r\n\r\n    getDisabled(item: HTMLElement): boolean {\r\n        return item.hasAttribute(\"aria-disabled\");\r\n    }\r\n\r\n    setDraggable(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"draggable\", String(value));\r\n    }\r\n\r\n    getDraggable(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"draggable\") ?? String(false));\r\n    }\r\n\r\n    setSelected(item: HTMLElement, value: boolean): void {\r\n        item.setAttribute(\"aria-selected\", String(value));\r\n        item.dispatchEvent(new Event(\"select\", {bubbles: true}));\r\n    }\r\n\r\n    getSelected(item: HTMLElement): boolean {\r\n        return JSON.parse(item.getAttribute(\"aria-selected\") ?? String(false));\r\n    }\r\n\r\n    setLevel(item: HTMLElement, value: number): void {\r\n        item.style.setProperty(\"--level\", String(value));\r\n    }\r\n\r\n    getLevel(item: HTMLElement): number {\r\n        return parseInt(item.style.getPropertyValue(\"--level\"));\r\n    }\r\n\r\n    toggle(item: HTMLElement, force?: boolean): void {\r\n        this.setExpanded(item, force ?? !this.getExpanded(item));\r\n    }\r\n\r\n    #handleClickEvent(event: MouseEvent): void {\r\n        const {target, currentTarget, shiftKey, ctrlKey} = event;\r\n        const targetItem = <HTMLElement>(<HTMLElement>target).closest(\".treeitem\");\r\n        if (targetItem == currentTarget) {\r\n            const type = this.getType(targetItem);\r\n            if (type == \"parent\" && !(shiftKey || ctrlKey)) {\r\n                this.toggle(targetItem);\r\n            }\r\n        }\r\n    }\r\n}));","import { element } from \"../../../elements/Element\";\r\nimport { Widget, WidgetFactory } from \"../Widget\";\r\nimport { treeItemWidget } from \"./TreeItemWidget\";\r\n\r\nexport { treeWidget };\r\n\r\ninterface TreeWidgetFactory extends WidgetFactory {\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n    }): HTMLElement;\r\n    items(tree: HTMLElement): HTMLElement[];\r\n    selectedItems(tree: HTMLElement): HTMLElement[];\r\n    beginSelection(tree: HTMLElement): void;\r\n    endSelection(tree: HTMLElement): void;\r\n}\r\n\r\ndeclare global {\r\n    interface WidgetNameMap {\r\n        \"tree\": TreeWidgetFactory,\r\n    }\r\n}\r\n\r\nvar treeWidget = new (\r\nWidget({\r\n    name: \"tree\"\r\n})(class TreeWidgetFactoryBase extends WidgetFactory implements TreeWidgetFactory {\r\n\r\n    #template: HTMLElement;\r\n    #walker: TreeWalker;\r\n    #onSelection: WeakMap<HTMLElement, boolean>;\r\n    #hasSelectionChanged: WeakMap<HTMLElement, boolean>;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#template = element(\"ul\", {\r\n            attributes: {\r\n                class: \"tree\",\r\n                role: \"tree\",\r\n                tabindex: 0\r\n            }\r\n        });\r\n        this.#onSelection = new WeakMap();\r\n        this.#hasSelectionChanged = new WeakMap();\r\n        this.#walker = document.createTreeWalker(\r\n            document, NodeFilter.SHOW_ELEMENT, this.#nodeFilter.bind(this)\r\n        );\r\n    }\r\n\r\n    create(properties?: {\r\n        id?: string;\r\n        classList?: string[];\r\n        tabIndex?: number;\r\n        multisectable?: boolean;\r\n    }): HTMLElement {\r\n        const tree = <HTMLElement>this.#template.cloneNode(true);\r\n        tree.addEventListener(\"mousedown\", this.#handleMouseDownEvent.bind(this));\r\n        tree.addEventListener(\"dragend\", this.#handleDragEndEvent.bind(this));\r\n        tree.addEventListener(\"dragenter\", this.#handleDragEnterEvent.bind(this));\r\n        tree.addEventListener(\"dragleave\", this.#handleDragLeaveEvent.bind(this));\r\n        tree.addEventListener(\"dragover\", this.#handleDragOverEvent.bind(this));\r\n        tree.addEventListener(\"drop\", this.#handleDropEvent.bind(this));\r\n        tree.addEventListener(\"focus\", this.#handleFocusEvent.bind(this));\r\n        tree.addEventListener(\"focusin\", this.#handleFocusInEvent.bind(this));\r\n        tree.addEventListener(\"focusout\", this.#handleFocusOutEvent.bind(this));\r\n        tree.addEventListener(\"keydown\", this.#handleKeyDownEvent.bind(this));\r\n        tree.addEventListener(\"select\", this.#handleSelectEvent.bind(this));\r\n        this.#onSelection.set(tree, false);\r\n        this.#hasSelectionChanged.set(tree, false);\r\n        if (properties !== undefined) {\r\n            const {id, classList, tabIndex, multisectable} = properties;\r\n            if (id !== undefined) {\r\n                tree.id = id;\r\n            }\r\n            if (classList !== undefined) {\r\n                tree.classList.add(...classList);\r\n            }\r\n            if (tabIndex !== undefined) {\r\n                tree.tabIndex = tabIndex;\r\n            }\r\n            if (multisectable !== undefined) {\r\n                this.setMultiSelectable(tree, multisectable);\r\n            }\r\n        }\r\n        return tree;\r\n    }\r\n\r\n    slot(tree: HTMLElement) {\r\n        return tree;\r\n    }\r\n\r\n    slottedCallback(tree: HTMLElement, slot: HTMLElement) {\r\n        const {childNodes} = slot;\r\n        Array.from(childNodes).forEach((child_i, i) => {\r\n            if (child_i instanceof HTMLElement && child_i.classList.contains(\"treeitem\")) {\r\n                treeItemWidget.setPosInSet(child_i, i);\r\n                treeItemWidget.setLevel(child_i, 0);\r\n            }\r\n        });\r\n    }\r\n\r\n    items(tree: HTMLElement): HTMLElement[] {\r\n        return Array.from(tree.querySelectorAll<HTMLElement>(\r\n            \":is(:scope, :scope > .treeitemgroup) > .treeitem\"\r\n        ));\r\n    }\r\n\r\n    selectedItems(tree: HTMLElement): HTMLElement[] {\r\n        const selectedItems = [];\r\n        const walker = this.#walker;\r\n        walker.currentNode = tree;\r\n        let item = this.#firstItem(tree);\r\n        while (item !== null) {\r\n            const selected = treeItemWidget.getSelected(item);\r\n            if (selected) {\r\n                selectedItems.push(item);\r\n            }\r\n            item = this.#nextItem(item);\r\n        }\r\n        return selectedItems;\r\n    }\r\n\r\n    beginSelection(tree: HTMLElement): void {\r\n        this.#onSelection.set(tree, true);\r\n    }\r\n\r\n    endSelection(tree: HTMLElement): void {\r\n        this.#onSelection.set(tree, false);\r\n        if (this.#hasSelectionChanged.get(tree)) {\r\n            tree.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            this.#hasSelectionChanged.set(tree, false);\r\n        }\r\n    }\r\n\r\n    setMultiSelectable(tree: HTMLElement, value: boolean): void {\r\n        tree.setAttribute(\"aria-multiselectable\", String(value));\r\n    }\r\n\r\n    getMultiSelectable(tree: HTMLElement): boolean {\r\n        return JSON.parse(tree.getAttribute(\"aria-multiselectable\") ?? String(false));\r\n    }\r\n\r\n    #getActiveItem(tree: HTMLElement): HTMLElement | null {\r\n        return tree.querySelector<HTMLElement>(\".treeitem.active\");\r\n    }\r\n\r\n    #getDropTargetItem(tree: HTMLElement): HTMLElement | null {\r\n        return tree.querySelector<HTMLElement>(\".treeitem.droptarget\");\r\n    }\r\n\r\n    #setDropTargetItem(tree: HTMLElement, item: HTMLElement | null): void {\r\n        const {classList} = tree;\r\n        const dropTargetItem = this.#getDropTargetItem(tree);\r\n        if (dropTargetItem !== null && dropTargetItem !== item) {\r\n            treeItemWidget.setDropTarget(dropTargetItem, false);\r\n        }\r\n        if (item !== null) {\r\n            treeItemWidget.setDropTarget(item, true);\r\n            classList.add(\"droptarget\");\r\n        }\r\n        else {\r\n            classList.remove(\"droptarget\");\r\n        }\r\n    }\r\n\r\n    #nodeFilter(node: Node): number {\r\n        if (node instanceof HTMLElement) {\r\n            const {classList} = node;\r\n            if (classList.contains(\"treeitem\") && !treeItemWidget.getDisabled(node)) {\r\n                return NodeFilter.FILTER_ACCEPT;\r\n            }\r\n            else if (classList.contains(\"treeitemgroup\")) {\r\n                return NodeFilter.FILTER_SKIP;\r\n            }\r\n        }\r\n        return NodeFilter.FILTER_REJECT;\r\n    }\r\n\r\n    #getItemsRange(from: HTMLElement, to: HTMLElement): HTMLElement[] {\r\n        if (from == to) {\r\n            return [from];\r\n        }\r\n        const position = from.compareDocumentPosition(to);\r\n        if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\r\n            const range = [from];\r\n            let nextItem = this.#nextItem(from);\r\n            while (nextItem && nextItem !== to) {\r\n                range.push(nextItem);\r\n                nextItem = this.#nextItem(nextItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n            const range = [from];\r\n            let previousItem = this.#previousItem(from);\r\n            while (previousItem && previousItem !== to) {\r\n                range.push(previousItem);\r\n                previousItem = this.#previousItem(previousItem);\r\n            }\r\n            range.push(to);\r\n            return range;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    #setSelection(tree: HTMLElement, ...items: HTMLElement[]): void {\r\n        const selectedItems = this.selectedItems(tree);\r\n        this.beginSelection(tree);\r\n        selectedItems.forEach((item_i) => {\r\n            if (!items.includes(item_i)) {\r\n                treeItemWidget.setSelected(item_i, false);\r\n            }\r\n        });\r\n        items.forEach((item_i) => {\r\n            const selected = treeItemWidget.getSelected(item_i);\r\n            if (tree.contains(item_i) && !selected) {\r\n                treeItemWidget.setSelected(item_i, true);\r\n            }\r\n        });\r\n        this.endSelection(tree);\r\n    }\r\n\r\n    #addToSelection(tree: HTMLElement, ...items: HTMLElement[]): void {\r\n        this.beginSelection(tree);\r\n        items.forEach((item_i) => {\r\n            if (!treeItemWidget.getSelected(item_i)) {\r\n                treeItemWidget.setSelected(item_i, true);\r\n            }\r\n        });\r\n        this.endSelection(tree);\r\n    }\r\n\r\n    #removeFromSelection(tree: HTMLElement, ...items: HTMLElement[]): void {\r\n        const selectedItems = this.selectedItems(tree);\r\n        this.beginSelection(tree);\r\n        items.forEach((item_i) => {\r\n            if (selectedItems.includes(item_i)) {\r\n                treeItemWidget.setSelected(item_i, false);\r\n            }\r\n        });\r\n        this.endSelection(tree);\r\n    }\r\n\r\n    #clearSelection(tree: HTMLElement): void {\r\n        const selectedItems = this.selectedItems(tree);\r\n        this.beginSelection(tree);\r\n        selectedItems.forEach((item_i) => {\r\n            treeItemWidget.setSelected(item_i, false);\r\n        });\r\n        this.endSelection(tree);\r\n    }\r\n\r\n    #setActiveItem(tree: HTMLElement, item: HTMLElement | null): void {\r\n        const activeItem = this.#getActiveItem(tree);\r\n        if (activeItem !== null && activeItem !== item) {\r\n            treeItemWidget.setActive(activeItem, false);\r\n            activeItem.tabIndex = -1;\r\n        }\r\n        if (item !== null) {\r\n            treeItemWidget.setActive(item, true);\r\n            item.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #firstItem(tree: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = tree;\r\n        return <HTMLElement | null>walker.firstChild();\r\n    }\r\n\r\n    #lastItem(tree: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = tree;\r\n        return <HTMLElement | null>walker.lastChild();\r\n    }\r\n    \r\n    #previousItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const previousSibling = <HTMLElement | null>walker.previousSibling();\r\n        return previousSibling ?\r\n            this.#deepestItem(previousSibling) :\r\n            <HTMLElement | null>walker.parentNode();\r\n    }\r\n\r\n    #nextItem(item: HTMLElement): HTMLElement | null {\r\n        const walker = this.#walker;\r\n        walker.currentNode = item;\r\n        const type = treeItemWidget.getType(item);\r\n        const expanded = treeItemWidget.getExpanded(item);\r\n        return <HTMLElement | null>(\r\n            type === \"leaf\" ?\r\n                walker.nextNode() :\r\n                expanded ?\r\n                    walker.nextNode() :\r\n                    walker.nextSibling() ??\r\n                    (walker.parentNode(), walker.nextSibling())\r\n        );\r\n    }\r\n\r\n    #deepestItem(item: HTMLElement): HTMLElement {\r\n        const expanded = treeItemWidget.getExpanded(item);\r\n        if (expanded) {\r\n            const walker = this.#walker;\r\n            const lastItem = <HTMLElement>walker.lastChild();\r\n            if (lastItem) {\r\n                return this.#deepestItem(lastItem);\r\n            }\r\n        }\r\n        return item;\r\n    }\r\n\r\n    #handleMouseDownEvent(event: MouseEvent): void {\r\n        const {currentTarget, target, ctrlKey, shiftKey, button} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".treeitem\");\r\n        if (targetItem) {\r\n            const selected = treeItemWidget.getSelected(targetItem);\r\n            switch (button) {\r\n                case 0: {\r\n                    if (!shiftKey && !ctrlKey) {\r\n                        this.#setSelection(targetTree, targetItem);\r\n                    }\r\n                    else if (ctrlKey) {\r\n                        if (selected) {\r\n                            targetItem.blur();\r\n                            this.#removeFromSelection(targetTree, targetItem);\r\n                        }\r\n                        else {\r\n                            this.#addToSelection(targetTree, targetItem);\r\n                        }\r\n                        event.stopPropagation();\r\n                    }\r\n                    else if (shiftKey) {\r\n                        const activeItem = this.#getActiveItem(targetTree);\r\n                        if (activeItem) {\r\n                            const range = this.#getItemsRange(\r\n                                activeItem,\r\n                                targetItem\r\n                            );\r\n                            if (range) {\r\n                                this.#setSelection(targetTree, ...range);\r\n                            }\r\n                        }\r\n                        event.stopPropagation();\r\n                    }\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    if (!selected) {\r\n                        this.#setSelection(targetTree, targetItem);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleDragEndEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetTree, null);\r\n    }\r\n\r\n    #handleDragEnterEvent(event: DragEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".treeitem\");\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        if (targetItem) {\r\n            const type = treeItemWidget.getType(targetItem);\r\n            if (type == \"parent\") {\r\n                treeItemWidget.toggle(targetItem, true);\r\n            }\r\n            this.#setDropTargetItem(targetTree, targetItem);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragOverEvent(event: DragEvent): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    #handleDragLeaveEvent(event: DragEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        if (!targetTree.contains(<Node>relatedTarget)) {\r\n            this.#setDropTargetItem(targetTree, null);\r\n        }\r\n    }\r\n\r\n    #handleDropEvent(event: DragEvent): void {\r\n        const {currentTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        this.#setDropTargetItem(targetTree, null);\r\n    }\r\n\r\n    #handleFocusEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const focusWithin = targetTree.contains(<Node>relatedTarget);\r\n        if (!focusWithin) {   \r\n            const activeItem = this.#getActiveItem(targetTree);\r\n            if (activeItem) {\r\n                activeItem.focus();\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleFocusInEvent(event: FocusEvent): void {\r\n        const {currentTarget, target} = event;\r\n        const targetItem = <HTMLElement | null>(<HTMLElement>target).closest(\".treeitem\");\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        if (targetItem) {\r\n            this.#setActiveItem(targetTree, targetItem);\r\n            targetTree.tabIndex = -1;\r\n        }\r\n    }\r\n\r\n    #handleFocusOutEvent(event: FocusEvent): void {\r\n        const {currentTarget, relatedTarget} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const lostFocusWithin = !targetTree.contains(<Node>relatedTarget);\r\n        if (lostFocusWithin) {\r\n            targetTree.tabIndex = 0;\r\n        }\r\n    }\r\n\r\n    #handleKeyDownEvent(event: KeyboardEvent): void {\r\n        const {currentTarget, key} = event;\r\n        const targetTree = <HTMLElement>currentTarget;\r\n        const activeItem = this.#getActiveItem(targetTree);\r\n        switch (key) {\r\n            case \"a\": {\r\n                const {ctrlKey} = event;\r\n                if (ctrlKey) {\r\n                    if (activeItem) {\r\n                        const walker = this.#walker;\r\n                        walker.currentNode = activeItem;\r\n                        const firstItem = <HTMLElement>(\r\n                            walker.currentNode = walker.parentNode() ?? targetTree, walker.firstChild()\r\n                        );\r\n                        const lastItem = <HTMLElement>(\r\n                            walker.currentNode = walker.parentNode() ?? targetTree, walker.lastChild()\r\n                        );\r\n                        if (firstItem && lastItem) {\r\n                            const range = this.#getItemsRange(\r\n                                firstItem,\r\n                                this.#deepestItem(lastItem)\r\n                            );\r\n                            if (range) {\r\n                                this.#setSelection(targetTree, ...range);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                event.preventDefault();\r\n                break;\r\n            }\r\n            case \"ArrowLeft\": {\r\n                if (activeItem) {\r\n                    const expanded = treeItemWidget.getExpanded(activeItem);\r\n                    if (expanded) {\r\n                        treeItemWidget.toggle(activeItem);\r\n                    }\r\n                    else {\r\n                        const walker = this.#walker;\r\n                        const parentItem = <HTMLElement>walker.parentNode();\r\n                        if (parentItem) {\r\n                            parentItem.focus({preventScroll: true});\r\n                        }\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowRight\": {\r\n                if (activeItem) {\r\n                    const expanded = treeItemWidget.getExpanded(activeItem);\r\n                    if (!expanded) {\r\n                        treeItemWidget.toggle(activeItem);\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowUp\": {\r\n                if (activeItem) {\r\n                    const previousItem = this.#previousItem(activeItem);\r\n                    if (previousItem) {\r\n                        previousItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            const selected = treeItemWidget.getSelected(previousItem);\r\n                            selected ?\r\n                                this.#removeFromSelection(targetTree, previousItem) :\r\n                                this.#addToSelection(targetTree, previousItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const firstItem = this.#firstItem(targetTree);\r\n                    if (firstItem) {\r\n                        firstItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"ArrowDown\": {\r\n                if (activeItem) {\r\n                    const nextItem = this.#nextItem(activeItem);\r\n                    if (nextItem) {\r\n                        nextItem.focus({preventScroll: true});\r\n                        const {shiftKey} = event;\r\n                        if (shiftKey) {\r\n                            const selected = treeItemWidget.getSelected(nextItem);\r\n                            selected ?\r\n                                this.#removeFromSelection(targetTree, nextItem) :\r\n                                this.#addToSelection(targetTree, nextItem);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const lastItem = this.#lastItem(targetTree);\r\n                    if (lastItem) {\r\n                        lastItem.focus({preventScroll: true});\r\n                    }\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Home\": {\r\n                const firstItem = this.#firstItem(targetTree);\r\n                if (firstItem) {\r\n                    firstItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"End\": {\r\n                const lastItem = this.#lastItem(targetTree);\r\n                if (lastItem) {\r\n                    lastItem.focus({preventScroll: true});\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Enter\": {\r\n                if (activeItem) {\r\n                    this.#setSelection(targetTree, activeItem);\r\n                    activeItem.click();\r\n                }\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n            case \"Escape\": {\r\n                this.#clearSelection(targetTree);\r\n                this.#setActiveItem(targetTree, null);\r\n                targetTree.focus();\r\n                event.stopPropagation();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    #handleSelectEvent(event: Event): void {\r\n        const {target} = event;\r\n        const targetTree = <HTMLElement>target;\r\n        if (target instanceof HTMLElement && target.classList.contains(\"treeitem\")) {\r\n            if (this.#onSelection.get(targetTree)) {\r\n                this.#hasSelectionChanged.set(target, true);\r\n            }\r\n            else {\r\n                targetTree.dispatchEvent(new Event(\"selectionchange\", {bubbles: true}));\r\n            }\r\n        }\r\n    }\r\n}));","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// startup\n// Load entry module and return exports\n__webpack_require__(372);\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(4545);\n__webpack_require__(7023);\n__webpack_require__(6376);\n__webpack_require__(9795);\n__webpack_require__(174);\n__webpack_require__(7830);\n__webpack_require__(9994);\n__webpack_require__(7216);\n__webpack_require__(3112);\n__webpack_require__(2074);\n__webpack_require__(7950);\n__webpack_require__(6996);\n__webpack_require__(50);\n__webpack_require__(1082);\n__webpack_require__(4343);\n__webpack_require__(6815);\n__webpack_require__(1337);\n__webpack_require__(1391);\n__webpack_require__(8483);\n__webpack_require__(9560);\n__webpack_require__(2661);\n__webpack_require__(2753);\n__webpack_require__(8277);\n__webpack_require__(5250);\n__webpack_require__(2196);\n__webpack_require__(4422);\n__webpack_require__(7080);\n__webpack_require__(4041);\n__webpack_require__(4653);\n__webpack_require__(3675);\n__webpack_require__(8101);\n__webpack_require__(5617);\n__webpack_require__(9372);\n__webpack_require__(5028);\n__webpack_require__(6983);\n__webpack_require__(9114);\n__webpack_require__(1376);\n__webpack_require__(2172);\n__webpack_require__(3394);\n__webpack_require__(758);\n__webpack_require__(1827);\n__webpack_require__(5888);\n__webpack_require__(670);\n__webpack_require__(4141);\n__webpack_require__(2697);\n__webpack_require__(1573);\n__webpack_require__(1738);\n__webpack_require__(4078);\n__webpack_require__(338);\n__webpack_require__(4597);\n__webpack_require__(5304);\n__webpack_require__(1234);\n__webpack_require__(1980);\n__webpack_require__(1967);\n__webpack_require__(5459);\n__webpack_require__(5489);\n__webpack_require__(7001);\n__webpack_require__(9137);\n__webpack_require__(3473);\n__webpack_require__(1865);\n__webpack_require__(236);\n__webpack_require__(565);\n__webpack_require__(248);\n__webpack_require__(92);\n__webpack_require__(2545);\n__webpack_require__(7885);\n__webpack_require__(2858);\n__webpack_require__(4815);\n__webpack_require__(8429);\n__webpack_require__(1546);\n__webpack_require__(9343);\n__webpack_require__(5403);\n__webpack_require__(9248);\n__webpack_require__(171);\n__webpack_require__(680);\n__webpack_require__(4266);\n__webpack_require__(9760);\nvar __webpack_exports__ = __webpack_require__(598);\n"],"names":["leafPrototypes","getProto","Key","KeyModifier","MouseButton","AttributeProperty","init","target","property","constructor","prototype","propertyName","String","defaultValue","observed","name","observedAttributes","Reflect","get","Array","isArray","push","Object","defineProperty","value","writable","type","Boolean","this","hasAttribute","set","setAttribute","removeAttribute","val","getAttribute","JSON","parse","stringify","Number","parseFloat","CustomElement","elementCtor","options","customElements","define","QueryProperty","propertyKey","selector","getter","withinShadowRoot","shadowRoot","querySelector","fragment","nodes","document","createDocumentFragment","append","element","tagName","attributes","dataset","children","listeners","createElement","entries","forEach","attributeName","attributeValue","undefined","toggleAttribute","elementDataset","keys","datasetEntry_i","from","name_i","listener_i","addEventListener","reactiveElementsMap","WeakMap","reactiveElementsFinalizationRegistry","FinalizationRegistry","heldValue","model","reactiveElement","reactiveElementsMapEntry","reactiveElementsArray","splice","indexOf","reactiveElementsPropertyObserver","records","record_i","oldValue","newValue","reactiveElement_i","elementRef","react","properties","deref","includes","WeakRef","register","observerOptions","propertiesFilter","concat","filter","property_i","i","observe","reactiveChildElementsMap","reactiveChildElementsFinalizationRegistry","list","reactiveChildElement","reactiveChildrenElementsMapEntry","reactiveChildElementsArray","reactiveChildElementsObserver","range","values","length","listLength","reactiveChildElements_i","parentRef","mapping","placeholder","parent","firstChild","childrenCount","removeChild","changeType","LIST_INSERT","LIST_REMOVE","LIST_SORT","insertedIndex","insertedItems","insertedItemsArray","map","before","removedIndex","removedItems","removedCount","createRange","removeEndIndex","setStartBefore","setEndAfter","deleteContents","sortedIndices","childrenArray","index_i","reactiveChildElements","reactiveChildElementsMapEntry","childList","replaceChildren","areAttributesMatching","referenceAttributeType","referenceAttributeName","referenceAttributeValue","RegExp","test","camelToTrain","str","replace","toLowerCase","shadowTemplate","style","HTMLEGridElementBase","HTMLElement","super","createTreeWalker","NodeFilter","SHOW_ELEMENT","bind","attachShadow","mode","adoptedStylesheet","CSSStyleSheet","adoptedStyleSheets","content","cloneNode","cells","querySelectorAll","rows","activeCell","activeRow","body","head","connectedCallback","tabIndex","beginSelection","endSelection","dispatchEvent","Event","bubbles","clearSelection","selectedCells","selectedRows","node","hidden","FILTER_ACCEPT","FILTER_SKIP","FILTER_REJECT","to","fromIndex","toIndex","slice","Math","min","max","position","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","nextVisibleRow","DOCUMENT_POSITION_PRECEDING","previousVisibleRow","selectedCell_i","selected","cell_i","selectedRow_i","row_i","cell","active","currentNode","row","cellsWalker","lastChild","previousNode","nextNode","rowsWalker","parentNode","root","closestRow","cellIndex","previousRow","previousRowCells","nextRow","nextRowCells","event","ctrlKey","shiftKey","selectby","composedPath","targetCell","find","target_i","lastSelectedCell","targetRow","lastSelectedRow","stopPropagation","key","firstRow","firstCell","lastRow","lastCell","preventDefault","previousCell","focus","preventScroll","nextCell","topCell","bottomCell","click","relatedTarget","closest","assignedElements","element_i","posinset","HTMLEGridBodyElementBase","item_i","HTMLEGridBodyElement","HTMLEGridCellElementBase","attributeChangedCallback","HTMLEGridCellElement","HTMLEGridHeadElementBase","HTMLEGridRowElementBase","menu","HTMLEGridRowElement","HTMLEGridRowGroupElementBase","HTMLEGridRowGroupElement","HTMLEListElementBase","activeItem","dropTargetItem","items","parseInt","selectedItems","walker","item","selectedItem_i","contains","droptarget","rootNode","Document","getRootNode","ShadowRoot","host","firstItem","lastItem","previousItem","nextItem","lastSelectedItem","HTMLEListItemElementBase","badge","toolbar","labelPart","textContent","slotName","H","HTMLSpanElement","HTMLEListItemElement","HTMLEListItemGroupElementBase","HTMLEListItemGroupElement","toggleAnimations","HTMLEMenuElementBase","activeIndex","tabindex","positionContextual","x","y","width","menuWidth","height","menuHeight","getBoundingClientRect","scrollX","scrollY","window","left","top","clientWidth","clientHeight","overflowX","overflowY","setProperty","collapse","targetItem","checked","radio_i","toggle","nearestItem","contextual","remove","error","expanded","expand","HTMLEMenuElement","blur","cancel","toggleAnimation","animate","duration","finished","then","catch","finally","delete","clientX","clientY","right","bottom","intersectsWithMouse","containsRelatedTarget","assign","HTMLEMenuBarElementBase","disabled","previousSibling","nextSibling","Element","isExpanded","HTMLEMenuButtonElementBase","force","menuStyle","itemTop","itemBottom","itemLeft","itemRight","offsetParent","offsetLeft","offsetTop","HTMLEMenuButtonElement","slot","HTMLEMenuItemElementBase","internals","attachInternals","role","ariaChecked","ariaDisabled","ariaExpanded","ariaLabel","closestMenu","closestMenuTop","closestMenuLeft","part","HTMLEMenuItemElement","EMenuItem","label","trigger","title","button","checkbox","radio","submenu","HTMLEMenuItemGroupElementBase","HTMLEMenuItemGroupElement","radios","HTMLEStatusBarElementBase","HTMLEStatusItemElementBase","HTMLEStatusItemElement","onclick","HTMLEStatusItemGroupElementBase","HTMLEStatusItemGroupElement","HTMLETabElementBase","panel","controls","select","HTMLETabElement","HTMLETabListElementBase","tabs","activeTab","selectedTab","upgrade","tabToSelect","setTimeout","tabWidth","tabLeft","tabBottom","fill","easing","pseudoElement","tab","targetTab","dialogLeft","dialogTop","tab_i","HTMLETabPanelElementBase","id","wasExpandedOnMouseDown","HTMLEToolBarElementBase","pressed","menubutton","HTMLEToolBarElement","iconPart","HTMLEToolBarItemElementBase","prepend","HTMLEToolBarItemElement","EToolBarItem","HTMLEToolBarItemGroupElementBase","HTMLEToolBarItemGroupElement","HTMLETreeElementBase","getElementsByTagName","nextVisibleItem","previousVisibleItem","parentItem","console","log","HTMLETreeItemElementBase","level","HTMLETreeItemElement","HTMLETreeItemGroupElementBase","HTMLETreeItemGroupElement","HTMLEDialogElementBase","handleEvent","confirm","open","CustomEvent","close","HTMLEDraggableElementBase","references","referee","draggable","disconnectedCallback","thisRefIndex","getReference","reference","HTMLEDraggableElement","HTMLEDragzoneElementBase","draggables","selectedDraggables","selectDraggable","unselectDraggable","index","elem","thisSelectedDraggable","dragged","dataTransfer","dropEffect","setData","thisDraggedDraggable","targetIndex","firstIndex","direction","sign","startRangeIndex","endRangeIndex","thisDraggable","HTMLEDragzoneElement","HTMLEDropzoneElementBase","droptest","appendAreaPart","removeDraggables","dragovered","dropIndex","dragzoneId","getData","dragzone","getElementById","selectedDraggable","HTMLEDropzoneElement","addDraggables","placeholderPart","dataTransferSuccess","newDraggables","insertionPosition","multiple","newDraggable","insertAdjacentElement","appendChild","replaceChild","detail","action","once","predicate","toRemove","atPosition","HTMLEOptionElementBase","ariaSelected","HTMLEOptionElement","HTMLEOptionGroupElementBase","HTMLEOptionGroupElement","mutationObserver","HTMLESelectElementBase","subtree","formAssociated","activeOption","selectedOption","optionToSelect","option_i","option","setFormValue","box","optionsStyle","targetOption","previousOption","nextOption","firstOption","lastOption","keyLength","keyCode","charCodeAt","matchingOption","MutationObserver","mutationsList","mutation","HTMLEHandleElementBase","pointerId","releasePointerCapture","setPointerCapture","targetComputedStyle","getComputedStyle","movementX","movementY","rectWidth","rectHeight","outerElement","parentElement","outerRectLeft","outerRectRight","outerRectTop","outerRectBottom","getPropertyValue","newLeft","trunc","newTop","HTMLEHeightSashElementBase","growdir","newHeight","computedNewHeight","requestAnimationFrame","HTMLEImportElementBase","src","async","outerHTML","fetch","response","ok","text","Error","statusText","barShadowTemplate","spinnerShadowTemplate","HTMLELoaderElementBase","HTMLESeparatorElementBase","HTMLEToolTipElementBase","tooltip","htmlFor","show","immediate","visible","opacity","delay","hide","oldTarget","targetListenerObject","removeEventListener","targetTop","targetBottom","targetLeft","targetRight","tooltipWidth","tooltipHeight","tooltipHalfWidth","tooltipHalfHeight","targetCenter","targetMiddle","tooltipStyle","arrow","arrowStyle","arrowWidth","arrowHeight","arrowHalfWidth","arrowHalfHeight","documentListenerObject","HTMLEWidthSashElementBase","setWidth","newWidth","ModelChangeRecordBase","ModelNodesList","PROPERTY_CHANGE","ModelChangeRecord","ModelEventBase","currentTarget","ModelEventTargetAccessor","setCurrentTarget","setTarget","ModelEvent","ModelEventTargetBase","Map","receiveEvent","callbacks","callback_i","callback","callbackIndex","findIndex","ModelNodeBase","setParent","isCyclicReference","ancestorNode","TypeError","beginChanges","endChanges","getRecords","record","ModelNodeRecordsAccessor","triggerChange","handleRecord","ModelNode","ModelProperty","ModelObjectPropertiesAccessor","getProperty","enumerable","ModelObjectBase","ModelObject","ModelList","sort","compareFunction","indexedItems","indexedItem_a","indexedItem_b","indexedItem_i","_items","insert","abs","clear","removedItem_i","ModelChangeObserver","listener","unobserve","disconnect","targets","observer","group_i","acceptNode","addedItems","addedObserverTargets","childNodes","removedObserverTargets","GridModel","initRows","columns","initColumns","getColumnByName","column_i","sortByColumn","column","sortOrder","sortorder","sortTest","row_1","row_2","cell_1","extract","cell_2","localeCompare","GridColumnModel","filters","GridRowModel","age","GridViewBase","setModel","render","gridElement","setColumnDelegate","delegate","setCellDelegate","getRowElement","getColumnHeaderElement","getColumnCellsElements","renderShadow","rel","href","input","multisectable","contextmenu","setSearchFilter","rowElement","addDisplayFilter","displayFilters","removeDisplayFilter","filterIndex","removeAllDisplayFilters","searchFilter","some","filter_i","class","resizable","toString","headers","targetHead","targetHeader","contextMenu","columnHeaderElement","maxWidth","reduce","removeProperty","HTMLInputElement","matches","targetColumn","MenuModel","MenuItemModel","MenuViewBase","renderLight","menuitem","TreeModel","sortFunction","childItems","subtreeItems","item_a","item_b","flatMap","treeItem_i","of","getItemByUri","uri","itemsCount","uriLength","itemUri","itemUriLength","startsWith","call","flattenedInsertedItems","insertedItem_i","flattenedRemovedItems","TreeItemModelList","count","removedItemsGroups","TreeItemModel","group","list_i","children_i","child_i","TreeViewBase","treeElement","treeItemElement","treeItem","dragstart","drop","focusin","focusout","itemContentDelegate","itemToolbarDelegate","itemMenuDelegate","closestItem","treeitem","dragImageElement","span","targetTree","selectedElements","selectedCount","selectedUris","uri_i","_","uris","uri_j","selectedUrisString","join","lastUri","dragImage","setDragImage","targetUri","targetItemModel","transferedUris","split","transferedItems","targetType","targetParentItem","targetList","sameLabelIndex","item_j","copyWithin","newElements","relatedPosition","DOCUMENT_POSITION_DISCONNECTED","itemToolbar","ViewBase","shadow","light","View","create","pointerMovements","onCaptureFlags","queuedPointerCallbacks","sash","classList","growDir","add","setControls","setGrowDir","getGrowDir","getControls","setHeight","sashTarget","pointerMovement","slotsMap","slotsObserver","slotReferences","slotRef_i","widget","slottedCallback","widgetsMap","attributesObserver","WidgetFactory","Proxy","apply","thisArg","argumentsList","observedSlots","slotName_i","slotElement","slot_i","slotReference","attributeFilter","attributeOldValue","widgets","Widget","pointerMoveCallback","combobox","setExpanded","multiselectable","setName","setDisabled","setMultiSelectable","getName","getDisabled","getExpanded","getMultiSelectable","targetCombobox","addedNodes","optionWidget","setSelected","setLabel","setValue","getLabel","getValue","getSelected","gridCellWidget","setHeaders","getHeaders","setPosInSet","getPosInSet","posInSet","setActive","getActive","setDropTarget","getDropTarget","scope","header","gridRowWidget","grid","setSelectBy","getSelectBy","closestRowCells","targetGrid","listItemWidget","tree","relatedTargetRoot","relatedTargetHost","menubar","menuItemWidget","hasIcon","hasArrow","keyshortcut","setKeyShortcut","setChecked","setType","hasChildMenu","childNode_i","getMenu","getKeyShortcut","keyshortcutsPart","after","getType","types","type_i","typesFeatures","iconPartTemplate","arrowPartTemplate","oldType","arrowPart","getChecked","menuComputedStyle","paddingTop","paddingBottom","menuPaddingTop","menuPaddingBottom","setContextual","setPosition","getContextual","menuitem_i","Promise","resolve","reject","timeout","clearTimeout","targetMenu","toolbarItemWidget","setPressed","getTitle","setTitle","getPressed","setOrientation","getOrientation","targetToolbar","treeItemWidget","setDraggable","e","getDraggable","setLevel","getLevel","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","getPrototypeOf","obj","t","__esModule","ns","r","def","current","getOwnPropertyNames","d","definition","o","g","globalThis","Function","prop","hasOwnProperty","Symbol","toStringTag","scriptUrl","importScripts","location","currentScript","scripts","p"],"sourceRoot":""}